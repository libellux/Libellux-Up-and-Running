import{_ as e,C as l,c as t,o as p,j as a,ag as h,a as i,G as c}from"./chunks/framework.DfL_BkQ-.js";const m=JSON.parse('{"title":"ClamAV Anti-virus Engine","description":"ClamAV is an open source antivirus engine for detecting trojans, viruses, malware & other malicious threats.","frontmatter":{"title":"ClamAV Anti-virus Engine","description":"ClamAV is an open source antivirus engine for detecting trojans, viruses, malware & other malicious threats.","head":[["link",{"rel":"canonical","href":"https://libellux.com/intrusion-detection/clamav.html"}]]},"headers":[],"relativePath":"intrusion-detection/clamav.md","filePath":"intrusion-detection/clamav.md","lastUpdated":1720978488000}'),d={name:"intrusion-detection/clamav.md"},o={id:"clamav-antivirus-server",tabindex:"-1"};function r(k,s,g,C,u,F){const n=l("Badge");return p(),t("div",null,[a("h1",o,[s[0]||(s[0]=i("ClamAV Antivirus Server ",-1)),c(n,{text:"Rev 6",type:"tip"}),s[1]||(s[1]=i()),s[2]||(s[2]=a("a",{class:"header-anchor",href:"#clamav-antivirus-server","aria-label":'Permalink to "ClamAV Antivirus Server <Badge text="Rev 6" type="tip"/>"'},"​",-1))]),s[3]||(s[3]=h(`<p>ClamAV is an open source (GPL) anti-virus engine used in a variety of situations including email scanning, web scanning, and end point security. It provides a number of utilities including a flexible and scalable multi-threaded daemon, a command line scanner and an advanced tool for automatic database updates.</p><p><a href="https://ko-fi.com/B0B31BJU3" target="_blank"><img height="36" style="border:0px;height:36px;" src="https://storage.ko-fi.com/cdn/kofi5.png?v=3" border="0" alt="Buy Me a Coffee at ko-fi.com"></a></p><h2 id="install-clamav-from-source" tabindex="-1">Install ClamAV from source <a class="header-anchor" href="#install-clamav-from-source" aria-label="Permalink to &quot;Install ClamAV from source&quot;">​</a></h2><p>Install ClamAV Anti-virus Engine 1.0.5 from source as a centralized server to read data from ClamAV clients.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Supported distributions:</p><ul><li>Ubuntu 22.04 (Jammy Jellyfish)</li><li>Debian 12 (Bookworm)</li><li>Rocky Linux 9 (Blue Onyx)</li></ul></div><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-0o4tT" id="tab-a6PKBQP" checked><label data-title="Ubuntu/Debian" for="tab-a6PKBQP">Ubuntu/Debian</label><input type="radio" name="group-0o4tT" id="tab-AiXzkJ_"><label data-title="Rocky Linux" for="tab-AiXzkJ_">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo apt-get update --assume-yes</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo dnf update --assumeyes</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo dnf install --assumeyes dnf-utils</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo dnf install --assumeyes epel-release</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo dnf install --assumeyes epel-next-release</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo dnf upgrade --assumeyes</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo yum config-manager --set-enabled powertools</span></span></code></pre></div></div></div><p>Once you&#39;ve installed EPEL and enabled PowerTools (Rocky only) continue to install ClamAV dependencies.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-xAit5" id="tab-IEzkV_I" checked><label data-title="Ubuntu" for="tab-IEzkV_I">Ubuntu</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo apt-get install --assume-yes \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gcc \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">make \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pkg-config \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">python3 \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">python3-pip \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">python3-pytest \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">valgrind \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cmake \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">check \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libbz2-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libcurl4-openssl-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libjson-c-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libmilter-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libncurses5-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libpcre2-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libssl-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libxml2-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">zlib1g-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rust-all</span></span></code></pre></div></div></div><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-oREl9" id="tab-nrkxUrq" checked><label data-title="Ubuntu" for="tab-nrkxUrq">Ubuntu</label><input type="radio" name="group-oREl9" id="tab-quCHKg-"><label data-title="Debian" for="tab-quCHKg-">Debian</label><input type="radio" name="group-oREl9" id="tab-PxYWHaK"><label data-title="Rocky Linux" for="tab-PxYWHaK">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo apt-get install --assume-yes \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">build-essential \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">make \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pkg-config \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">python3 \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">python3-pip \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">python3-pytest \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">valgrind \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">check \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libbz2-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libcurl4-openssl-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libjson-c-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libmilter-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libncurses5-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libpcre2-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libssl-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libxml2-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">zlib1g-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cmake \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rust-all \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cargo</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo apt-get install -y gcc cmake make pkg-config python3 python3-pip python3-pytest valgrind \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">check libbz2-dev libcurl4-openssl-dev libmilter-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libncurses5-dev libpcre2-dev libssl-dev libxml2-dev zlib1g-dev</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo yum -y install gcc gcc-c++ cmake make python3 python3-pip valgrind \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bzip2-devel check-devel libcurl-devel libxml2-devel \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ncurses-devel openssl-devel pcre2-devel sendmail-devel zlib-devel json-c-devel</span></span></code></pre></div></div></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Only install libjson-c5 and libjson-c-dev for Debian 11 when compiling ClamAV 0.104.1.</p></div><p>For ClamAV 0.104.1 and Debian 11 proceed to install packages <code>libjson-c5</code> and <code>libjson-c-dev</code>.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-ODnLW" id="tab-QWOTMAK" checked><label data-title="shell-session" for="tab-QWOTMAK">shell-session</label></div><div class="blocks"><p>::: code-group-item Debian</p><div class="language-shell-session vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>wget http://ftp.se.debian.org/debian/pool/main/j/json-c/libjson-c5_0.15-2_amd64.deb &amp;&amp; \\</span></span>
<span class="line"><span>wget http://ftp.se.debian.org/debian/pool/main/j/json-c/libjson-c-dev_0.15-2_amd64.deb &amp;&amp; \\</span></span>
<span class="line"><span>sudo dpkg -i libjson-c5_0.15-2_amd64.deb &amp;&amp; sudo dpkg -i libjson-c-dev_0.15-2_amd64.deb</span></span></code></pre></div><p>:::</p></div></div><h2 id="create-user-and-group" tabindex="-1">Create user and group <a class="header-anchor" href="#create-user-and-group" aria-label="Permalink to &quot;Create user and group&quot;">​</a></h2><p>Create ClamAV service group and user.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-DNwWV" id="tab-WbO3isd" checked><label data-title="Ubuntu/Debian" for="tab-WbO3isd">Ubuntu/Debian</label><input type="radio" name="group-DNwWV" id="tab-A49wrbb"><label data-title="Rocky Linux" for="tab-A49wrbb">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo groupadd clamav</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo useradd -g clamav -s /bin/false -c &quot;Clam Antivirus&quot; clamav</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo groupadd clamav</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo useradd -g clamav -s /bin/false -c &quot;Clam Antivirus&quot; clamav</span></span></code></pre></div></div></div><h2 id="import-clamav-signing-key" tabindex="-1">Import ClamAV signing key <a class="header-anchor" href="#import-clamav-signing-key" aria-label="Permalink to &quot;Import ClamAV signing key&quot;">​</a></h2><p>Download and import the <a href="http://www.clamav.net/downloads#collapsePGP" target="_blank" rel="noreferrer">Talos PGP public key</a> so we later can verify the signature of our download.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-nhHa6" id="tab-A9xgYJF" checked><label data-title="Ubuntu/Debian" for="tab-A9xgYJF">Ubuntu/Debian</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg --import talos-pgp.asc</span></span></code></pre></div></div></div><h2 id="build-clamav-server" tabindex="-1">Build ClamAV server <a class="header-anchor" href="#build-clamav-server" aria-label="Permalink to &quot;Build ClamAV server&quot;">​</a></h2><p>Before you build ClamAV download both the source along with the signature to verify its validity.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-jiP58" id="tab-kc8Xyrx" checked><label data-title="Ubuntu/Debian" for="tab-kc8Xyrx">Ubuntu/Debian</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wget https://www.clamav.net/downloads/production/clamav-1.0.5.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wget https://www.clamav.net/downloads/production/clamav-1.0.5.tar.gz.sig</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg --verify clamav-1.0.5.tar.gz.sig</span></span></code></pre></div></div></div><p>The output should say its a good signature from Talos.</p><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg: assuming signed data in &#39;clamav-1.0.5.tar.gz&#39;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg: Signature made Wed 07 Feb 2024 02:33:08 PM UTC</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg:                using RSA key CCE0DFD21EC1A9BF</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg: Good signature from &quot;Talos (Talos, Cisco Systems Inc.) &lt;research@sourcefire.com&gt;&quot; [unknown] // [!code focus]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg: WARNING: This key is not certified with a trusted signature!</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg:          There is no indication that the signature belongs to the owner.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Primary key fingerprint: C71C 5DF5 E1E7 D51C CB8B  9D5C CCE0 DFD2 1EC1 A9BF</span></span></code></pre></div><p>Proceed to extract, test our build and install ClamAV.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>This may take a while.</p></div><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-k7uAx" id="tab-FjHOmvE" checked><label data-title="Ubuntu/Debian" for="tab-FjHOmvE">Ubuntu/Debian</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tar -xvzf clamav-1.0.5.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd clamav-1.0.5</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">mkdir -p build</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd build</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cmake .. \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -D CMAKE_INSTALL_PREFIX=/usr \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -D CMAKE_INSTALL_LIBDIR=lib \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -D APP_CONFIG_DIRECTORY=/etc/clamav \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -D DATABASE_DIRECTORY=/var/lib/clamav \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -D ENABLE_JSON_SHARED=OFF</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cmake --build .</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ctest</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo cmake --build . --target install</span></span></code></pre></div></div></div><p>The test..</p><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Test project /home/toothpick/clamav-1.0.5/build</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      Start  1: libclamav</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1/11 Test  #1: libclamav ........................   Passed   16.38 sec</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      Start  2: libclamav_valgrind</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2/11 Test  #2: libclamav_valgrind ...............   Passed  146.36 sec</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      Start  3: libclamav_rust</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3/11 Test  #3: libclamav_rust ...................   Passed   42.91 sec</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      Start  4: clamscan</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4/11 Test  #4: clamscan .........................   Passed    8.22 sec</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      Start  5: clamscan_valgrind</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5/11 Test  #5: clamscan_valgrind ................   Passed  251.18 sec</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      Start  6: clamd</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 6/11 Test  #6: clamd ............................   Passed   22.88 sec</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      Start  7: clamd_valgrind</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 7/11 Test  #7: clamd_valgrind ...................   Passed  105.70 sec</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      Start  8: freshclam</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8/11 Test  #8: freshclam ........................   Passed   42.38 sec</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      Start  9: freshclam_valgrind</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 9/11 Test  #9: freshclam_valgrind ...............   Passed   73.86 sec</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      Start 10: sigtool</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10/11 Test #10: sigtool ..........................   Passed    1.23 sec</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      Start 11: sigtool_valgrind</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">11/11 Test #11: sigtool_valgrind .................   Passed   22.64 sec</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100% tests passed, 0 tests failed out of 11 // [!code focus]</span></span></code></pre></div><h2 id="server-configuration" tabindex="-1">Server configuration <a class="header-anchor" href="#server-configuration" aria-label="Permalink to &quot;Server configuration&quot;">​</a></h2><p>Once the ClamAV installation is complete, a default example configuration file is created at <code>/etc/clamav/clamd.conf.sample</code>. We suggest you read through the example to familiarize yourself with the options. Alternatively, you may use and create the configuration file below.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>To enable ClamAV to operate as a centralized server and read client data, we need to enable TCP socket 3310.</p></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>When using ClamAV over TCP, the communication is not encrypted, so take precautions to mitigate any security risks.</p></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo bash -c &#39;cat &lt;&lt; EOF &gt; /etc/clamav/clamd.conf</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LocalSocket /var/run/clamav/clamd.socket</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FixStaleSocket true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LocalSocketGroup clamav</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LocalSocketMode 666</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">User clamav</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TCPSocket 3310 // [!code highlight]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ScanMail true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ScanArchive true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ArchiveBlockEncrypted false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaxDirectoryRecursion 15</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FollowDirectorySymlinks false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FollowFileSymlinks false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ReadTimeout 180</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaxThreads 12</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaxConnectionQueueLength 15</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LogSyslog false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LogRotate true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LogFacility LOG_LOCAL6</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LogClean false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LogVerbose false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PreludeEnable no</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PreludeAnalyzerName ClamAV</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DatabaseDirectory /var/lib/clamav</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">OfficialDatabaseOnly false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">SelfCheck 3600</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Foreground false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Debug false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ScanPE true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaxEmbeddedPE 10M</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ScanOLE2 true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ScanPDF true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ScanHTML true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaxHTMLNormalize 10M</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaxHTMLNoTags 2M</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaxScriptNormalize 5M</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaxZipTypeRcg 1M</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ScanSWF true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ExitOnOOM false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LeaveTemporaryFiles false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AlgorithmicDetection true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ScanELF true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">IdleTimeout 30</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CrossFilesystems true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PhishingSignatures true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PhishingScanURLs true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PhishingAlwaysBlockSSLMismatch false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PhishingAlwaysBlockCloak false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PartitionIntersection false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DetectPUA false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ScanPartialMessages false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">HeuristicScanPrecedence false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StructuredDataDetection false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CommandReadTimeout 30</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">SendBufTimeout 200</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaxQueue 100</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ExtendedDetectionInfo true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">OLE2BlockMacros false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AllowAllMatchScan true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ForceToDisk false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DisableCertCheck false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DisableCache false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaxScanTime 120000</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaxScanSize 100M</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaxFileSize 25M</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaxRecursion 16</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaxFiles 10000</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaxPartitions 50</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaxIconsPE 100</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PCREMatchLimit 10000</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PCRERecMatchLimit 5000</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">PCREMaxFileSize 25M</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ScanXMLDOCS true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ScanHWP3 true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaxRecHWP3 16</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StreamMaxLength 25M</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LogFile /var/log/clamav/clamav.log</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LogTime true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LogFileUnlock false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LogFileMaxSize 0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Bytecode true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BytecodeSecurity TrustSigned</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BytecodeTimeout 60000</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">OnAccessMaxFileSize 5M</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EOF&#39;</span></span></code></pre></div><h2 id="virus-signature-database" tabindex="-1">Virus signature database <a class="header-anchor" href="#virus-signature-database" aria-label="Permalink to &quot;Virus signature database&quot;">​</a></h2><p>To keep the ClamAV Anti-virus Engine&#39;s virus definition database up to date, we will use freshclam. By default, freshclam checks 12 times per day (every two hours) for new virus definitions. Similar to the ClamAV daemon, an example configuration file is created. Alternatively, you may create and use the configuration file provided below.</p><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo bash -c &#39;cat &lt;&lt; EOF &gt; /etc/clamav/freshclam.conf</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DatabaseOwner clamav</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">UpdateLogFile /var/log/clamav/freshclam.log</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LogVerbose false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LogSyslog false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LogFacility LOG_LOCAL6</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LogFileMaxSize 0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LogRotate true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LogTime true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Foreground false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Debug false</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MaxAttempts 5</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DatabaseDirectory /var/lib/clamav</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DNSDatabaseInfo current.cvd.clamav.net</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ConnectTimeout 30</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ReceiveTimeout 0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TestDatabases yes</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ScriptedUpdates yes</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CompressLocalDatabase no</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Bytecode true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NotifyClamd /etc/clamav/clamd.conf</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Checks 12 // [!code highlight]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DatabaseMirror db.local.clamav.net</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DatabaseMirror database.clamav.net</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EOF&#39;</span></span></code></pre></div><h2 id="system-unit-files" tabindex="-1">System unit files <a class="header-anchor" href="#system-unit-files" aria-label="Permalink to &quot;System unit files&quot;">​</a></h2><p>Before we&#39;ll create the system files for both the ClamAV daemon and freshclam create the required directories and adjust the owner permissions.</p><p>sudo mkdir /var/log/clamav/ /var/lib/clamav /var/run/clamav/ &amp;&amp; <br> sudo chown clamav:clamav /var/log/clamav/ /var/lib/clamav /var/run/clamav/</p><p>touch /var/log/freshclam.log chmod 600 /var/log/freshclam.log chown clamav /var/log/freshclam.log</p><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo bash -c &#39;cat &lt;&lt; EOF &gt; /etc/systemd/system/clamav-daemon.service</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">[Unit]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Description=Clam AntiVirus userspace daemon</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Documentation=man:clamd(8) man:clamd.conf(5) https://www.clamav.net/documents/</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ConditionPathExistsGlob=/var/lib/clamav/main.{c[vl]d,inc}</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ConditionPathExistsGlob=/var/lib/clamav/daily.{c[vl]d,inc}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">[Service]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">User=clamav</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Group=clamav</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ExecStart=/usr/sbin/clamd --foreground=true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ExecReload=/bin/kill -USR2 $MAINPID</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StandardOutput=syslog</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TimeoutStartSec=420</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">[Install]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">WantedBy=multi-user.target</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EOF&#39;</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo bash -c &#39;cat &lt;&lt; EOF &gt; /etc/systemd/system/clamav-freshclam.service</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">[Unit]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Description=ClamAV virus database updater</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Documentation=man:freshclam(1) man:freshclam.conf(5) https://www.clamav.net/documents</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ConditionPathExists=!/etc/cron.d/clamav-freshclam</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Wants=network-online.target</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">After=network-online.target</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">[Service]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">User=clamav</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Group=clamav</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ExecStart=/usr/bin/freshclam -d --foreground=true</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">StandardOutput=syslog</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">[Install]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">WantedBy=multi-user.target</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">EOF&#39;</span></span></code></pre></div><p>To enable the created startup scripts, reload the system control daemon.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-NLx7q" id="tab-PauuGLK" checked><label data-title="Ubuntu/Debian" for="tab-PauuGLK">Ubuntu/Debian</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo systemctl daemon-reload</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo systemctl enable clamav-freshclam.service</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo systemctl enable clamav-daemon.service</span></span></code></pre></div></div></div><p>Next start each service.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-Ddkzd" id="tab-lMjoUeE" checked><label data-title="Ubuntu/Debian" for="tab-lMjoUeE">Ubuntu/Debian</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo systemctl start clamav-freshclam.service</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo systemctl start clamav-daemon.service</span></span></code></pre></div></div></div><p>You can use the <code>clamdtop</code> command-line tool when you&#39;ve installed ClamAV on your clients. This tool enables you to monitor the ClamAV daemon performance and client connections during scan.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-CwIpR" id="tab-f2rkpwx" checked><label data-title="Ubuntu/Debian" for="tab-f2rkpwx">Ubuntu/Debian</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">clamdtop</span></span></code></pre></div></div></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  _____/ /___ _____ ___  ____/ / /_____  ____</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> / ___/ / __ \`/ __ \`__ \\/ __  / __/ __ \\/ __ \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">/ /__/ / /_/ / / / / / / /_/ / /_/ /_/ / /_/ /</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\___/_/\\__,_/_/ /_/ /_/\\__,_/\\__/\\____/ .___/</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                                     /_/</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Connecting to: /var/run/clamav/clamd.ctl</span></span></code></pre></div><h2 id="linux-client" tabindex="-1">Linux client <a class="header-anchor" href="#linux-client" aria-label="Permalink to &quot;Linux client&quot;">​</a></h2><p>Install ClamAV on Ubuntu 20.04.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-HUGzt" id="tab-y_vfRaY" checked><label data-title="shell-session" for="tab-y_vfRaY">shell-session</label></div><div class="blocks"><p>::: code-group-item Ubuntu</p><div class="language-shell-session vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>client@ubuntu:~$ sudo apt-get install clamav clamav-daemon</span></span></code></pre></div><p>:::</p></div></div><p>Next stop and disable the ClamAV daemon (as we will forward the traffic to the ClamAV server). The virus definitions database is managed on the server so you need to stop and disable the freshclam service as well.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-N-dCE" id="tab-RK0Qs-V" checked><label data-title="shell-session" for="tab-RK0Qs-V">shell-session</label></div><div class="blocks"><p>::: code-group-item Ubuntu</p><div class="language-shell-session vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>client@ubuntu:~$ sudo systemctl stop clamav-daemon.service</span></span>
<span class="line"><span>client@ubuntu:~$ sudo systemctl stop clamav-freshclam.service</span></span>
<span class="line"><span>client@ubuntu:~$ sudo systemctl disable clamav-daemon.service</span></span>
<span class="line"><span>client@ubuntu:~$ sudo systemctl disable clamav-freshclam.service</span></span></code></pre></div><p>:::</p></div></div><p>Continue to configure the <code>clamdscan</code> which share configuration file with the ClamAV daemon.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-M_9PR" id="tab-hZDRezR" checked><label data-title="shell-session" for="tab-hZDRezR">shell-session</label></div><div class="blocks"><p>::: code-group-item Ubuntu</p><div class="language-shell-session vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>client@ubuntu:~$ sudo nano /etc/clamav/clamd.conf</span></span></code></pre></div><p>:::</p></div></div><p>Comment the <code>LocalSocket /var/run/clamav/clamd.ctl</code> line and add the <code>TCPSocket 3310</code> along with the server <code>TCPAddr</code>.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#Automatically Generated by clamav-daemon postinst</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#To reconfigure clamd run #dpkg-reconfigure clamav-daemon</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#Please read /usr/share/doc/clamav-daemon/README.Debian.gz for details</span></span>
<span class="line highlighted"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#LocalSocket /var/run/clamav/clamd.ctl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">FixStaleSocket</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">LocalSocketGroup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clamav</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">LocalSocketMode</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 666</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># TemporaryDirectory is not set to its default /tmp here to make overriding</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># the default with environment variables TMPDIR/TMP/TEMP possible</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">User</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clamav</span></span>
<span class="line highlighted"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TCPSocket</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3310</span></span>
<span class="line highlighted"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TCPAddr</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.0.1</span></span></code></pre></div><p>When running a scan use the <code>multiscan</code> option to enable multihread reading. You can also set it to <code>quiet</code> if you&#39;re going to use the <code>log</code> option. You can also create a <code>file list</code> for all the directories to scan.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-83Ro4" id="tab-XMKuNtb" checked><label data-title="shell-session" for="tab-XMKuNtb">shell-session</label></div><div class="blocks"><p>::: code-group-item Ubuntu</p><div class="language-shell-session vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>client@ubuntu:~$ sudo clamdscan --multiscan --quiet --file-list= --log=</span></span></code></pre></div><p>:::</p></div></div><h2 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">​</a></h2><p>In case you&#39;ll need help troubleshooting or support for ClamAV you can sign up for their mailing list at <a href="https://lists.clamav.net/mailman/listinfo/clamav-users" target="_blank" rel="noreferrer">ClamAV users</a>.</p><p><a target="_blank" class="dark-only" href="https://betteruptime.com/"><img style="width:130px;height:52px;" alt="Better Uptime Website Monitoring" src="https://betteruptime.com/assets/static_assets/badges/dark.png"></a><a target="_blank" class="light-only" href="https://betteruptime.com/"><img style="width:130px;height:52px;" alt="Better Uptime Website Monitoring" src="https://betteruptime.com/assets/static_assets/badges/light.png"></a></p>`,63))])}const b=e(d,[["render",r]]);export{m as __pageData,b as default};
