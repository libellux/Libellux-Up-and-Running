import{_ as s,c as a,o as i,a5 as n}from"./chunks/framework.CyCwqgnw.js";const u=JSON.parse('{"title":"Snort Network Intrusion Detection","description":null,"frontmatter":{"title":"Snort Network Intrusion Detection","description":null,"head":[["link",{"rel":"canonical","href":"https://libellux.com/intrusion-detection/snort.html"}]]},"headers":[],"relativePath":"intrusion-detection/snort.md","filePath":"intrusion-detection/snort.md","lastUpdated":1720978488000}'),t={name:"intrusion-detection/snort.md"},l=n(`<h1 id="snort-network-intrusion-detection" tabindex="-1">Snort Network Intrusion Detection <a class="header-anchor" href="#snort-network-intrusion-detection" aria-label="Permalink to &quot;Snort Network Intrusion Detection&quot;">​</a></h1><p><a href="https://ko-fi.com/B0B31BJU3" target="_blank"><img height="36" style="border:0px;height:36px;" src="https://storage.ko-fi.com/cdn/kofi5.png?v=3" border="0" alt="Buy Me a Coffee at ko-fi.com"></a></p><h2 id="install-snort-3-from-source" tabindex="-1">Install Snort 3 from source <a class="header-anchor" href="#install-snort-3-from-source" aria-label="Permalink to &quot;Install Snort 3 from source&quot;">​</a></h2><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Supported distributions:</p><ul><li>Ubuntu 22.04 (Jammy Jellyfish)</li><li>Debian 12 (Bookworm)</li><li>Rocky Linux 9 (Blue Onyx)</li></ul></div><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-UdAis" id="tab-9g_K12p" checked="checked"><label for="tab-9g_K12p">Ubuntu</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo apt-get update --assume-yes</span></span></code></pre></div></div></div><p><a href="https://github.com/snort3/snort3/blob/master/doc/user/tutorial.txt#L6" target="_blank" rel="noreferrer">https://github.com/snort3/snort3/blob/master/doc/user/tutorial.txt#L6</a></p><p>Optional pkgs: <a href="https://github.com/snort3/snort3/blob/master/doc/user/tutorial.txt#L36" target="_blank" rel="noreferrer">https://github.com/snort3/snort3/blob/master/doc/user/tutorial.txt#L36</a></p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-kdkKO" id="tab-_7qvNCo" checked="checked"><label for="tab-_7qvNCo">Ubuntu</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo apt-get install --assume-yes \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">build-essential \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libpcap-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libpcre3-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libnet1-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">zlib1g-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">luajit \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">hwloc \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libdnet-dev \\ </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libdumbnet-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bison \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">flex \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">liblzma-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">openssl \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libssl-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pkg-config \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libhwloc-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cmake \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cpputest \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libsqlite3-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">uuid-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libcmocka-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libnetfilter-queue-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libmnl-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">autotools-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libluajit-5.1-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libunwind-dev \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libfl-dev</span></span></code></pre></div></div></div><h2 id="snort-daq" tabindex="-1">Snort DAQ <a class="header-anchor" href="#snort-daq" aria-label="Permalink to &quot;Snort DAQ&quot;">​</a></h2><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-obTvQ" id="tab-A3DIJA0" checked="checked"><label for="tab-A3DIJA0">Ubuntu</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wget https://www.snort.org/downloads/snortplus/libdaq-3.0.14.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tar -xvzf libdaq-3.0.14.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd libdaq-3.0.14</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">./bootstrap</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">./configure</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">make</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo make install</span></span></code></pre></div></div></div><p>cat /etc/ld.so.conf.d/libdaq3.conf /usr/local/lib/daq_s3/lib/</p><p>sudo ldconfig</p><p>tcmalloc is a library created by Google (PerfTools) for improving memory handling in threaded programs. The use of the library may lead to performance improvements and may reduce memory usage.</p><h2 id="build-snort" tabindex="-1">Build Snort <a class="header-anchor" href="#build-snort" aria-label="Permalink to &quot;Build Snort&quot;">​</a></h2><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group--vpxP" id="tab-Bwcbsdx" checked="checked"><label for="tab-Bwcbsdx">Ubuntu</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wget https://www.snort.org/downloads/snortplus/snort3-3.1.78.0.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tar -xvzf snort3-3.1.78.0.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd snort3-3.1.78.0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">./configure_cmake.sh --prefix=/usr/local/snort --enable-tcmalloc</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                       --with-daq-includes=/usr/local/lib/daq_s3/include/ \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                       --with-daq-libraries=/usr/local/lib/daq_s3/lib/</span></span></code></pre></div></div></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark has-highlighted vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">snort version 3.1.78.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Install options:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    prefix:     /usr/local/snort</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    includes:   /usr/local/snort/include/snort</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    plugins:    /usr/local/snort/lib/snort</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Feature options:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    DAQ Modules:    Static (afpacket;bpf;dump;fst;gwlb;nfq;pcap;savefile;trace)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    libatomic:      System-provided</span></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Hyperscan:      OFF</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    ICONV:          ON</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Libunwind:      ON</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    LZMA:           ON</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    RPC DB:         Built-in</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    SafeC:          OFF</span></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    TCMalloc:       OFF</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    JEMalloc:       OFF</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    UUID:           ON</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    NUMA:           ON</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-------------------------------------------------------</span></span></code></pre></div><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-7KTO_" id="tab-RMfmzr7" checked="checked"><label for="tab-RMfmzr7">Ubuntu</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd build</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">make -j $(nproc)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo make install</span></span></code></pre></div></div></div><h2 id="snort-3-extra" tabindex="-1">Snort 3 Extra <a class="header-anchor" href="#snort-3-extra" aria-label="Permalink to &quot;Snort 3 Extra&quot;">​</a></h2><h2 id="testing" tabindex="-1">Testing <a class="header-anchor" href="#testing" aria-label="Permalink to &quot;Testing&quot;">​</a></h2><p>/usr/local/snort/bin/snort: error while loading shared libraries: libdaq.so.3: cannot open shared object file: No such file or directory</p><p>snort -c snort.lua --pcap-dir ./pcaps --pcap-filter &#39;*.pcap&#39; -l /var/log/snort plugin-path /extra -k none -z --4</p><p>snort -c /usr/local/snort/etc/snort/snort.lua -r test.pcap -l /var/log/snort --plugin-path /usr/local/snort/extra -k none</p><p><a target="_blank" class="dark-only" href="https://betteruptime.com/"><img style="width:130px;height:52px;" alt="Better Uptime Website Monitoring" src="https://betteruptime.com/assets/static_assets/badges/dark.png"></a><a target="_blank" class="light-only" href="https://betteruptime.com/"><img style="width:130px;height:52px;" alt="Better Uptime Website Monitoring" src="https://betteruptime.com/assets/static_assets/badges/light.png"></a></p>`,23),e=[l];function p(r,o,h,d,c,k){return i(),a("div",null,e)}const b=s(t,[["render",p]]);export{u as __pageData,b as default};
