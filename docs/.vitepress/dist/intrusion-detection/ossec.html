<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>OSSEC Host Intrusion Detection System | Libellux</title>
    <meta name="description" content="Install OSSEC from source">
    <meta name="generator" content="VitePress v1.0.0-rc.44">
    <link rel="preload stylesheet" href="/assets/style.kMoWURfF.css" as="style">
    
    <script type="module" src="/assets/app.CGpIB-_U.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Bu8hRsVA.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.BO5XLpUq.js">
    <link rel="modulepreload" href="/assets/chunks/theme.LMTHYcHf.js">
    <link rel="modulepreload" href="/assets/intrusion-detection_ossec.md.BbgwYq7J.lean.js">
    <link rel="icon" href="/favicon.ico">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BF661YHCGV"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-BF661YHCGV");</script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"dark",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
    <link rel="canonical" href="https://libellux.com/intrusion-detection/ossec.html">
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c3508ec8></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c3508ec8> Skip to content </a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar has-sidebar" data-v-f1e365da data-v-b9c8b02d><div class="wrapper" data-v-b9c8b02d><div class="container" data-v-b9c8b02d><div class="title" data-v-b9c8b02d><div class="VPNavBarTitle has-sidebar" data-v-b9c8b02d data-v-28a961f9><a class="title" href="/" data-v-28a961f9><!--[--><!--]--><!--[--><img class="VPImage logo" src="/img/72x72.png" alt data-v-35a7d0b8><!--]--><span data-v-28a961f9>Libellux</span><!--[--><!--]--></a></div></div><div class="content" data-v-b9c8b02d><div class="content-body" data-v-b9c8b02d><!--[--><!--]--><div class="VPNavBarSearch search" data-v-b9c8b02d><!--[--><!----><div id="docsearch"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-b9c8b02d data-v-492ea56d><span id="main-nav-aria-label" class="visually-hidden" data-v-492ea56d>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/getting-started" tabindex="0" data-v-492ea56d data-v-2781b5e7><!--[--><span data-v-2781b5e7>Get started</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://status.libellux.com" target="_blank" rel="noreferrer" tabindex="0" data-v-492ea56d data-v-2781b5e7><!--[--><span data-v-2781b5e7>Status</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-b9c8b02d data-v-ead91a81><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to light theme" aria-checked="true" data-v-ead91a81 data-v-b79b56d4 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-b79b56d4></span><span class="vpi-moon moon" data-v-b79b56d4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-b9c8b02d data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/libellux/Libellux-Up-and-Running" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-717b8b75><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-b9c8b02d data-v-9b536d0b data-v-e5380155><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-e5380155><span class="vpi-more-horizontal icon" data-v-e5380155></span></button><div class="menu" data-v-e5380155><div class="VPMenu" data-v-e5380155 data-v-97491713><!----><!--[--><!--[--><!----><div class="group" data-v-9b536d0b><div class="item appearance" data-v-9b536d0b><p class="label" data-v-9b536d0b>Appearance</p><div class="appearance-action" data-v-9b536d0b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to light theme" aria-checked="true" data-v-9b536d0b data-v-b79b56d4 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-b79b56d4></span><span class="vpi-moon moon" data-v-b79b56d4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-9b536d0b><div class="item social-links" data-v-9b536d0b><div class="VPSocialLinks social-links-list" data-v-9b536d0b data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/libellux/Libellux-Up-and-Running" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-717b8b75><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-b9c8b02d data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-b9c8b02d><div class="divider-line" data-v-b9c8b02d></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-c9ba27ad><button data-v-c9ba27ad>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-ec846e01><div class="curtain" data-v-ec846e01></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-ec846e01><span class="visually-hidden" id="sidebar-aria-label" data-v-ec846e01> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-ec846e01><section class="VPSidebarItem level-0" data-v-ec846e01 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h2 class="text" data-v-f24171a4>Up and Running</h2><!----></div><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-1 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/getting-started" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>Introduction</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/release-notes" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>Release notes</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-ec846e01><section class="VPSidebarItem level-0" data-v-ec846e01 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h2 class="text" data-v-f24171a4>Zero Trust Network</h2><!----></div><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-1 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>WireGuard Secure VPN Tunnel</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-ec846e01><section class="VPSidebarItem level-0 has-active" data-v-ec846e01 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h2 class="text" data-v-f24171a4>Intrusion Detection and Prevention </h2><!----></div><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-1 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/intrusion-detection/greenbone-vulnerability-manager" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>Greenbone Vulnerability Manager</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/intrusion-detection/ossec" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>OSSEC Host Intrusion Detection</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/intrusion-detection/clamav" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>ClamAV Anti-virus Engine</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/intrusion-detection/snort" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>Snort Network Intrusion Detection</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>PSAD Port Scan Attack Detector</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-6d7b3c46 data-v-c14bfc45><div class="content" data-v-c14bfc45><div class="outline-marker" data-v-c14bfc45></div><div class="outline-title" role="heading" aria-level="2" data-v-c14bfc45>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-c14bfc45><span class="visually-hidden" id="doc-outline-aria-label" data-v-c14bfc45> Table of Contents for current page </span><ul class="VPDocOutlineItem root" data-v-c14bfc45 data-v-3f927ebe><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _intrusion-detection_ossec" data-v-83890dd9><div><h1 id="ossec-host-intrusion-detection-system" tabindex="-1">OSSEC Host Intrusion Detection System <span class="VPBadge tip"><!--[-->Rev 4<!--]--></span> <a class="header-anchor" href="#ossec-host-intrusion-detection-system" aria-label="Permalink to &quot;OSSEC Host Intrusion Detection System &lt;Badge text=&quot;Rev 4&quot; type=&quot;tip&quot;/&gt;&quot;">​</a></h1><p>OSSEC is a full platform to monitor and control your systems. It mixes all aspects of HIDS (host-based intrusion detection), log monitoring and SIM/SIEM together in a simple, powerful and open source solution.</p><p><a href="https://ko-fi.com/B0B31BJU3" target="_blank"><img height="36" style="border:0px;height:36px;" src="https://storage.ko-fi.com/cdn/kofi5.png?v=3" border="0" alt="Buy Me a Coffee at ko-fi.com"></a></p><h2 id="install-ossec-from-source" tabindex="-1">Install OSSEC from source <a class="header-anchor" href="#install-ossec-from-source" aria-label="Permalink to &quot;Install OSSEC from source&quot;">​</a></h2><p>To build OSSEC 3.7.0 from source, we need to first install its prerequisites.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Supported distributions:</p><ul><li>Ubuntu 22.04 (Jammy Jellyfish)</li><li>Rocky Linux 9 (Blue Onyx)</li></ul></div><p>Begin by updating your system.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-CeQGx" id="tab-WjvhLaY" checked="checked"><label for="tab-WjvhLaY">Ubuntu</label><input type="radio" name="group-CeQGx" id="tab-n3aE3A8"><label for="tab-n3aE3A8">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo apt-get update --assume-yes</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo dnf update --assumeyes</span></span></code></pre></div></div></div><p>Proceed to install the required dependencies for OSSEC.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Optional dependencies are highlighted for clarity.</p></div><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-z0jyN" id="tab-SQQdhzb" checked="checked"><label for="tab-SQQdhzb">Ubuntu</label><input type="radio" name="group-z0jyN" id="tab-9hIYbfb"><label for="tab-9hIYbfb">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark has-highlighted vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo apt-get install --no-install-recommends --assume-yes \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">build-essential \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">zlib1g-dev \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libpcre2-dev \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libevent-dev \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libssl-dev \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libsystemd-dev \</span></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">jq</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark has-highlighted vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo dnf install --assumeyes \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">make \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gcc \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libevent-devel \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">openssl-devel \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">zlib-devel \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pcre2-devel \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">systemd-devel \</span></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">jq</span></span></code></pre></div></div></div><h2 id="import-ossec-signing-key" tabindex="-1">Import OSSEC signing key <a class="header-anchor" href="#import-ossec-signing-key" aria-label="Permalink to &quot;Import OSSEC signing key&quot;">​</a></h2><p>Before downloading the latest version of OSSEC, retrieve and import the corresponding certificate and key file.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-JjhK5" id="tab-1ExADCe" checked="checked"><label for="tab-1ExADCe">Ubuntu</label><input type="radio" name="group-JjhK5" id="tab-BQKDiNK"><label for="tab-BQKDiNK">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wget http://www.ossec.net/files/OSSEC-ARCHIVE-KEY.asc</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wget https://github.com/ossec/ossec-hids/releases/download/3.7.0/ossec-hids-3.7.0.tar.gz.asc</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg --import OSSEC-ARCHIVE-KEY.asc</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wget http://www.ossec.net/files/OSSEC-ARCHIVE-KEY.asc</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wget https://github.com/ossec/ossec-hids/releases/download/3.7.0/ossec-hids-3.7.0.tar.gz.asc</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg --import OSSEC-ARCHIVE-KEY.asc</span></span></code></pre></div></div></div><p>Edit the OSSEC signing key to establish ultimate trust.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-jd90l" id="tab-Ajb9tmc" checked="checked"><label for="tab-Ajb9tmc">Ubuntu</label><input type="radio" name="group-jd90l" id="tab-nkQ8QYI"><label for="tab-nkQ8QYI">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo &quot;B50FB1947A0AE31145D05FADEE1B0E6B2D8387B7:6:&quot; &gt; /tmp/ownertrust.txt</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg --import-ownertrust &lt; /tmp/ownertrust.txt</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo &quot;B50FB1947A0AE31145D05FADEE1B0E6B2D8387B7:6:&quot; &gt; /tmp/ownertrust.txt</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg --import-ownertrust &lt; /tmp/ownertrust.txt</span></span></code></pre></div></div></div><p>Next, download the latest version of OSSEC and verify the integrity of the file.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-p4Prs" id="tab-5LeJxJT" checked="checked"><label for="tab-5LeJxJT">Ubuntu</label><input type="radio" name="group-p4Prs" id="tab-yj3XhqD"><label for="tab-yj3XhqD">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wget https://github.com/ossec/ossec-hids/archive/3.7.0.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg --verify ossec-hids-3.7.0.tar.gz.asc 3.7.0.tar.gz</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wget https://github.com/ossec/ossec-hids/archive/3.7.0.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg --verify ossec-hids-3.7.0.tar.gz.asc 3.7.0.tar.gz</span></span></code></pre></div></div></div><p>The signature output is supposed to look as follows.</p><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark has-focused-lines vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg: Signature made Mon 17 Jan 2022 04:09:10 PM UTC</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg:                using RSA key B50FB1947A0AE31145D05FADEE1B0E6B2D8387B7</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg: checking the trustdb</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg: marginals needed: 3  completes needed: 1  trust model: pgp</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg: depth: 0  valid:   1  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 1u</span></span>
<span class="line has-focus"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg: Good signature from &quot;Scott R. Shinn &lt;scott@atomicorp.com&gt;&quot; [ultimate]</span></span></code></pre></div><h2 id="build-ossec-server" tabindex="-1">Build OSSEC server <a class="header-anchor" href="#build-ossec-server" aria-label="Permalink to &quot;Build OSSEC server&quot;">​</a></h2><p>Extract and run the installation script with PCRE2 support enabled.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-7IhWF" id="tab-6a27Mxw" checked="checked"><label for="tab-6a27Mxw">Ubuntu</label><input type="radio" name="group-7IhWF" id="tab-WJY0lgK"><label for="tab-WJY0lgK">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tar -zxvf 3.7.0.tar.gz &amp;&amp; cd ossec-hids-3.7.0/</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wget https://github.com/PCRE2Project/pcre2/releases/download/pcre2-10.40/pcre2-10.40.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tar -zxvf pcre2-10.40.tar.gz -C src/external/</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo PCRE2_SYSTEM=yes ./install.sh</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tar -zxvf 3.7.0.tar.gz &amp;&amp; cd ossec-hids-3.7.0/</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wget https://github.com/PCRE2Project/pcre2/releases/download/pcre2-10.40/pcre2-10.40.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tar -zxvf pcre2-10.40.tar.gz -C src/external/</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo PCRE2_SYSTEM=yes ./install.sh</span></span></code></pre></div></div></div><p>Select your preferred language and choose server installation. Adjust the options to suit your requirements.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Suggested (y/n) options are selected.</p></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">(en/br/cn/de/el/es/fr/hu/it/jp/nl/pl/ru/sr/tr) [en]:</span></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">What kind of installation do you want (server, agent, local, hybrid or help)? server</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Choose where to install the OSSEC HIDS [/var/ossec/]:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Do you want e-mail notification? (y/n) [y]: n</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Do you want to run the integrity check daemon? (y/n) [y]: y</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Do you want to run the rootkit detection engine? (y/n) [y]: y</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Do you want to enable active response? (y/n) [y]: y</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Do you want to enable the firewall-drop response? (y/n) [y]: y</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Do you want to add more IPs to the white list? (y/n)? [n]: n</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Do you want to enable remote syslog (port 514 udp)? (y/n) [y]: y</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">--- Press ENTER to finish (maybe more information below). ---</span></span></code></pre></div><details class="details custom-block"><summary>Click to view full installation process</summary><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> OSSEC HIDS v3.7.0 Installation Script - http://www.ossec.net</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> You are about to start the installation process of the OSSEC HIDS.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> You must have a C compiler pre-installed in your system.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  - System: Linux libellux 5.4.0-84-generic</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  - User: root</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  - Host: libellux</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -- Press ENTER to continue or Ctrl-C to abort. --</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1- What kind of installation do you want (server, agent, local, hybrid or help)? server</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  - Server installation chosen.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2- Setting up the installation environment.</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> - Choose where to install the OSSEC HIDS [/var/ossec/]:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    - Installation will be made at  /var/ossec .</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3- Configure the OSSEC HIDS.</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  3.1- Do you want e-mail notification? (y/n) [y]: n</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   --- Email notification disabled.</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  3.2- Do you want to run the integrity check daemon? (y/n) [y]: y</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   - Running syscheck (integrity check daemon).</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  3.3- Do you want to run the rootkit detection engine? (y/n) [y]: y</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   - Running rootcheck (rootkit detection).</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  3.4- Active response allows you to execute a specific</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">       command based on the events received. For example,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">       you can block an IP address or disable access for</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">       a specific user.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">       More information at:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">       http://www.ossec.net/en/manual.html#active-response</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  </span></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   - Do you want to enable active response? (y/n) [y]: y</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     - Active response enabled.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   - By default, we can enable the host-deny and the</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     firewall-drop responses. The first one will add</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     a host to the /etc/hosts.deny and the second one</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     will block the host on iptables (if linux) or on</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     ipfilter (if Solaris, FreeBSD or NetBSD).</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   - They can be used to stop SSHD brute force scans,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     portscans and some other forms of attacks. You can</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     also add them to block on snort events, for example.</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   - Do you want to enable the firewall-drop response? (y/n) [y]: y</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     - firewall-drop enabled (local) for levels &gt;= 6</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   -</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      - 127.0.0.53</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   - Do you want to add more IPs to the white list? (y/n)? [n]: n</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  3.5- Do you want to enable remote syslog (port 514 udp)? (y/n) [y]: y</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   - Remote syslog enabled.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  3.6- Setting the configuration to analyze the following logs:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    -- /var/log/auth.log</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    -- /var/log/syslog</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    -- /var/log/dpkg.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> - If you want to monitor any other file, just change</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   the ossec.conf and add a new localfile entry.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   Any questions about the configuration can be answered</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   by visiting us online at http://www.ossec.net .</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">--- Press ENTER to finish ---</span></span></code></pre></div></details><h2 id="server-configuration" tabindex="-1">Server configuration <a class="header-anchor" href="#server-configuration" aria-label="Permalink to &quot;Server configuration&quot;">​</a></h2><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Configuration files:</p><ul><li><a href="/files/intrusion-detection/ossec/ossec.conf">ossec.conf</a></li></ul></div><h2 id="allow-list" tabindex="-1">Allow list <a class="header-anchor" href="#allow-list" aria-label="Permalink to &quot;Allow list&quot;">​</a></h2><p>In the global section of the OSSEC configuration file, include the IP addresses of the clients and services, such as <a href="/intrusion-detection/greenbone-vulnerability-manager">Greenbone Vulnerability Manager</a>, that we do not want to be blocked by active response.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-db_8B" id="tab-ANfpzcu" checked="checked"><label for="tab-ANfpzcu">Ubuntu</label><input type="radio" name="group-db_8B" id="tab-V3w8c9r"><label for="tab-V3w8c9r">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo nano /var/ossec/etc/ossec.conf</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo nano /var/ossec/etc/ossec.conf</span></span></code></pre></div></div></div><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark has-focused-lines vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">allow_list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;127.0.0.1&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">allow_list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">allow_list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;::1&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">allow_list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">allow_list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;localhost.localdomain&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">allow_list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">allow_list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;127.0.0.53&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">allow_list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line has-focus"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">allow_list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;192.168.0.2&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">allow_list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- OSSEC client --&gt;</span></span>
<span class="line has-focus"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">allow_list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;192.168.0.3&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">allow_list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- Greenbone Vulnerability Manager --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h2 id="remote-syslog" tabindex="-1">Remote syslog <a class="header-anchor" href="#remote-syslog" aria-label="Permalink to &quot;Remote syslog&quot;">​</a></h2><p>To enable the function of harvesting syslogs from our OSSEC agents, we&#39;ll need to ensure the security of our remote client connection and allow it. Add the client&#39;s IP address within the remote section.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-Znc9U" id="tab-kdmJMsX" checked="checked"><label for="tab-kdmJMsX">Ubuntu</label><input type="radio" name="group-Znc9U" id="tab-ASbyVoI"><label for="tab-ASbyVoI">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo nano /var/ossec/etc/ossec.conf</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo nano /var/ossec/etc/ossec.conf</span></span></code></pre></div></div></div><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark has-focused-lines vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">remote</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">connection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;secure&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">connection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line has-focus"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">allowed-ips</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;192.168.0.2&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">allowed-ips</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- OSSEC client --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">remote</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h2 id="active-response" tabindex="-1">Active response <a class="header-anchor" href="#active-response" aria-label="Permalink to &quot;Active response&quot;">​</a></h2><p>To enable active response on both agents and server regardless of where the event is created, set the location to &quot;all&quot;.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-HohUm" id="tab-Z34ERoH" checked="checked"><label for="tab-Z34ERoH">Ubuntu</label><input type="radio" name="group-HohUm" id="tab-cehEGAO"><label for="tab-cehEGAO">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo nano /var/ossec/etc/ossec.conf</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo nano /var/ossec/etc/ossec.conf</span></span></code></pre></div></div></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><ul><li>local: on the agent that generated the event</li><li>server: on the OSSEC server</li><li>defined-agent: on a specific agent (when using this option, you need to set the agent_id to use)</li><li>all: or everywhere.</li></ul></div><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark has-focused-lines vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  &lt;!-- Active Response Config --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">active-response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    &lt;!-- This response is going to execute the host-deny</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       - command for every event that fires a rule with</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       - level (severity) &gt;= 6.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       - The IP is going to be blocked for  600 seconds.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;host-deny&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line has-focus"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;all&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;6&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">timeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;600&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">timeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">active-response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">active-response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    &lt;!-- Firewall Drop response. Block the IP for</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       - 600 seconds on the firewall (iptables,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       - ipfilter, etc).</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;firewall-drop&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line has-focus"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;all&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;6&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">timeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;600&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">timeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">active-response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h2 id="repeat-offenders" tabindex="-1">Repeat offenders <a class="header-anchor" href="#repeat-offenders" aria-label="Permalink to &quot;Repeat offenders&quot;">​</a></h2><p>The first time an IP is blocked, it will be put on timeout for the default 600 seconds. If the IP is blocked again, it will be added to the defined repeating offenders list. To enable repeat offenders, add the entry in the active response config.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group--FSs2" id="tab-eY0CnKW" checked="checked"><label for="tab-eY0CnKW">Ubuntu</label><input type="radio" name="group--FSs2" id="tab-XstD2Cp"><label for="tab-XstD2Cp">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo nano /var/ossec/etc/ossec.conf</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo nano /var/ossec/etc/ossec.conf</span></span></code></pre></div></div></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Enable repeat offenders for both the &quot;host-deny&quot; and &quot;firewall-drop&quot; command.</p></div><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark has-focused-lines vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  &lt;!-- Active Response Config --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">active-response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    &lt;!-- This response is going to execute the host-deny</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       - command for every event that fires a rule with</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       - level (severity) &gt;= 6.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       - The IP is going to be blocked for  600 seconds.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;host-deny&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;all&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;6&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">timeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;600&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">timeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line has-focus"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">repeated_offenders</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;30,60,120,240,480&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">repeated_offenders</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">active-response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">active-response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    &lt;!-- Firewall Drop response. Block the IP for</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       - 600 seconds on the firewall (iptables,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       - ipfilter, etc).</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;firewall-drop&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;all&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;6&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">timeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;600&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">timeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line has-focus"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">repeated_offenders</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;30,60,120,240,480&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">repeated_offenders</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">active-response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>Save the config and start OSSEC to confirm that the repeated offenders been added.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-7kJjX" id="tab-SmLF84J" checked="checked"><label for="tab-SmLF84J">Ubuntu</label><input type="radio" name="group-7kJjX" id="tab-qoQP_7r"><label for="tab-qoQP_7r">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo /var/ossec/bin/ossec-control start</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo /var/ossec/bin/ossec-control start</span></span></code></pre></div></div></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark has-highlighted vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Starting OSSEC HIDS v3.7.0...</span></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2024/03/01 09:06:05 ossec-execd: INFO: Adding offenders timeout: 30 (for #1)</span></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2024/03/01 09:06:05 ossec-execd: INFO: Adding offenders timeout: 60 (for #2)</span></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2024/03/01 09:06:05 ossec-execd: INFO: Adding offenders timeout: 120 (for #3)</span></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2024/03/01 09:06:05 ossec-execd: INFO: Adding offenders timeout: 240 (for #4)</span></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2024/03/01 09:06:05 ossec-execd: INFO: Adding offenders timeout: 480 (for #5)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Started ossec-execd...</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Started ossec-analysisd...</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Started ossec-logcollector...</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Started ossec-remoted...</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Started ossec-syscheckd...</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Started ossec-monitord...</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Completed.</span></span></code></pre></div><h2 id="json-output" tabindex="-1">JSON output <a class="header-anchor" href="#json-output" aria-label="Permalink to &quot;JSON output&quot;">​</a></h2><p>In addition to standard alert logging, we will enable JSON output for <a href="/management/opensearch#install-fluent-bit">Fluent Bit</a> to forward alerts to <a href="/management/opensearch">OpenSearch</a>.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Learn how to forward OSSEC alerts to <a href="/management/opensearch">OpenSearch</a>.</p></div><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark has-focused-lines vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ossec_config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line has-focus"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">jsonout_output</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;yes&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">jsonout_output</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">email_notification</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;no&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">email_notification</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h2 id="snort-log-format" tabindex="-1">Snort log format <a class="header-anchor" href="#snort-log-format" aria-label="Permalink to &quot;Snort log format&quot;">​</a></h2><p>Depending on the Snort output format, define either &quot;snort-fast&quot; or &quot;snort-full&quot;. If Snort is running on a stand-alone server, define the log format on the OSSEC agent.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Learn how to select Snort output format.</p></div><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark has-focused-lines vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">localfile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line has-focus"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">log_format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;snort-fast&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">log_format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;/var/log/snort/alert&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">localfile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h2 id="additional-rulesets" tabindex="-1">Additional rulesets <a class="header-anchor" href="#additional-rulesets" aria-label="Permalink to &quot;Additional rulesets&quot;">​</a></h2><p>If PSAD Intrusion Detection is to be used, ensure to include the PSAD ruleset in the configuration file as it&#39;s not defined by default.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Please make sure that whenever you add another ruleset, such as <code>psad_rules.xml</code>, it is included ahead of the <code>local_rules.xml</code>.</p></div><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark has-focused-lines vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">include</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;openbsd-dhcpd_rules.xml&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">include</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">include</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;dnsmasq_rules.xml&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">include</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">include</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;nsd_rules.xml&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">include</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">include</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;unbound_rules.xml&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">include</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line has-focus"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">include</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;psad_rules.xml&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">include</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- PSAD rules --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">include</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;local_rules.xml&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">include</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">rules</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h2 id="agent-installation" tabindex="-1">Agent installation <a class="header-anchor" href="#agent-installation" aria-label="Permalink to &quot;Agent installation&quot;">​</a></h2><p>To install OSSEC 3.7.0 as an agent on either Ubuntu 22.04 or Rocky Linux 9, begin by updating your system and then download its prerequisites.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-yFyNQ" id="tab-dmYrhcQ" checked="checked"><label for="tab-dmYrhcQ">Ubuntu</label><input type="radio" name="group-yFyNQ" id="tab-2jBg3RE"><label for="tab-2jBg3RE">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo apt-get update --assume-yes</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo dnf update -assumeyes</span></span></code></pre></div></div></div><p>Proceed to install the required dependencies for OSSEC.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-cHkCT" id="tab-udc2OYo" checked="checked"><label for="tab-udc2OYo">Ubuntu</label><input type="radio" name="group-cHkCT" id="tab-T_wBX2W"><label for="tab-T_wBX2W">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo apt-get install --no-install-recommends --assume-yes \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">build-essential \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">zlib1g-dev \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libpcre2-dev \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libevent-dev \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libssl-dev</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo dnf install -assumeyes \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">make \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gcc \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">libevent-devel \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">openssl-devel \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">zlib-devel \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pcre2-devel \</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">systemd-devel</span></span></code></pre></div></div></div><h2 id="import-signing-key" tabindex="-1">Import signing key <a class="header-anchor" href="#import-signing-key" aria-label="Permalink to &quot;Import signing key&quot;">​</a></h2><p>Before downloading the latest version of OSSEC, retrieve and import the corresponding certificate and key file.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-ar7MN" id="tab-L3wTUUP" checked="checked"><label for="tab-L3wTUUP">Ubuntu</label><input type="radio" name="group-ar7MN" id="tab-mH49UUT"><label for="tab-mH49UUT">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wget http://www.ossec.net/files/OSSEC-ARCHIVE-KEY.asc</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wget https://github.com/ossec/ossec-hids/releases/download/3.7.0/ossec-hids-3.7.0.tar.gz.asc</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg --import OSSEC-ARCHIVE-KEY.asc</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wget http://www.ossec.net/files/OSSEC-ARCHIVE-KEY.asc</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wget https://github.com/ossec/ossec-hids/releases/download/3.7.0/ossec-hids-3.7.0.tar.gz.asc</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg --import OSSEC-ARCHIVE-KEY.asc</span></span></code></pre></div></div></div><p>Edit the OSSEC signing key to establish ultimate trust.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-ycESU" id="tab-z4kVAjU" checked="checked"><label for="tab-z4kVAjU">Ubuntu</label><input type="radio" name="group-ycESU" id="tab-46R80Lc"><label for="tab-46R80Lc">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo &quot;B50FB1947A0AE31145D05FADEE1B0E6B2D8387B7:6:&quot; &gt; /tmp/ownertrust.txt</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg --import-ownertrust &lt; /tmp/ownertrust.txt</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo &quot;B50FB1947A0AE31145D05FADEE1B0E6B2D8387B7:6:&quot; &gt; /tmp/ownertrust.txt</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg --import-ownertrust &lt; /tmp/ownertrust.txt</span></span></code></pre></div></div></div><p>Next, download the latest version of OSSEC and verify the integrity of the file.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-tMvWh" id="tab-2cOCQWn" checked="checked"><label for="tab-2cOCQWn">Ubuntu</label><input type="radio" name="group-tMvWh" id="tab-phKsMWs"><label for="tab-phKsMWs">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wget https://github.com/ossec/ossec-hids/archive/3.7.0.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg --verify ossec-hids-3.7.0.tar.gz.asc 3.7.0.tar.gz</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wget https://github.com/ossec/ossec-hids/archive/3.7.0.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg --verify ossec-hids-3.7.0.tar.gz.asc 3.7.0.tar.gz</span></span></code></pre></div></div></div><p>The signature output is supposed to look as follows.</p><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark has-focused-lines vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg: Signature made Mon 17 Jan 2022 04:09:10 PM UTC</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg:                using RSA key B50FB1947A0AE31145D05FADEE1B0E6B2D8387B7</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg: checking the trustdb</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg: marginals needed: 3  completes needed: 1  trust model: pgp</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg: depth: 0  valid:   1  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 1u</span></span>
<span class="line has-focus"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gpg: Good signature from &quot;Scott R. Shinn &lt;scott@atomicorp.com&gt;&quot; [ultimate]</span></span></code></pre></div><h2 id="build-ossec-agent" tabindex="-1">Build OSSEC agent <a class="header-anchor" href="#build-ossec-agent" aria-label="Permalink to &quot;Build OSSEC agent&quot;">​</a></h2><p>Extract and run the installation script with PCRE2 support enabled.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-YImcb" id="tab-4r43vSK" checked="checked"><label for="tab-4r43vSK">Ubuntu</label><input type="radio" name="group-YImcb" id="tab-X40k3-i"><label for="tab-X40k3-i">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tar -zxvf 3.7.0.tar.gz &amp;&amp; cd ossec-hids-3.7.0/</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wget https://github.com/PCRE2Project/pcre2/releases/download/pcre2-10.40/pcre2-10.40.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tar -zxvf pcre2-10.40.tar.gz -C src/external/</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo PCRE2_SYSTEM=yes ./install.sh</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tar -zxvf 3.7.0.tar.gz &amp;&amp; cd ossec-hids-3.7.0/</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wget https://github.com/PCRE2Project/pcre2/releases/download/pcre2-10.40/pcre2-10.40.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tar -zxvf pcre2-10.40.tar.gz -C src/external/</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo PCRE2_SYSTEM=yes ./install.sh</span></span></code></pre></div></div></div><p>Select your preferred language and choose agent installation. Adjust the options to suit your requirements.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Make sure to define your OSSEC server&#39;s IP address, which is highlighted in the output below.</p></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark has-highlighted vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">(en/br/cn/de/el/es/fr/hu/it/jp/nl/pl/ru/sr/tr) [en]:</span></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">What kind of installation do you want (server, agent, local, hybrid or help)? agent</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Choose where to install the OSSEC HIDS [/var/ossec/]:</span></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">What&#39;s the IP Address or hostname of the OSSEC HIDS server?: 192.168.0.1</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Do you want to run the integrity check daemon? (y/n) [y]: y</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Do you want to run the rootkit detection engine? (y/n) [y]: y</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Do you want to enable active response? (y/n) [y]: y</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">--- Press ENTER to finish (maybe more information below). ---</span></span></code></pre></div><details class="details custom-block"><summary>Click to view full installation process</summary><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> OSSEC HIDS v3.7.0 Installation Script - http://www.ossec.net</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> You are about to start the installation process of the OSSEC HIDS.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> You must have a C compiler pre-installed in your system.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  - System: Linux libellux 5.4.0-84-generic</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  - User: root</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  - Host: libellux</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -- Press ENTER to continue or Ctrl-C to abort. --</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1- What kind of installation do you want (server, agent, local, hybrid or help)? agent</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  - Agent(client) installation chosen.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2- Setting up the installation environment.</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> - Choose where to install the OSSEC HIDS [/var/ossec]:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    - Installation will be made at  /var/ossec .</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3- Configuring the OSSEC HIDS.</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  3.1- What&#39;s the IP Address or hostname of the OSSEC HIDS server?: 192.168.0.1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   - Adding Server IP 192.168.0.1</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  3.2- Do you want to run the integrity check daemon? (y/n) [y]: y</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   - Running syscheck (integrity check daemon).</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  3.3- Do you want to run the rootkit detection engine? (y/n) [y]: y</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   - Running rootcheck (rootkit detection).</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  3.4 - Do you want to enable active response? (y/n) [y]: y</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  3.5- Setting the configuration to analyze the following logs:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    -- /var/log/auth.log</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    -- /var/log/syslog</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    -- /var/log/dpkg.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> - If you want to monitor any other file, just change</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   the ossec.conf and add a new localfile entry.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   Any questions about the configuration can be answered</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   by visiting us online at http://www.ossec.net .</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   --- Press ENTER to continue ---</span></span></code></pre></div></details><h2 id="agent-configuration" tabindex="-1">Agent configuration <a class="header-anchor" href="#agent-configuration" aria-label="Permalink to &quot;Agent configuration&quot;">​</a></h2><p>Edit the agent configuration file and verify that the server IP address is correct. We will disable email notifications since we utilize other channels for alerts.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-3u8sL" id="tab-BR9y0py" checked="checked"><label for="tab-BR9y0py">Ubuntu</label><input type="radio" name="group-3u8sL" id="tab-K8YWgPJ"><label for="tab-K8YWgPJ">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo nano /var/ossec/etc/ossec.conf</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo nano /var/ossec/etc/ossec.conf</span></span></code></pre></div></div></div><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark has-focused-lines vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ossec_config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">client</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line has-focus"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">server-ip</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;192.168.0.1&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">server-ip</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- OSSEC server --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">config-profile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">config-profile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">client</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line has-focus"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">email_notification</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;no&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">email_notification</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h2 id="manage-agents" tabindex="-1">Manage agents <a class="header-anchor" href="#manage-agents" aria-label="Permalink to &quot;Manage agents&quot;">​</a></h2><p>To add an agent to your OSSEC server, execute the command displayed in the code segments below and proceed with the provided instructions.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-60G42" id="tab-VbuE3kB" checked="checked"><label for="tab-VbuE3kB">Ubuntu</label><input type="radio" name="group-60G42" id="tab-gGT8VnJ"><label for="tab-gGT8VnJ">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo /var/ossec/bin/manage_agents</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo /var/ossec/bin/manage_agents</span></span></code></pre></div></div></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark has-highlighted vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">****************************************</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">* OSSEC HIDS v3.7.0 Agent manager.     *</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">* The following options are available: *</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">****************************************</span></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   (A)dd an agent (A).</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   (E)xtract key for an agent (E).</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   (L)ist already added agents (L).</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   (R)emove an agent (R).</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   (Q)uit.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Choose your action: A,E,L,R or Q: A</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">- Adding a new agent (use &#39;\q&#39; to return to the main menu).</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  Please provide the following:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   * A name for the new agent: client</span></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   * The IP Address of the new agent: 192.168.0.2</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   * An ID for the new agent[001]: 001</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Agent information:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   ID:001</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   Name:client</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   IP Address:192.168.0.2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Confirm adding it?(y/n): y</span></span></code></pre></div><p>Once you&#39;ve added the client proceed by extracting its agent key by providing the assigned agent ID.</p><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark has-highlighted vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">****************************************</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">* OSSEC HIDS v3.7.0 Agent manager.     *</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">* The following options are available: *</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">****************************************</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   (A)dd an agent (A).</span></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   (E)xtract key for an agent (E).</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   (L)ist already added agents (L).</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   (R)emove an agent (R).</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   (Q)uit.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Choose your action: A,E,L,R or Q: E</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Available agents: </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   ID: 001, Name: client, IP: 192.168.0.2</span></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Provide the ID of the agent to extract the key (or &#39;\q&#39; to quit): 001</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Agent key information for &#39;001&#39; is: </span></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">523b0d579891be85956bb3da6c757455005eaf1508ef578186431efbebf5901ecb467ddd857ed5dfdeb5b2cb00e8911c6d031=</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">** Press ENTER to return to the main menu.</span></span></code></pre></div><p>Copy the agent key and head back to your OSSEC client and import the agent key. Execute the command - shown in the code section below – on the client and paste the key. Validate that your agent information is correct before adding it.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-rtNVZ" id="tab-CcYYtw9" checked="checked"><label for="tab-CcYYtw9">shell-session</label><input type="radio" name="group-rtNVZ" id="tab-3qNKIzR"><label for="tab-3qNKIzR">shell-session</label></div><div class="blocks"><p>::: code-group-item Ubuntu</p><div class="language-shell-session vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>client@ubuntu:~$ sudo /var/ossec/bin/manage_agents</span></span></code></pre></div><p>::: ::: code-group-item Rocky</p><div class="language-shell-session vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>client@rocky:~$ sudo /var/ossec/bin/manage_agents</span></span></code></pre></div><p>:::</p></div></div><div class="language-shell-session vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>****************************************</span></span>
<span class="line"><span>* OSSEC HIDS v3.6.0 Agent manager.     *</span></span>
<span class="line"><span>* The following options are available: *</span></span>
<span class="line"><span>****************************************</span></span>
<span class="line"><span>   (I)mport key from the server (I).</span></span>
<span class="line"><span>   (Q)uit.</span></span>
<span class="line highlighted"><span>Choose your action: I or Q: i</span></span>
<span class="line"><span></span></span>
<span class="line"><span>* Provide the Key generated by the server.</span></span>
<span class="line"><span>* The best approach is to cut and paste it.</span></span>
<span class="line"><span>*** OBS: Do not include spaces or new lines.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Paste it here (or &#39;\q&#39; to quit): </span></span>
<span class="line highlighted"><span>523b0d579891be85956bb3da6c757455005eaf1508ef578186431efbebf5901ecb467ddd857ed5dfdeb5b2cb00e8911c6d031=</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Agent information:</span></span>
<span class="line"><span>   ID:001</span></span>
<span class="line"><span>   Name:client</span></span>
<span class="line"><span>   IP Address:192.168.0.2</span></span>
<span class="line"><span></span></span>
<span class="line highlighted"><span>Confirm adding it?(y/n): y</span></span>
<span class="line"><span>Added.</span></span></code></pre></div><p>Finally restart the OSSEC server and the client to enable and activate OSSEC HIDS.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-DymCJ" id="tab-GoAROCQ" checked="checked"><label for="tab-GoAROCQ">shell-session</label><input type="radio" name="group-DymCJ" id="tab-fSR-3Cn"><label for="tab-fSR-3Cn">shell-session</label></div><div class="blocks"><p>::: code-group-item Ubuntu</p><div class="language-shell-session vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@ubuntu:~$ sudo /var/ossec/bin/ossec-control restart</span></span>
<span class="line"><span>client@ubuntu:~$ sudo /var/ossec/bin/ossec-control restart</span></span></code></pre></div><p>::: ::: code-group-item Rocky</p><div class="language-shell-session vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@rocky:~$ sudo /var/ossec/bin/ossec-control restart</span></span>
<span class="line"><span>client@rocky:~$ sudo /var/ossec/bin/ossec-control restart</span></span></code></pre></div><p>:::</p></div></div><p>To confirm that your agent is active, run the following command from the server.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-A9fc0" id="tab-07_uFH8" checked="checked"><label for="tab-07_uFH8">shell-session</label><input type="radio" name="group-A9fc0" id="tab-bRbXt3R"><label for="tab-bRbXt3R">shell-session</label></div><div class="blocks"><p>::: code-group-item Ubuntu</p><div class="language-shell-session vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line highlighted"><span>server@ubuntu:~$ sudo /var/ossec/bin/agent_control -lc</span></span>
<span class="line"><span></span></span>
<span class="line"><span>OSSEC HIDS agent_control. List of available agents:</span></span>
<span class="line"><span>   ID: 000, Name: server (server), IP: 127.0.0.1, Active/Local</span></span>
<span class="line highlighted"><span>   ID: 001, Name: client, IP: 192.168.0.2, Active</span></span></code></pre></div><p>::: ::: code-group-item Rocky</p><div class="language-shell-session vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line highlighted"><span>server@rocky:~$ sudo /var/ossec/bin/agent_control -lc</span></span>
<span class="line"><span></span></span>
<span class="line"><span>OSSEC HIDS agent_control. List of available agents:</span></span>
<span class="line"><span>   ID: 000, Name: server (server), IP: 127.0.0.1, Active/Local</span></span>
<span class="line highlighted"><span>   ID: 001, Name: client, IP: 192.168.0.2, Active</span></span></code></pre></div><p>:::</p></div></div><p>If the agent does not appear, make sure that the firewall settings are in place and that the correct ports are opened on both environments. See the <a href="#firewall-settings">Firewall settings</a> section for more information.</p><h2 id="agentless-monitoring" tabindex="-1">Agentless monitoring <a class="header-anchor" href="#agentless-monitoring" aria-label="Permalink to &quot;Agentless monitoring&quot;">​</a></h2><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>The agentless monitoring has so far only been tested with VMware ESXi 6.7. The result is still not 100% but will give an overview on how to configure your agentless servers or devices.</p></div><p>Generate SSH keys for the OSSEC user.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-OqIzc" id="tab-bWUMVeU" checked="checked"><label for="tab-bWUMVeU">shell-session</label><input type="radio" name="group-OqIzc" id="tab-hMTmkMP"><label for="tab-hMTmkMP">shell-session</label></div><div class="blocks"><p>::: code-group-item Ubuntu</p><div class="language-shell-session vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@ubuntu:~$ sudo -u ossec ssh-keygen</span></span></code></pre></div><p>::: ::: code-group-item Rocky</p><div class="language-shell-session vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@rocky:~$ sudo -u ossec ssh-keygen</span></span></code></pre></div><p>:::</p></div></div><p>If receiving <code>Saving key &quot;/var/ossec/.ssh/id_rsa&quot; failed: Permission denied</code> make sure that OSSEC is the directory owner of <code>.ssh/</code>.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-B7UYB" id="tab-KY7De6j" checked="checked"><label for="tab-KY7De6j">shell-session</label><input type="radio" name="group-B7UYB" id="tab-IZ6UYDz"><label for="tab-IZ6UYDz">shell-session</label></div><div class="blocks"><p>::: code-group-item Ubuntu</p><div class="language-shell-session vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@ubuntu:~$ sudo chown -R ossec:ossec .ssh/ &amp;&amp; sudo -u ossec ssh-keygen</span></span></code></pre></div><p>::: ::: code-group-item Rocky</p><div class="language-shell-session vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@rocky:~$ sudo chown -R ossec:ossec .ssh/ &amp;&amp; sudo -u ossec ssh-keygen</span></span></code></pre></div><p>:::</p></div></div><h3 id="vmware-esxi" tabindex="-1">VMware ESXi <a class="header-anchor" href="#vmware-esxi" aria-label="Permalink to &quot;VMware ESXi&quot;">​</a></h3><p>Login as the administrator through the vSphere client. Go to the <em>Host</em>, <em>Manage</em> and advanced settings under the <em>System</em> tab.</p><img class="zoom-custom-imgs" src="/img/ossec/remote_syslog_settings.png" alt="VMware syslog settings"><p>Filter by <em>syslog</em> and find the <code>Syslog.global.logHOST</code> parameter. Right click and select <em>Edit option</em> and set your remote OSSEC host.</p><img class="zoom-custom-imgs" src="/img/ossec/remote_syslog_value.png" alt="VMware syslog options"><p>Additionally you need to edit the <code>/etc/profile.local</code> file for the VMware ESXi SSH prompt as the agentless service expects the prompt to end with either <code>#</code> or <code>$</code>. As administrator, SSH to the VMware ESXi shell and using the vi editor append the following line.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># profile.local</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># This file is not used when UEFI secure boot is enabled</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PS1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;\e[0;41m[\u@\h \W]</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \e[m&quot;</span></span></code></pre></div><h3 id="enabling-agentless-monitoring" tabindex="-1">Enabling agentless monitoring <a class="header-anchor" href="#enabling-agentless-monitoring" aria-label="Permalink to &quot;Enabling agentless monitoring&quot;">​</a></h3><p>To enable agentless monitoring go back to your OSSEC server and execute the following command.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-wYOD2" id="tab-kHpbWk8" checked="checked"><label for="tab-kHpbWk8">shell-session</label><input type="radio" name="group-wYOD2" id="tab-w_C408c"><label for="tab-w_C408c">shell-session</label></div><div class="blocks"><p>::: code-group-item Ubuntu</p><div class="language-shell-session vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@ubuntu:~$ /var/ossec/bin/ossec-control enable agentless</span></span></code></pre></div><p>::: ::: code-group-item Rocky</p><div class="language-shell-session vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@rocky:~$ /var/ossec/bin/ossec-control enable agentless</span></span></code></pre></div><p>:::</p></div></div><p>Proceed to add VMware ESXi server as agentless using the <em>NOPASS</em> option as it will be using SSH keys to communicate.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-utdYP" id="tab-po74rM_" checked="checked"><label for="tab-po74rM_">shell-session</label><input type="radio" name="group-utdYP" id="tab-p7O6MoT"><label for="tab-p7O6MoT">shell-session</label></div><div class="blocks"><p>::: code-group-item Ubuntu</p><div class="language-shell-session vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@ubuntu:~$ /var/ossec/agentless/register_host.sh add root@192.168.0.2 NOPASS</span></span></code></pre></div><p>::: ::: code-group-item Rocky</p><div class="language-shell-session vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@rocky:~$ /var/ossec/agentless/register_host.sh add root@192.168.0.2 NOPASS</span></span></code></pre></div><p>:::</p></div></div><p>To test if the authentication works you can run the command below.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-Zp1aY" id="tab-jpU2ONu" checked="checked"><label for="tab-jpU2ONu">shell-session</label><input type="radio" name="group-Zp1aY" id="tab-nOPii2h"><label for="tab-nOPii2h">shell-session</label></div><div class="blocks"><p>::: code-group-item Ubuntu</p><div class="language-shell-session vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@ubuntu:~$ sudo -u ossec ssh root@192.168.0.2</span></span></code></pre></div><p>::: ::: code-group-item Rocky</p><div class="language-shell-session vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@rocky:~$ sudo -u ossec ssh root@192.168.0.2</span></span></code></pre></div><p>:::</p></div></div><h3 id="configure-agentless-monitoring" tabindex="-1">Configure agentless monitoring <a class="header-anchor" href="#configure-agentless-monitoring" aria-label="Permalink to &quot;Configure agentless monitoring&quot;">​</a></h3><p>For more information regarding setting up and configuring agentless monitoring, check the OSSEC documentation <a href="https://www.ossec.net/docs/manual/agent/agentless-monitoring.html" target="_blank" rel="noreferrer">here</a>.</p><p>Open the OSSEC configuration file and add the VMware ESXi IP address to the remote syslog section.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-LIq3p" id="tab-xIIA2Bw" checked="checked"><label for="tab-xIIA2Bw">shell-session</label><input type="radio" name="group-LIq3p" id="tab-Tzf0AYN"><label for="tab-Tzf0AYN">shell-session</label></div><div class="blocks"><p>::: code-group-item Ubuntu</p><div class="language-shell-session vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@ubuntu:~$ sudo nano /var/ossec/etc/ossec.conf</span></span></code></pre></div><p>::: ::: code-group-item Rocky</p><div class="language-shell-session vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@rocky:~$ sudo nano /var/ossec/etc/ossec.conf</span></span></code></pre></div><p>:::</p></div></div><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">remote</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">connection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;syslog&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">connection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">allowed-ips</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;192.168.0.2&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">allowed-ips</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- VMware ESXi --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">remote</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>Additionally add the agentless types to the configuration.</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">agentless</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;ssh_integrity_check_bsd&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">frequency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;36000&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">frequency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;root@192.168.0.2&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- VMware ESXi --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;periodic&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">arguments</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;/bin /etc/ /sbin&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">arguments</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">agentless</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">agentless</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;ssh_generic_diff&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">frequency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;36000&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">frequency</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;root@192.168.0.2&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- VMware ESXi --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;periodic_diff&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">arguments</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;ls -la /etc; cat /etc/passwd&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">arguments</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">agentless</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>Finally restart OSSEC.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-mg0A9" id="tab-N-5UVLa" checked="checked"><label for="tab-N-5UVLa">shell-session</label><input type="radio" name="group-mg0A9" id="tab-miE5YIT"><label for="tab-miE5YIT">shell-session</label></div><div class="blocks"><p>::: code-group-item Ubuntu</p><div class="language-shell-session vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@ubuntu:~$ sudo /var/ossec/bin/ossec-control restart</span></span></code></pre></div><p>::: ::: code-group-item Rocky</p><div class="language-shell-session vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@rocky:~$ sudo /var/ossec/bin/ossec-control restart</span></span></code></pre></div><p>:::</p></div></div><h2 id="firewall-settings" tabindex="-1">Firewall settings <a class="header-anchor" href="#firewall-settings" aria-label="Permalink to &quot;Firewall settings&quot;">​</a></h2><p>The firewall being used is UFW (Uncomplicated Firewall). It is set by default to deny incoming traffic, allow outgoing traffic and allow port 22.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-TwIwX" id="tab-GZUS1ef" checked="checked"><label for="tab-GZUS1ef">Ubuntu</label><input type="radio" name="group-TwIwX" id="tab-2K2qBtS"><label for="tab-2K2qBtS">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo ufw allow proto udp from 192.168.0.2 to any port 1514 comment &quot;OSSEC client&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo ufw allow proto udp from 192.168.0.2 to any port 514 comment &quot;OSSEC client syslog&quot;</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"></span></code></pre></div></div></div><h2 id="slack-integration" tabindex="-1">Slack integration <a class="header-anchor" href="#slack-integration" aria-label="Permalink to &quot;Slack integration&quot;">​</a></h2><p>Add the ossec-slack command within the command section of the OSSEC configuration file.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-uoOoA" id="tab-Z-nX-VT" checked="checked"><label for="tab-Z-nX-VT">Ubuntu</label><input type="radio" name="group-uoOoA" id="tab-iQQw_NV"><label for="tab-iQQw_NV">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo nano /var/ossec/etc/ossec.conf</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo nano /var/ossec/etc/ossec.conf</span></span></code></pre></div></div></div><p>To send all alerts to Slack with the pre-defined alert level, leave the expect segment blank.</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;ossec-slack&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">executable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;ossec-slack.sh&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">executable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">expect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">expect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- no expect args required --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">timeout_allowed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;no&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">timeout_allowed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>In the active response section set the alert to preferred level.</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">active-response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;ossec-slack&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;server&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;6&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">active-response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>Next edit the <code>ossec-slack.sh</code> file to match your Slack App settings.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group--kzs-" id="tab-K1xsoBK" checked="checked"><label for="tab-K1xsoBK">Ubuntu</label><input type="radio" name="group--kzs-" id="tab-41RDpow"><label for="tab-41RDpow">Rocky Linux</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo nano /var/ossec/active-response/bin/ossec-slack.sh</span></span></code></pre></div><div class="language-shellsession vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo nano /var/ossec/active-response/bin/ossec-slack.sh</span></span></code></pre></div></div></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Make sure that the log path is correct <code>/../</code> in the ossec-slack.sh file.</p></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SLACKUSER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;OSSEC&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CHANNEL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;#ossec-hids&quot;</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SITE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://hooks.slack.com/services/XXXXXXXXX/XXXXXXXX/XXXXXXXXXXX&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SOURCE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ossec2slack&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Logging</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $LOCAL</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ../</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PWD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pwd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`</span></span>
<span class="line highlighted"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">date</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">` </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> $1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> $2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> $3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> $4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> $5</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> $6</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> $7</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> $8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ${PWD}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/../logs/active-responses.log</span></span></code></pre></div><p>Save the file and reload OSSEC and you should now start receive alerts to the defined Slack channel.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group--9Rx0" id="tab-dTVL8EE" checked="checked"><label for="tab-dTVL8EE">shell-session</label><input type="radio" name="group--9Rx0" id="tab-Fv6PFVq"><label for="tab-Fv6PFVq">shell-session</label></div><div class="blocks"><p>::: code-group-item Ubuntu</p><div class="language-shell-session vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@ubuntu:~$ sudo /var/ossec/bin/ossec-control reload</span></span></code></pre></div><p>::: ::: code-group-item Rocky</p><div class="language-shell-session vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@rocky:~$ sudo /var/ossec/bin/ossec-control reload</span></span></code></pre></div><p>:::</p></div></div><h2 id="cloudflare-integration" tabindex="-1">Cloudflare integration <a class="header-anchor" href="#cloudflare-integration" aria-label="Permalink to &quot;Cloudflare integration&quot;">​</a></h2><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>The Cloudflare integration requires you to have the jq (JSON processing) tool installed. This tool is used when removing blocked IP&#39;s following the repeated offenders timeout interval.</p></div><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-BXzZ9" id="tab-DfEZpcz" checked="checked"><label for="tab-DfEZpcz">shell-session</label><input type="radio" name="group-BXzZ9" id="tab-DJyQjks"><label for="tab-DJyQjks">shell-session</label></div><div class="blocks"><p>::: code-group-item Ubuntu</p><div class="language-shell-session vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@ubuntu:~$ sudo apt-get install jq</span></span></code></pre></div><p>::: ::: code-group-item Rocky</p><div class="language-shell-session vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@rocky:~$ sudo yum install jq</span></span></code></pre></div><p>:::</p></div></div><p>First add the cloudflare-ban command to the OSSEC configuration file.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-wjX-v" id="tab-SCk4fXy" checked="checked"><label for="tab-SCk4fXy">shell-session</label><input type="radio" name="group-wjX-v" id="tab-J5RH2nn"><label for="tab-J5RH2nn">shell-session</label></div><div class="blocks"><p>::: code-group-item Ubuntu</p><div class="language-shell-session vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@ubuntu:~$ sudo nano /var/ossec/etc/ossec.conf</span></span></code></pre></div><p>::: ::: code-group-item Rocky</p><div class="language-shell-session vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@rocky:~$ sudo nano /var/ossec/etc/ossec.conf</span></span></code></pre></div><p>:::</p></div></div><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;cloudflare-ban&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">executable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;cloudflare-ban.sh&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">executable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">timeout_allowed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;yes&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">timeout_allowed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">expect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;srcip&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">expect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>In the active response section, set to block all level 6 alerts or greater.</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">active-response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;cloudflare-ban&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;server&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;6&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">timeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;43200&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">timeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">active-response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>Next proceed to update the <code>cloudflare-ban.sh</code> script and put your Cloudflare username along with your Global API key.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-vfWty" id="tab-iC3hpg9" checked="checked"><label for="tab-iC3hpg9">shell-session</label><input type="radio" name="group-vfWty" id="tab-a3Q6ryp"><label for="tab-a3Q6ryp">shell-session</label></div><div class="blocks"><p>::: code-group-item Ubuntu</p><div class="language-shell-session vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@ubuntu:~$ sudo nano /var/ossec/active-response/bin/cloudflare-ban.sh</span></span></code></pre></div><p>::: ::: code-group-item Rocky</p><div class="language-shell-session vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@rocky:~$ sudo nano /var/ossec/active-response/bin/cloudflare-ban.sh</span></span></code></pre></div><p>:::</p></div></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ACTION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">$1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">USER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">$2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">IP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">$3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PWD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pwd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">TOKEN</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9ey&#39;</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">USER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;cloudflareuser@email.com&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MODE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;block&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # block or challenge</span></span></code></pre></div><p>Save the changes and reload OSSEC.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-OPf2n" id="tab-j5sac7k" checked="checked"><label for="tab-j5sac7k">shell-session</label><input type="radio" name="group-OPf2n" id="tab-GzrWjty"><label for="tab-GzrWjty">shell-session</label></div><div class="blocks"><p>::: code-group-item Ubuntu</p><div class="language-shell-session vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@ubuntu:~$ sudo /var/ossec/bin/ossec-control reload</span></span></code></pre></div><p>::: ::: code-group-item Rocky</p><div class="language-shell-session vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell-session</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server@rocky:~$ sudo /var/ossec/bin/ossec-control reload</span></span></code></pre></div><p>:::</p></div></div><p>To monitor the blocked IP address within the Cloudflare account, go to Firewall, Tools and IP Access Rules.</p><h2 id="upgrade-ossec" tabindex="-1">Upgrade OSSEC <a class="header-anchor" href="#upgrade-ossec" aria-label="Permalink to &quot;Upgrade OSSEC&quot;">​</a></h2><p>To upgrade OSSEC, download the <a href="https://github.com/ossec/ossec-hids/releases" target="_blank" rel="noreferrer">latest release</a>, extract the file and run the install script. The installer will tell if OSSEC is already installed and if you wish to update it.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-LY_Y3" id="tab-eNH7QRI" checked="checked"><label for="tab-eNH7QRI">Ubuntu</label></div><div class="blocks"><div class="language-shellsession vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shellsession</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wget https://github.com/ossec/ossec-hids/archive/3.6.0.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tar -zxvf 3.6.0.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd ossec-hids-3.6.0/</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">wget https://ftp.pcre.org/pub/pcre/pcre2-10.32.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">tar -zxvf pcre2-10.32.tar.gz -C src/external/</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo apt-get install build-essential libssl-dev libpcre2-dev zlib1g-dev</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sudo PCRE2_SYSTEM=yes ./install</span></span></code></pre></div></div></div><h2 id="custom-rules" tabindex="-1">Custom rules <a class="header-anchor" href="#custom-rules" aria-label="Permalink to &quot;Custom rules&quot;">​</a></h2><p>Read more about how to create custom rules and decoders <a href="https://www.ossec.net/docs/manual/rules-decoders/create-custom.html" target="_blank" rel="noreferrer">here</a>.</p><ul><li><a href="https://github.com/libellux/Libellux-Up-and-Running/blob/master/docs/ossec/config/local_rules.xml" target="_blank" rel="noreferrer">local_rules.xml</a></li></ul><h3 id="ignore-snap-loop-devices" tabindex="-1">Ignore snap loop devices <a class="header-anchor" href="#ignore-snap-loop-devices" aria-label="Permalink to &quot;Ignore snap loop devices&quot;">​</a></h3><p><code>/var/ossec/rules/local_rules.xml</code></p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">rule</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;100100&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">if_sid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;531&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">if_sid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">regex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&#39;df -P&#39;:\s+/dev/loop\d+\s+\d+\s+\d+\s+0\s+100%\s+/snap/\w+/\d+&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">regex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Ignore full snap loop devices.&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">rule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h3 id="monitor-failed-m-monit-authentication" tabindex="-1">Monitor failed M/Monit authentication <a class="header-anchor" href="#monitor-failed-m-monit-authentication" aria-label="Permalink to &quot;Monitor failed M/Monit authentication&quot;">​</a></h3><p><code>/var/ossec/rules/local_rules.xml</code></p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">rule</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;100101&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;6&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">if_sid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;2501&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">if_sid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">match</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Unauthorized, authentication failed for&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">match</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">group</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;authentication_failed,&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">group</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;User authentication failure.&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">rule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p><code>/var/ossec/etc/oseec.conf</code></p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">localfile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">log_format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;syslog&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">log_format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;/usr/local/mmonit-3.7.2/logs/error.log&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">localfile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h3 id="mute-useless-systemd-resolved-message" tabindex="-1">Mute useless systemd-resolved message <a class="header-anchor" href="#mute-useless-systemd-resolved-message" aria-label="Permalink to &quot;Mute useless systemd-resolved message&quot;">​</a></h3><p><code>/var/ossec/rules/local_rules.xml</code></p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">rule</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;100102&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">program_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;systemd-resolved&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">program_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">match</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Server returned error NXDOMAIN&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">match</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Useless systemd-resolved log message.&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">rule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h3 id="alert-on-fail2ban-action" tabindex="-1">Alert on fail2ban action <a class="header-anchor" href="#alert-on-fail2ban-action" aria-label="Permalink to &quot;Alert on fail2ban action&quot;">​</a></h3><p><code>/var/ossec/rules/local_rules.xml</code></p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">rule</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;100103&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> level</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;6&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">match</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;fail2ban.actions&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">match</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">group</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;authentication_failed,&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">group</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Fail2ban action taken.&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">description</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">rule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p><code>/var/ossec/etc/oseec.conf</code></p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">localfile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">log_format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;syslog&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">log_format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;/var/log/fail2ban.log&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">localfile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h2 id="command-line" tabindex="-1">Command-line <a class="header-anchor" href="#command-line" aria-label="Permalink to &quot;Command-line&quot;">​</a></h2><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td>/var/ossec/bin/agent_control -lc</td><td>List all active agents</td></tr><tr><td>/var/ossec/bin/ossec-logtest</td><td>Logtest</td></tr><tr><td>/var/ossec/bin/ossec-control</td><td>start,stop,reload,restart,status,enable,disable</td></tr><tr><td>/var/ossec/bin/manage_agents</td><td>manage agents (e.g., add, remove)</td></tr></tbody></table><h2 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">​</a></h2><p>If you encounter any issue or having questions regarding OSSEC I recommend using their very helpful <a href="https://groups.google.com/forum/#!forum/ossec-list" target="_blank" rel="noreferrer">mailing list</a>.</p><p>You can also read more about debug mode and how to view more verbose logs <a href="https://www.ossec.net/docs/faq/unexpected.html" target="_blank" rel="noreferrer">here</a>.</p><p><a href="https://github.com/libellux/Libellux-Up-and-Running/issues/new/choose" target="_blank" rel="noreferrer">Questions</a>, <a href="https://github.com/libellux/Libellux-Up-and-Running/issues/new/choose" target="_blank" rel="noreferrer">comments</a>, or <a href="https://github.com/libellux/Libellux-Up-and-Running/issues/new/choose" target="_blank" rel="noreferrer">problems</a> regarding this service? Create an issue <a href="https://github.com/libellux/Libellux-Up-and-Running/issues/new/choose" target="_blank" rel="noreferrer">here</a> or contact <a href="mailto:webmaster@libellux.com" target="_blank" rel="noreferrer">webmaster@libellux.com</a>.</p><p><a target="_blank" class="dark-only" href="https://betteruptime.com/"><img style="width:130px;height:52px;" alt="Better Uptime Website Monitoring" src="https://betteruptime.com/assets/static_assets/badges/dark.png"></a><a target="_blank" class="light-only" href="https://betteruptime.com/"><img style="width:130px;height:52px;" alt="Better Uptime Website Monitoring" src="https://betteruptime.com/assets/static_assets/badges/light.png"></a></p></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-87be45d1><!--[--><!--]--><!----><nav class="prev-next" data-v-87be45d1><div class="pager" data-v-87be45d1><a class="VPLink link pager-link prev" href="/intrusion-detection/greenbone-vulnerability-manager" data-v-87be45d1><!--[--><span class="desc" data-v-87be45d1>Previous page</span><span class="title" data-v-87be45d1>Greenbone Vulnerability Manager</span><!--]--></a></div><div class="pager" data-v-87be45d1><a class="VPLink link pager-link next" href="/intrusion-detection/clamav" data-v-87be45d1><!--[--><span class="desc" data-v-87be45d1>Next page</span><span class="title" data-v-87be45d1>ClamAV Anti-virus Engine</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api-examples.md\":\"BpnnN9gw\",\"management_opensearch.md\":\"CGa2tlMD\",\"management_ansible.md\":\"DxOgeVbr\",\"intrusion-detection_clamav.md\":\"DW6-rlwp\",\"release-notes.md\":\"BmIHgxvG\",\"intrusion-detection_snort.md\":\"v8T6T2f7\",\"index.md\":\"C-VPGV1M\",\"getting-started.md\":\"B0HjW4vU\",\"intrusion-detection_ossec.md\":\"BbgwYq7J\",\"intrusion-detection_greenbone-vulnerability-manager.md\":\"BPFFlxEU\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Libellux\",\"description\":\"Up and Running\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":\"dark\",\"themeConfig\":{\"search\":{\"provider\":\"algolia\",\"options\":{\"appId\":\"AS5YOFW2K6\",\"apiKey\":\"374dffc87cc7634d4814d1c936b599d3\",\"indexName\":\"libellux\"}},\"logo\":\"/img/72x72.png\",\"nav\":[{\"text\":\"Get started\",\"link\":\"/getting-started\"},{\"text\":\"Status\",\"link\":\"https://status.libellux.com\"}],\"sidebar\":[{\"text\":\"Up and Running\",\"items\":[{\"text\":\"Introduction\",\"link\":\"/getting-started\"},{\"text\":\"Release notes\",\"link\":\"/release-notes\"}]},{\"text\":\"Zero Trust Network\",\"items\":[{\"text\":\"WireGuard Secure VPN Tunnel\",\"link\":\"/\"}]},{\"text\":\"Intrusion Detection and Prevention \",\"items\":[{\"text\":\"Greenbone Vulnerability Manager\",\"link\":\"/intrusion-detection/greenbone-vulnerability-manager\"},{\"text\":\"OSSEC Host Intrusion Detection\",\"link\":\"/intrusion-detection/ossec\"},{\"text\":\"ClamAV Anti-virus Engine\",\"link\":\"/intrusion-detection/clamav\"},{\"text\":\"Snort Network Intrusion Detection\",\"link\":\"/intrusion-detection/snort\"},{\"text\":\"PSAD Port Scan Attack Detector\",\"link\":\"/\"}]}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/libellux/Libellux-Up-and-Running\"}],\"markdown\":{\"image\":{\"lazyLoading\":true}}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>