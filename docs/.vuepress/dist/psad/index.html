<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.7" />
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html,
      body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches
      if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
        document.documentElement.classList.toggle('dark', true)
      }
    </script>
    <link rel="canonical" href="https://wwww.libellux.com/psad/"><script src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" google_ad_client="ca-pub-3592345228354158" crossorigin="anonymous"></script><meta name="robots" content="index, follow"><link rel="manifest" href="/manifest.webmanifest"><meta name="theme-color" content="#8c7bce"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@libellux1"><meta name="twitter:title" content="Libellux"><meta name="twitter:description" content="Libellux: Up & Running provides documentation on how-to install open-source software from source. The focus is Zero Trust Network to enhance the security for existing applications or install tools to detect and prevent threats."><meta name="twitter:image" content="https://www.libellux.com/img/icons/4096x4096.png"><meta name="twitter:width" content="4096"><meta name="twitter:height" content="4096"><meta property="og:locale" content="en_US"><meta property="og:type" content="website"><meta property="og:title" content="Libellux"><meta property="og:description" content="Libellux: Up & Running provides documentation on how-to install open-source software from source. The focus is Zero Trust Network to enhance the security for existing applications or install tools to detect and prevent threats."><meta property="og:url" content="https://www.libellux.com"><meta property="og:site_name" content="Libellux"><meta property="og:publisher" content="https://www.facebook.com/libellux1"><meta property="og:author" content="https://www.facebook.com/fredrik.hilmersson.1"><meta property="og:image" content="https://www.libellux.com/img/icons/1200x627.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link rel="icon" href="https://www.libellux.com/img/icons/72x72.png"><meta name="msapplication-TileImage" content="https://www.libellux.com/img/icons/144x144.png"><link rel="apple-touch-icon" sizes="48x48" href="https://www.libellux.com/img/icons/48x48.png"><link rel="apple-touch-icon" sizes="72x72" href="https://www.libellux.com/img/icons/72x72.png"><link rel="apple-touch-icon" sizes="144x144" href="https://www.libellux.com/img/icons/144x144.png"><link rel="apple-touch-icon" sizes="192x192" href="https://www.libellux.com/img/icons/192x192.png"><link rel="apple-touch-icon" sizes="256x256" href="https://www.libellux.com/img/icons/256x256.png"><link rel="apple-touch-icon" sizes="384x384" href="https://www.libellux.com/img/icons/384x384.png"><link rel="apple-touch-icon" sizes="512x512" href="https://www.libellux.com/img/icons/512x512.png"><link rel="apple-touch-icon" sizes="1200x627" href="https://www.libellux.com/img/icons/1200x627.png"><title>PSAD Port Scan Attack Detector | Libellux</title><meta name="description" content="PSAD (Port Scan Attack Detector) is a collection of three lightweight system daemons (two main daemons and one helper daemon) that run on Linux machines and analyze iptables log messages to detect port scans and other suspicious traffic. A typical deployment is to run PSAD on the iptables firewall where it has the fastest access to log data.">
    <link rel="preload" href="/assets/style-Cqf32Qdr.css" as="style"><link rel="stylesheet" href="/assets/style-Cqf32Qdr.css">
    <link rel="modulepreload" href="/assets/app-C1GsNvSD.js"><link rel="modulepreload" href="/assets/index.html-BKfEATpw.js">
    <link rel="prefetch" href="/assets/index.html-fUjwavej.js" as="script"><link rel="prefetch" href="/assets/privacy-policy.html-Dn5LD3ws.js" as="script"><link rel="prefetch" href="/assets/index.html-CXsq6PeB.js" as="script"><link rel="prefetch" href="/assets/index.html-Z2sX9zgQ.js" as="script"><link rel="prefetch" href="/assets/index.html-CwRLG717.js" as="script"><link rel="prefetch" href="/assets/index.html-B4r8mHrM.js" as="script"><link rel="prefetch" href="/assets/index.html-BPY-suu-.js" as="script"><link rel="prefetch" href="/assets/index.html-CHcQAHE-.js" as="script"><link rel="prefetch" href="/assets/index.html-gVCTAgZ2.js" as="script"><link rel="prefetch" href="/assets/index.html-CmF7qBTA.js" as="script"><link rel="prefetch" href="/assets/index.html-CxlK4ehk.js" as="script"><link rel="prefetch" href="/assets/404.html-Dunwicxw.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><img class="logo" src="/img/icons/72x72.png" alt="Libellux"><span class="site-name can-hide" aria-hidden="true">Libellux</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide" aria-label="site navigation"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Libellux: Up &amp; Running"><span class="title">Libellux: Up &amp; Running</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Libellux: Up &amp; Running"><span class="title">Libellux: Up &amp; Running</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Libellux: Up &amp; Running</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Zero Trust Network</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/wireguard/" aria-label="WireGuard Secure VPN Tunnel"><!--[--><!--]--> WireGuard Secure VPN Tunnel <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/privacyidea/" aria-label="Two-factor authentication w/ privacyIDEA and YubiKey"><!--[--><!--]--> Two-factor authentication w/ privacyIDEA and YubiKey <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Intrusion Detection and Prevention</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/ossec/" aria-label="OSSEC Host Intrusion Detection"><!--[--><!--]--> OSSEC Host Intrusion Detection <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/openvas/" aria-label="Greenbone Vulnerability Manager"><!--[--><!--]--> Greenbone Vulnerability Manager <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/clamav/" aria-label="ClamAV Antivirus Server"><!--[--><!--]--> ClamAV Antivirus Server <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link route-link-active" href="/psad/" aria-label="PSAD Intrusion Detection"><!--[--><!--]--> PSAD Intrusion Detection <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Monitoring and Management</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/ansible/" aria-label="Ansible"><!--[--><!--]--> Ansible <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/mmonit/" aria-label="M/Monit System Monitoring"><!--[--><!--]--> M/Monit System Monitoring <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/rsyslog/" aria-label=" Rsyslog Syslog Processing"><!--[--><!--]-->  Rsyslog Syslog Processing <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://status.libellux.com/" rel="noopener noreferrer" target="_blank" aria-label="Status"><!--[--><!--]--> Status <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/libellux/Libellux-Up-and-Running" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items" aria-label="site navigation"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Libellux: Up &amp; Running"><span class="title">Libellux: Up &amp; Running</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Libellux: Up &amp; Running"><span class="title">Libellux: Up &amp; Running</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Libellux: Up &amp; Running</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Zero Trust Network</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/wireguard/" aria-label="WireGuard Secure VPN Tunnel"><!--[--><!--]--> WireGuard Secure VPN Tunnel <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/privacyidea/" aria-label="Two-factor authentication w/ privacyIDEA and YubiKey"><!--[--><!--]--> Two-factor authentication w/ privacyIDEA and YubiKey <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Intrusion Detection and Prevention</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/ossec/" aria-label="OSSEC Host Intrusion Detection"><!--[--><!--]--> OSSEC Host Intrusion Detection <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/openvas/" aria-label="Greenbone Vulnerability Manager"><!--[--><!--]--> Greenbone Vulnerability Manager <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/clamav/" aria-label="ClamAV Antivirus Server"><!--[--><!--]--> ClamAV Antivirus Server <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link route-link-active" href="/psad/" aria-label="PSAD Intrusion Detection"><!--[--><!--]--> PSAD Intrusion Detection <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Monitoring and Management</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/ansible/" aria-label="Ansible"><!--[--><!--]--> Ansible <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/mmonit/" aria-label="M/Monit System Monitoring"><!--[--><!--]--> M/Monit System Monitoring <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/rsyslog/" aria-label=" Rsyslog Syslog Processing"><!--[--><!--]-->  Rsyslog Syslog Processing <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://status.libellux.com/" rel="noopener noreferrer" target="_blank" aria-label="Status"><!--[--><!--]--> Status <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/libellux/Libellux-Up-and-Running" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">Libellux: Up &amp; Running <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">Zero Trust Network <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/wireguard/" aria-label="WireGuard Secure VPN Tunnel"><!--[--><!--]--> WireGuard Secure VPN Tunnel <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/privacyidea/" aria-label="Two-factor authentication w/ privacyIDEA and YubiKey"><!--[--><!--]--> Two-factor authentication w/ privacyIDEA and YubiKey <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading active">Intrusion Detection and Prevention <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/ossec/" aria-label="OSSEC Host Intrusion Detection"><!--[--><!--]--> OSSEC Host Intrusion Detection <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/openvas/" aria-label="Greenbone Vulnerability Manager"><!--[--><!--]--> Greenbone Vulnerability Manager <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/clamav/" aria-label="ClamAV Antivirus Server"><!--[--><!--]--> ClamAV Antivirus Server <!--[--><!--]--></a><!----></li><li><a class="route-link route-link-active sidebar-item active" href="/psad/" aria-label="PSAD Intrusion Detection"><!--[--><!--]--> PSAD Intrusion Detection <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/#configuration-files" aria-label="Configuration files"><!--[--><!--]--> Configuration files <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#prerequisites" aria-label="Prerequisites"><!--[--><!--]--> Prerequisites <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#install-psad-from-source" aria-label="Install PSAD from source"><!--[--><!--]--> Install PSAD from source <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#configuration" aria-label="Configuration"><!--[--><!--]--> Configuration <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/#enable-psad-rules-in-ossec" aria-label="Enable PSAD rules in OSSEC"><!--[--><!--]--> Enable PSAD rules in OSSEC <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/#firewall-settings" aria-label="Firewall settings"><!--[--><!--]--> Firewall settings <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#command-line" aria-label="Command-line"><!--[--><!--]--> Command-line <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">Monitoring and Management <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/ansible/" aria-label="Ansible"><!--[--><!--]--> Ansible <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/mmonit/" aria-label="M/Monit System Monitoring"><!--[--><!--]--> M/Monit System Monitoring <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/rsyslog/" aria-label="Rsyslog Syslog Processing"><!--[--><!--]--> Rsyslog Syslog Processing <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="psad-intrusion-detection-with-log-analysis" tabindex="-1"><a class="header-anchor" href="#psad-intrusion-detection-with-log-analysis"><span>PSAD Intrusion Detection with Log Analysis <span class="badge tip" style=""><!--[-->Rev 2<!--]--></span></span></a></h1><p>PSAD (Port Scan Attack Detector) is a collection of three lightweight system daemons (two main daemons and one helper daemon) that run on Linux machines and analyze iptables log messages to detect port scans and other suspicious traffic. A typical deployment is to run PSAD on the iptables firewall where it has the fastest access to log data.</p><p><a href="https://cipherdyne.org/psad/" target="_blank" rel="noopener noreferrer">PSAD website<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> <a href="https://github.com/mrash/psad" target="_blank" rel="noopener noreferrer">GitHub<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>Setup and configuration have been tested on the following operating systems:</p><ul><li>Ubuntu- 16.04, 18.04, 20.04 (Focal Fossa), Rocky 8.4 (Green Obsidian)</li><li>PSAD- 2.2.3 -&gt; 2.4.6</li></ul><p><a href="https://fundof.me/libellux"><img src="https://img.shields.io/badge/fundof-libellux-green" alt="fundof"></a></p><h2 id="configuration-files" tabindex="-1"><a class="header-anchor" href="#configuration-files"><span>Configuration files</span></a></h2><ul><li><a href="https://github.com/libellux/Libellux-Up-and-Running/blob/master/docs/psad/config/psad.conf" target="_blank" rel="noopener noreferrer">psad.conf<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h2 id="prerequisites" tabindex="-1"><a class="header-anchor" href="#prerequisites"><span>Prerequisites</span></a></h2><p>Dependancies when installing PSAD from source.</p><ul><li><code>net-tools</code></li><li><code>g++</code></li></ul><h2 id="install-psad-from-source" tabindex="-1"><a class="header-anchor" href="#install-psad-from-source"><span>Install PSAD from source</span></a></h2><p>Make sure you have installed the dependency packages and once complete download the lastest stable version from the <a href="https://github.com/mrash/psad" target="_blank" rel="noopener noreferrer">PSAD GitHub<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, extract and run the installation script.</p><img class="zoom-custom-imgs" src="/img/psad/psad_diagram.jpg" alt="PSAD Port Scan Attack Detector"><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> update <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token parameter variable">-y</span> upgrade <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token parameter variable">-y</span> <span class="token function">install</span> net-tools g++ <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">wget</span> https://github.com/mrash/psad/archive/2.4.6.tar.gz <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> <span class="token number">2.4</span>.6.tar.gz <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> psad-2.4.6/ <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> ./install.pl</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">server@rocky:~$
</span></code></pre></div><!--]--></div><!--]--></div><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">[+] psad alerts will be sent to:

       root@localhost

[+] Would you like alerts sent to a different address ([y]/n)?  n

[+] By default, psad parses all iptables log messages for scan activity.
    However, psad can be configured to only parse those iptables messages
    that match particular strings (that are specified in your iptables
    ruleset with the --log-prefix option).

    Would you like psad to only parse specific strings in iptables
    messages (y/[n])?  n

[+] By default, psad matches Snort rules against any IP addresses, but
    psad offers the ability to restrict signature matches to specific
    networks with the HOME_NET variable (similar to Snort).  However, psad
    also offers the ability to acquire all local subnets on the local system
    by parsing the output of &quot;ifconfig&quot;, or the subnets can be restricted
    to a limited set of networks.

    First, is it ok to leave the HOME_NET setting as &quot;any&quot; ([y]/n)?  y

[+] psad has the capability of sending scan data via email alerts to the
    DShield distributed intrusion detection system (www.dshield.org).  By
    default this feature is not enabled since firewall log data is sensitive,
    but submitting logs to DShield provides a valuable service and assists
    in generally enhancing internet security.  As an optional step, if you
    have a DShield user id you can edit the &quot;DSHIELD_USER_ID&quot; variable
    in /etc/psad/psad.conf

    Would you like to enable DShield alerts (y/[n])?  n

[+] Setting hostname to &quot;client@ubuntu&quot; in /etc/psad/psad.conf
[+] The latest psad signatures can be installed with &quot;psad --sig-update&quot;
    or installed now with install.pl.

    If you decide to answer &#39;y&#39; to the next question, install.pl
    will require DNS and network access now.

    Would you like to install the latest signatures from
      http://www.cipherdyne.org/psad/signatures (y/n)?  y

[+] Enable psad at boot time ([y]/n)?  y

[+] psad has been installed.
</span></code></pre><div class="highlight-lines"><br><br><br><br><div class="highlight-line"> </div><br><br><br><br><br><br><br><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><br><div class="highlight-line"> </div><br><br></div></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">server@rocky:~$
</span></code></pre></div><!--]--></div><!--]--></div><h2 id="configuration" tabindex="-1"><a class="header-anchor" href="#configuration"><span>Configuration</span></a></h2><p>The email address will be left as default (root@localhost;) as in this tutorial we&#39;ll use OSSEC to manage the alerts.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>$ <span class="token function">sudo</span> <span class="token function">nano</span> /etc/psad/psad.conf

<span class="token comment">### Machine hostname</span>
<span class="token environment constant">HOSTNAME</span> server@ubuntu<span class="token punctuation">;</span>

<span class="token comment">### Specify the home and external networks.  Note that by default the</span>
<span class="token comment">### ENABLE_INTF_LOCAL_NETS is enabled, so psad automatically detects</span>
<span class="token comment">### all of the directly connected subnets and uses this information as</span>
<span class="token comment">### the HOME_NET variable.</span>
HOME_NET                    <span class="token number">192.168</span>.0.0/24<span class="token punctuation">;</span>
EXTERNAL_NET                any<span class="token punctuation">;</span>

IPT_SYSLOG_FILE             /var/log/syslog<span class="token punctuation">;</span>
EXPECT_TCP_OPTIONS		    Y<span class="token punctuation">;</span>
EMAIL_ALERT_DANGER_LEVEL	<span class="token number">3</span><span class="token punctuation">;</span>

<span class="token comment">### Allow reporting methods to be enabled/restricted.  This keyword can</span>
<span class="token comment">### accept values of &quot;nosyslog&quot; (don&#39;t write any messages to syslog),</span>
<span class="token comment">### &quot;noemail&quot; (don&#39;t send any email messages), or &quot;ALL&quot; (to generate both</span>
<span class="token comment">### syslog and email messages).  &quot;ALL&quot; is the default.  Both &quot;nosyslog&quot;</span>
<span class="token comment">### and &quot;noemail&quot; can be combined with a comma to disable all logging</span>
<span class="token comment">### and alerting.</span>
ALERTING_METHODS            noemail<span class="token punctuation">;</span>
</code></pre><div class="highlight-lines"><br><br><br><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>server@rocky:~$
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>To check the status of PSAD execute the following command.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> psad <span class="token parameter variable">-S</span></span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">server@rocky:~$
</span></code></pre></div><!--]--></div><!--]--></div><h3 id="enable-psad-rules-in-ossec" tabindex="-1"><a class="header-anchor" href="#enable-psad-rules-in-ossec"><span>Enable PSAD rules in OSSEC</span></a></h3><p>To enable OSSEC to decode and respond to PSAD rules being triggered follow the instructions found <a href="">here</a>.</p><h2 id="firewall-settings" tabindex="-1"><a class="header-anchor" href="#firewall-settings"><span>Firewall settings</span></a></h2><p>The firewall being used is UFW (Uncomplicated Firewall). It is set by default to deny incoming traffic, allow outgoing traffic and allow port 22 (OpenSSH). Read more about UFW <a href="https://help.ubuntu.com/community/UFW" target="_blank" rel="noopener noreferrer">here<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><details class="custom-container details"><summary>UFW Settings</summary><div class="language-console line-numbers-mode" data-ext="console" data-title="console"><pre class="language-console"><code>server@ubuntu:~$ sudo ufw default deny incoming
server@ubuntu:~$ sudo ufw default allow outgoing
server@ubuntu:~$ sudo ufw allow 22
server@ubuntu:~$ sudo ufw enable
Command may disrupt existing ssh connections. Proceed with operation (y|n)? y
Firewall is active and enabled on system startup
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><p>First enable logging using the built-in UFW command below.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> ufw logging on</span></span>
<span class="token output">Logging enabled
</span></code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">server@rocky:~$
</span></code></pre></div><!--]--></div><!--]--></div><p>Once logging been enabled you&#39;ll also need to alter the UFW rules. Edit both configuration files (before.rules and before6.rules) and add the following before the COMMIT line.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /etc/ufw/before.rules</span></span>
<span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /etc/ufw/before6.rules</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">server@rocky:~$
</span></code></pre></div><!--]--></div><!--]--></div><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># custom psad logging directives</span>
<span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-j</span> LOG
<span class="token parameter variable">-A</span> FORWARD <span class="token parameter variable">-j</span> LOG

<span class="token comment"># do not delete the &quot;COMMIT&quot; line or these rules wont be processed</span>
COMMIT
</code></pre><div class="highlight-lines"><br><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>server@rocky:~$
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>Next reload UFW and proceed to check psad with the built-in firewall analyze tool.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> ufw reload</span></span>
<span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> psad --fw-analyze</span></span>
<span class="token output">[+] Parsing INPUT chain rules.
[+] Parsing INPUT chain rules.
[+] Firewall config looks good.
[+] Completed check of firewall ruleset.
[+] Results in /var/log/psad/fw_check
[+] Exiting.
</span></code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">server@rocky:~$
</span></code></pre></div><!--]--></div><!--]--></div><h2 id="command-line" tabindex="-1"><a class="header-anchor" href="#command-line"><span>Command-line</span></a></h2><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td>psad -R</td><td>Restart psad</td></tr><tr><td>psad -S</td><td>psad status</td></tr><tr><td>psad --fw-analyze</td><td>Analyze the local iptables ruleset</td></tr><tr><td>psad --sig-update</td><td>Download the latest set of psad signatures</td></tr><tr><td>psad -H</td><td>Send all psad daemons a HUP signal to have them re-import configs</td></tr></tbody></table></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/libellux/Libellux-Up-and-Running/edit/master/docs/psad/README.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: fredrik@libellux.com">Libellux</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: fredrik@libellux.com">Fredrik Hilmersson</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav" aria-label="page navigation"><p class="inner"><span class="prev"><a class="route-link" href="/clamav/" aria-label="ClamAV Antivirus Server"><!--[--><!--]--> ClamAV Antivirus Server <!--[--><!--]--></a></span><!----></p></nav><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-C1GsNvSD.js" defer></script>
  </body>
</html>
