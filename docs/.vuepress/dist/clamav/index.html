<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.26">
    <meta name="robots" content="index, follow"><link rel="manifest" href="/manifest.webmanifest"><meta name="theme-color" content="#8c7bce"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@libellux1"><meta name="twitter:title" content="Libellux"><meta name="twitter:description" content="Libellux: Up & Running provides documentation on how-to install open-source software from source. The focus is Zero Trust Network to enhance the security for existing applications or install tools to detect and prevent threats."><meta name="twitter:image" content="https://www.libellux.com/img/icons/4096x4096.png"><meta name="twitter:width" content="4096"><meta name="twitter:height" content="4096"><meta property="og:locale" content="en_US"><meta property="og:type" content="website"><meta property="og:title" content="Libellux"><meta property="og:description" content="Libellux: Up & Running provides documentation on how-to install open-source software from source. The focus is Zero Trust Network to enhance the security for existing applications or install tools to detect and prevent threats."><meta property="og:url" content="https://www.libellux.com"><meta property="og:site_name" content="Libellux"><meta property="og:publisher" content="https://www.facebook.com/libellux1"><meta property="og:author" content="https://www.facebook.com/fredrik.hilmersson.1"><meta property="og:image" content="https://www.libellux.com/img/icons/1200x627.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link rel="icon" href="https://www.libellux.com/img/icons/72x72.png"><meta name="msapplication-TileImage" content="https://www.libellux.com/img/icons/144x144.png"><link rel="apple-touch-icon" sizes="48x48" href="https://www.libellux.com/img/icons/48x48.png"><link rel="apple-touch-icon" sizes="72x72" href="https://www.libellux.com/img/icons/72x72.png"><link rel="apple-touch-icon" sizes="144x144" href="https://www.libellux.com/img/icons/144x144.png"><link rel="apple-touch-icon" sizes="192x192" href="https://www.libellux.com/img/icons/192x192.png"><link rel="apple-touch-icon" sizes="256x256" href="https://www.libellux.com/img/icons/256x256.png"><link rel="apple-touch-icon" sizes="384x384" href="https://www.libellux.com/img/icons/384x384.png"><link rel="apple-touch-icon" sizes="512x512" href="https://www.libellux.com/img/icons/512x512.png"><link rel="apple-touch-icon" sizes="1200x627" href="https://www.libellux.com/img/icons/1200x627.png"><title>ClamAV Antivirus Server | Libellux</title><meta name="description" content="ClamAV is an open source antivirus engine for detecting trojans, viruses, malware & other malicious threats.">
    <link rel="preload" href="/assets/js/runtime~app.7dbcf5d9.js" as="script"><link rel="preload" href="/assets/css/styles.eeda98bb.css" as="style"><link rel="preload" href="/assets/js/5.dc697aaf.js" as="script"><link rel="preload" href="/assets/js/app.6bd9c778.js" as="script">
    <link rel="stylesheet" href="/assets/css/styles.eeda98bb.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/img/icons/72x72.png" alt="Libellux"><span class="site-name can-hide">Libellux</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Libellux: Up &amp; Running"><span class="title">Libellux: Up &amp; Running</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Libellux: Up &amp; Running"><span class="title">Libellux: Up &amp; Running</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Libellux: Up &amp; Running</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/" class="nav-link" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Zero Trust Network</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/wireguard/" class="nav-link" aria-label="WireGuard Secure VPN Tunnel"><!--[--><!--]--> WireGuard Secure VPN Tunnel <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/privacyidea/" class="nav-link" aria-label="Two-factor authentication w/ privacyIDEA and YubiKey"><!--[--><!--]--> Two-factor authentication w/ privacyIDEA and YubiKey <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Intrusion Detection and Prevention</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/ossec/" class="nav-link" aria-label="OSSEC Host Intrusion Detection"><!--[--><!--]--> OSSEC Host Intrusion Detection <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/openvas/" class="nav-link" aria-label="Greenbone Vulnerability Manager"><!--[--><!--]--> Greenbone Vulnerability Manager <!--[--><!--]--></a></li><li class="dropdown-subitem"><a aria-current="page" href="/clamav/" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="ClamAV Antivirus Server"><!--[--><!--]--> ClamAV Antivirus Server <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/psad/" class="nav-link" aria-label="PSAD Intrusion Detection"><!--[--><!--]--> PSAD Intrusion Detection <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Monitoring and Management</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/mmonit/" class="nav-link" aria-label="M/Monit System Monitoring"><!--[--><!--]--> M/Monit System Monitoring <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/graylog/" class="nav-link" aria-label="Graylog Centralized Log Management"><!--[--><!--]--> Graylog Centralized Log Management <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/rsyslog/" class="nav-link" aria-label=" Rsyslog Syslog Processing"><!--[--><!--]-->  Rsyslog Syslog Processing <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a class="nav-link external" href="https://libellux.cloudflareaccess.com" rel="noopener noreferrer" target="_blank" aria-label="Portal"><!--[--><!--]--> Portal <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/libellux/Libellux-Up-and-Running" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Libellux: Up &amp; Running"><span class="title">Libellux: Up &amp; Running</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Libellux: Up &amp; Running"><span class="title">Libellux: Up &amp; Running</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Libellux: Up &amp; Running</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/" class="nav-link" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Zero Trust Network</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/wireguard/" class="nav-link" aria-label="WireGuard Secure VPN Tunnel"><!--[--><!--]--> WireGuard Secure VPN Tunnel <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/privacyidea/" class="nav-link" aria-label="Two-factor authentication w/ privacyIDEA and YubiKey"><!--[--><!--]--> Two-factor authentication w/ privacyIDEA and YubiKey <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Intrusion Detection and Prevention</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/ossec/" class="nav-link" aria-label="OSSEC Host Intrusion Detection"><!--[--><!--]--> OSSEC Host Intrusion Detection <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/openvas/" class="nav-link" aria-label="Greenbone Vulnerability Manager"><!--[--><!--]--> Greenbone Vulnerability Manager <!--[--><!--]--></a></li><li class="dropdown-subitem"><a aria-current="page" href="/clamav/" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="ClamAV Antivirus Server"><!--[--><!--]--> ClamAV Antivirus Server <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/psad/" class="nav-link" aria-label="PSAD Intrusion Detection"><!--[--><!--]--> PSAD Intrusion Detection <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Monitoring and Management</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/mmonit/" class="nav-link" aria-label="M/Monit System Monitoring"><!--[--><!--]--> M/Monit System Monitoring <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/graylog/" class="nav-link" aria-label="Graylog Centralized Log Management"><!--[--><!--]--> Graylog Centralized Log Management <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/rsyslog/" class="nav-link" aria-label=" Rsyslog Syslog Processing"><!--[--><!--]-->  Rsyslog Syslog Processing <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a class="nav-link external" href="https://libellux.cloudflareaccess.com" rel="noopener noreferrer" target="_blank" aria-label="Portal"><!--[--><!--]--> Portal <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/libellux/Libellux-Up-and-Running" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item">Libellux: Up &amp; Running</p><ul class=""><li><!--[--><a href="/" class="nav-link sidebar-item" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">Zero Trust Network</p><ul class=""><li><!--[--><a href="/wireguard/" class="nav-link sidebar-item" aria-label="WireGuard Secure VPN Tunnel"><!--[--><!--]--> WireGuard Secure VPN Tunnel <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/privacyidea/" class="nav-link sidebar-item" aria-label="Two-factor authentication w/ privacyIDEA and YubiKey"><!--[--><!--]--> Two-factor authentication w/ privacyIDEA and YubiKey <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item active">Intrusion Detection and Prevention</p><ul class=""><li><!--[--><a href="/ossec/" class="nav-link sidebar-item" aria-label="OSSEC Host Intrusion Detection"><!--[--><!--]--> OSSEC Host Intrusion Detection <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/openvas/" class="nav-link sidebar-item" aria-label="Greenbone Vulnerability Manager"><!--[--><!--]--> Greenbone Vulnerability Manager <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/clamav/" class="router-link-active router-link-exact-active nav-link router-link-active sidebar-item active" aria-label="ClamAV Antivirus Server"><!--[--><!--]--> ClamAV Antivirus Server <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/clamav/#configuration-files" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Configuration files"><!--[--><!--]--> Configuration files <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/clamav/#prerequisites" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Prerequisites"><!--[--><!--]--> Prerequisites <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/clamav/#install-clamav-from-source" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Install ClamAV from source"><!--[--><!--]--> Install ClamAV from source <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/clamav/#install-from-repository" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Install from repository"><!--[--><!--]--> Install from repository <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/clamav/#clamav-server" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="ClamAV server"><!--[--><!--]--> ClamAV server <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/clamav/#keep-virus-definitions-up-to-date" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Keep virus definitions up-to-date"><!--[--><!--]--> Keep virus definitions up-to-date <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/clamav/#ubuntu-client" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Ubuntu client"><!--[--><!--]--> Ubuntu client <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/clamav/#windows-client" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Windows client"><!--[--><!--]--> Windows client <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/clamav/#firewall-settings" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Firewall settings"><!--[--><!--]--> Firewall settings <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/clamav/#troubleshooting" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Troubleshooting"><!--[--><!--]--> Troubleshooting <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/clamav/#enterprise-solutions" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Enterprise solutions"><!--[--><!--]--> Enterprise solutions <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/clamav/#atomic-protector" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Atomic Protector"><!--[--><!--]--> Atomic Protector <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li></ul><!--]--></li><li><!--[--><a href="/psad/" class="nav-link sidebar-item" aria-label="PSAD Intrusion Detection"><!--[--><!--]--> PSAD Intrusion Detection <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">Monitoring and Management</p><ul class=""><li><!--[--><a href="/mmonit/" class="nav-link sidebar-item" aria-label="M/Monit System Monitoring"><!--[--><!--]--> M/Monit System Monitoring <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/graylog/" class="nav-link sidebar-item" aria-label="Graylog Centralized Log Management"><!--[--><!--]--> Graylog Centralized Log Management <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/rsyslog/" class="nav-link sidebar-item" aria-label="Rsyslog Syslog Processing"><!--[--><!--]--> Rsyslog Syslog Processing <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="clamav-antivirus-server" tabindex="-1"><a class="header-anchor" href="#clamav-antivirus-server" aria-hidden="true">#</a> ClamAV Antivirus Server <span class="badge tip" style=""><!--[-->Rev 2<!--]--></span></h1><p>ClamAV is an open source (GPL) anti-virus engine used in a variety of situations including email scanning, web scanning, and end point security. It provides a number of utilities including a flexible and scalable multi-threaded daemon, a command line scanner and an advanced tool for automatic database updates.</p><p><a href="https://www.clamav.net/" target="_blank" rel="noopener noreferrer">ClamAV website<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> <a href="https://www.clamav.net/downloads" target="_blank" rel="noopener noreferrer">Source code<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> <a href="https://docs.clamav.net/" target="_blank" rel="noopener noreferrer">Offical docs<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><p>Setup and configuration have been tested on following OS with version:</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>How-to build ClamAV from source will be added in upcoming release.</p></div><ul><li>Ubuntu- 18.04, 20.04 (Focal Fossa), Windows 10, Windows Server 2019</li><li>ClamAV- 0.102.4, 0.104</li></ul><p><a href="https://ko-fi.com/B0B31BJU3" target="_blank" rel="noopener noreferrer"><img src="https://www.ko-fi.com/img/githubbutton_sm.svg" alt="ko-fi"><span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><h2 id="configuration-files" tabindex="-1"><a class="header-anchor" href="#configuration-files" aria-hidden="true">#</a> Configuration files</h2><ul><li><a href="https://github.com/libellux/Libellux-Up-and-Running/blob/master/docs/clamav/config/ubuntu_0.104.sh" target="_blank" rel="noopener noreferrer">ClamAV 0.104<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></li></ul><h2 id="prerequisites" tabindex="-1"><a class="header-anchor" href="#prerequisites" aria-hidden="true">#</a> Prerequisites</h2><ul><li><code>net-tools</code> (optional)</li></ul><details class="custom-container details"><summary>Dependencies for Ubuntu 20.04</summary><div class="language-text ext-text"><pre class="language-text"><code>gcc make pkg-config python3 python3-pip python3-pytest valgrind
check libbz2-dev libcurl4-openssl-dev libjson-c-dev libmilter-dev
libncurses5-dev libpcre2-dev libssl-dev libxml2-dev zlib1g-dev
</code></pre></div></details><h2 id="install-clamav-from-source" tabindex="-1"><a class="header-anchor" href="#install-clamav-from-source" aria-hidden="true">#</a> Install ClamAV from source <span class="badge warning" style=""><!--[-->dev<!--]--></span></h2><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Ubuntu</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-bash ext-sh"><pre class="language-bash"><code>server@ubuntu:~$ <span class="token function">sudo</span> <span class="token function">apt-get</span> update <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> -y upgrade <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> -y gcc <span class="token function">make</span> pkg-config python3 python3-pip python3-pytest valgrind <span class="token punctuation">\</span>
check libbz2-dev libcurl4-openssl-dev libjson-c-dev libmilter-dev <span class="token punctuation">\</span>
libncurses5-dev libpcre2-dev libssl-dev libxml2-dev zlib1g-dev
</code></pre></div><!--]--></div><!--]--></div><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Ubuntu</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-bash ext-sh"><pre class="language-bash"><code>server@ubuntu:~$ python3 -m pip <span class="token function">install</span> --user cmake
</code></pre></div><!--]--></div><!--]--></div><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Ubuntu</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-bash ext-sh"><pre class="language-bash"><code>server@ubuntu:~$ https://www.clamav.net/downloads/production/clamav-0.104.0.tar.gz
https://www.clamav.net/downloads/production/clamav-0.104.0.tar.gz.sig
</code></pre></div><!--]--></div><!--]--></div><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Ubuntu</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-bash ext-sh"><pre class="language-bash"><code>server@ubuntu:~$ <span class="token function">tar</span> -xvzf https://www.clamav.net/downloads/production/clamav-0.104.0.tar.gz <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token builtin class-name">cd</span> clamav-0.104.0/ <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">mkdir</span> build <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> build <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
cmake <span class="token punctuation">..</span> <span class="token punctuation">\</span>
  -D <span class="token assign-left variable">CMAKE_INSTALL_PREFIX</span><span class="token operator">=</span>/usr <span class="token punctuation">\</span>
  -D <span class="token assign-left variable">CMAKE_INSTALL_LIBDIR</span><span class="token operator">=</span>lib <span class="token punctuation">\</span>
  -D <span class="token assign-left variable">APP_CONFIG_DIRECTORY</span><span class="token operator">=</span>/etc/clamav <span class="token punctuation">\</span>
  -D <span class="token assign-left variable">DATABASE_DIRECTORY</span><span class="token operator">=</span>/var/lib/clamav <span class="token punctuation">\</span>
  -D <span class="token assign-left variable">ENABLE_JSON_SHARED</span><span class="token operator">=</span>OFF <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
cmake --build <span class="token builtin class-name">.</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
ctest <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> cmake --build <span class="token builtin class-name">.</span> --target <span class="token function">install</span>
</code></pre></div><!--]--></div><!--]--></div><h2 id="install-from-repository" tabindex="-1"><a class="header-anchor" href="#install-from-repository" aria-hidden="true">#</a> Install from repository</h2><p>In this tutorial we will install the ClamAV Antivirus Server (the clamav-daemon <code>192.168.0.1</code>) as a own server/virtual machine. We&#39;ll also use the multiscan option, so the more cores the faster your scans will perform. The clients (<code>192.168.0.2</code>, <code>192.168.0.3</code>) will not use the regular <code>clamavscan</code> but rather the <code>clamdscan</code> and listen to the ClamAV Antivirus Server&#39;s TCP socket instead of the local clients unix socket. This approach will also enable us to only keep the ClamAV defintion database up-to-date on the master server.</p><h2 id="clamav-server" tabindex="-1"><a class="header-anchor" href="#clamav-server" aria-hidden="true">#</a> ClamAV server</h2><p>First download the ClamAV scanner and the ClamAV daemon.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Ubuntu</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-bash ext-sh"><pre class="language-bash"><code>server@ubuntu:~$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> clamav clamav-daemon
</code></pre></div><!--]--></div><!--]--></div><p>Proceed to stop freshclam the automatic database update tool for ClamAV.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Ubuntu</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-bash ext-sh"><pre class="language-bash"><code>server@ubuntu:~$ <span class="token function">sudo</span> systemctl stop clamav-freshclam
</code></pre></div><!--]--></div><!--]--></div><p>Next run freshclam to update to the latest definition database.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Ubuntu</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-bash ext-sh"><pre class="language-bash"><code>server@ubuntu:~$ <span class="token function">sudo</span> freshclam
</code></pre></div><!--]--></div><!--]--></div><p>Once you&#39;ve ran the freshclam command you can check the log <code>/var/log/clamav/freshclam.log</code> for the current status and then start freshclam again.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Ubuntu</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-bash ext-sh"><pre class="language-bash"><code>server@ubuntu:~$ <span class="token function">cat</span> /var/log/clamav/freshclam.log
Sat Apr <span class="token number">10</span> <span class="token number">17</span>:51:37 <span class="token number">2021</span> -<span class="token operator">&gt;</span> daily.cvd database is up to <span class="token function">date</span> <span class="token punctuation">(</span>version: <span class="token number">26136</span>, sigs: <span class="token number">3969743</span>, f-level: <span class="token number">63</span>, builder: raynman<span class="token punctuation">)</span>
Sat Apr <span class="token number">10</span> <span class="token number">17</span>:51:37 <span class="token number">2021</span> -<span class="token operator">&gt;</span> main.cvd database is up to <span class="token function">date</span> <span class="token punctuation">(</span>version: <span class="token number">59</span>, sigs: <span class="token number">4564902</span>, f-level: <span class="token number">60</span>, builder: sigmgr<span class="token punctuation">)</span>
Sat Apr <span class="token number">10</span> <span class="token number">17</span>:51:37 <span class="token number">2021</span> -<span class="token operator">&gt;</span> bytecode.cvd database is up to <span class="token function">date</span> <span class="token punctuation">(</span>version: <span class="token number">333</span>, sigs: <span class="token number">92</span>, f-level: <span class="token number">63</span>, builder: awillia2<span class="token punctuation">)</span>
server@ubuntu:~$ <span class="token function">sudo</span> systemctl start clamav-freshclam
</code></pre><div class="highlight-lines"><div class="highlight-line"> </div><br><br><br><div class="highlight-line"> </div></div></div><!--]--></div><!--]--></div><p>Now we&#39;ll update the ClamAV daemon configuration to make the server listen to TCP socket 3310.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Ubuntu</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-bash ext-sh"><pre class="language-bash"><code>server@ubuntu:~$ <span class="token function">sudo</span> <span class="token function">nano</span> /etc/clamav/clamd.conf
</code></pre></div><!--]--></div><!--]--></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#Automatically Generated by clamav-daemon postinst</span>
<span class="token comment">#To reconfigure clamd run #dpkg-reconfigure clamav-daemon</span>
<span class="token comment">#Please read /usr/share/doc/clamav-daemon/README.Debian.gz for details</span>
LocalSocket /var/run/clamav/clamd.ctl
FixStaleSocket <span class="token boolean">true</span>
LocalSocketGroup clamav
LocalSocketMode <span class="token number">666</span>
<span class="token comment"># TemporaryDirectory is not set to its default /tmp here to make overriding</span>
<span class="token comment"># the default with environment variables TMPDIR/TMP/TEMP possible</span>
User clamav
TCPSocket <span class="token number">3310</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div></div><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>Restart ClamAV to apply the new changes.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Ubuntu</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-bash ext-sh"><pre class="language-bash"><code>server@ubuntu:~$ <span class="token function">sudo</span> systemctl restart clamav-daemon.service
</code></pre></div><!--]--></div><!--]--></div><p>To confirm that ClamAV listen to TCP port 3310 run the command below (requires <code>net-tools</code>).</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Ubuntu</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-bash ext-sh"><pre class="language-bash"><code>server@ubuntu:~$ <span class="token function">netstat</span> -lnp <span class="token operator">|</span> <span class="token function">grep</span> -E <span class="token string">&quot;(clam|3310)&quot;</span>
<span class="token punctuation">(</span>Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.<span class="token punctuation">)</span>
tcp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">0.0</span>.0.0:3310            <span class="token number">0.0</span>.0.0:*               LISTEN      -
tcp6       <span class="token number">0</span>      <span class="token number">0</span> :::3310                 :::*                    LISTEN      -
unix  <span class="token number">2</span>      <span class="token punctuation">[</span> ACC <span class="token punctuation">]</span>     STREAM     LISTENING     <span class="token number">73674</span>    -                    /var/run/clamav/clamd.ctl
</code></pre><div class="highlight-lines"><br><br><br><div class="highlight-line"> </div><br><br></div></div><!--]--></div><!--]--></div><p>Make sure that the firewall settings are in place and that the correct ports are opened for any ClamAV client. See the <a href="#firewall-settings">Firewall settings</a> section for more information.</p><h3 id="keep-virus-definitions-up-to-date" tabindex="-1"><a class="header-anchor" href="#keep-virus-definitions-up-to-date" aria-hidden="true">#</a> Keep virus definitions up-to-date</h3><p>To keep the ClamAV Antivirus Server definition database up-to-date you can configure freshclam when to check for new definitions. The default is set to 24 times per day. If you want to edit this you can define the times per day for freshclam to check for new updates.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Ubuntu</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-bash ext-sh"><pre class="language-bash"><code>server@ubuntu:~$ <span class="token function">sudo</span> <span class="token function">nano</span> /etc/clamav/freshclam.conf
</code></pre></div><!--]--></div><!--]--></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># Check for new database 24 times a day</span>
Checks <span class="token number">24</span>
</code></pre><div class="highlight-lines"><br><div class="highlight-line"> </div></div><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>You can use the <code>clamdtop</code> command-line tool when you&#39;ve installed ClamAV on your clients. This tool enables you to monitor the ClamAV daemon performance and client connections during scan.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Ubuntu</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-bash ext-sh"><pre class="language-bash"><code>server@ubuntu:~$ clamdtop

  _____/ /___ _____ ___  ____/ / /_____  ____
 / ___/ / __ <span class="token variable"><span class="token variable">`</span>/ __ <span class="token variable">`</span></span>__ <span class="token punctuation">\</span>/ __  / __/ __ <span class="token punctuation">\</span>/ __ <span class="token punctuation">\</span>
/ /__/ / /_/ / / / / / / /_/ / /_/ /_/ / /_/ /
<span class="token punctuation">\</span>___/_/<span class="token punctuation">\</span>__,_/_/ /_/ /_/<span class="token punctuation">\</span>__,_/<span class="token punctuation">\</span>__/<span class="token punctuation">\</span>____/ .___/
                                     /_/
Connecting to: /var/run/clamav/clamd.ctl
</code></pre></div><!--]--></div><!--]--></div><h2 id="ubuntu-client" tabindex="-1"><a class="header-anchor" href="#ubuntu-client" aria-hidden="true">#</a> Ubuntu client</h2><p>Install ClamAV on Ubuntu 20.04.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Ubuntu</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-bash ext-sh"><pre class="language-bash"><code>client@ubuntu:~$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> clamav clamav-daemon
</code></pre></div><!--]--></div><!--]--></div><p>Next stop and disable the ClamAV daemon (as we will forward the traffic to the ClamAV server). The virus definitions database is managed on the server so you need to stop and disable the freshclam service as well.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Ubuntu</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-bash ext-sh"><pre class="language-bash"><code>client@ubuntu:~$ <span class="token function">sudo</span> systemctl stop clamav-daemon.service
client@ubuntu:~$ <span class="token function">sudo</span> systemctl stop clamav-freshclam.service
client@ubuntu:~$ <span class="token function">sudo</span> systemctl disable clamav-daemon.service
client@ubuntu:~$ <span class="token function">sudo</span> systemctl disable clamav-freshclam.service
</code></pre></div><!--]--></div><!--]--></div><p>Continue to configure the <code>clamdscan</code> which share configuration file with the ClamAV daemon.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Ubuntu</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-bash ext-sh"><pre class="language-bash"><code>client@ubuntu:~$ <span class="token function">sudo</span> <span class="token function">nano</span> /etc/clamav/clamd.conf
</code></pre></div><!--]--></div><!--]--></div><p>Comment the <code>LocalSocket /var/run/clamav/clamd.ctl</code> line and add the <code>TCPSocket 3310</code> along with the server <code>TCPAddr</code>.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#Automatically Generated by clamav-daemon postinst</span>
<span class="token comment">#To reconfigure clamd run #dpkg-reconfigure clamav-daemon</span>
<span class="token comment">#Please read /usr/share/doc/clamav-daemon/README.Debian.gz for details</span>
<span class="token comment">#LocalSocket /var/run/clamav/clamd.ctl</span>
FixStaleSocket <span class="token boolean">true</span>
LocalSocketGroup clamav
LocalSocketMode <span class="token number">666</span>
<span class="token comment"># TemporaryDirectory is not set to its default /tmp here to make overriding</span>
<span class="token comment"># the default with environment variables TMPDIR/TMP/TEMP possible</span>
User clamav
TCPSocket <span class="token number">3310</span>
TCPAddr <span class="token number">192.168</span>.0.1
</code></pre><div class="highlight-lines"><br><br><br><div class="highlight-line"> </div><br><br><br><br><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div></div><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>When running a scan use the <code>multiscan</code> option to enable multihread reading. You can also set it to <code>quiet</code> if you&#39;re going to use the <code>log</code> option. You can also create a <code>file list</code> for all the directories to scan.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Ubuntu</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-bash ext-sh"><pre class="language-bash"><code>client@ubuntu:~$ <span class="token function">sudo</span> clamdscan --multiscan --quiet --file-list<span class="token operator">=</span> --log<span class="token operator">=</span>
</code></pre></div><!--]--></div><!--]--></div><h2 id="windows-client" tabindex="-1"><a class="header-anchor" href="#windows-client" aria-hidden="true">#</a> Windows client</h2><p>First download the <a href="http://www.clamav.net/downloads/production/ClamAV-0.102.4.exe" target="_blank" rel="noopener noreferrer">ClamAV Windows Installer<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> (version 0.102.4). Right-click the executable file <code>ClamAV-0.102.4.exe</code> and select <code>Run as Administrator</code>.</p><img class="zoom-custom-imgs" src="/img/clamav/win10client1.png" alt="Windows 10 setup 1"><p>Select destination location.</p><img class="zoom-custom-imgs" src="/img/clamav/win10client2.png" alt="Windows 10 setup 2"><p>Proceed to click the <code>Install</code> button.</p><img class="zoom-custom-imgs" src="/img/clamav/win10client3.png" alt="Windows 10 setup 3"><p>Once the installation is complete click the <code>Finish</code> button.</p><img class="zoom-custom-imgs" src="/img/clamav/win10client4.png" alt="Windows 10 setup 4"><p>Run PowerShell as administrator and make sure you&#39;re in the correct path <code>C:\WINDOWS\system32</code>. Navigate to the ClamAV directory by entering <code>cd &#39;C:\Program Files\ClamAV\</code>.</p><img class="zoom-custom-imgs" src="/img/clamav/win10client5.png" alt="Windows 10 setup 5"><p>Now copy the ClamAV daeomon configuration and rename it to <code>clamd.conf</code> and open the file in WordPad.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Windows</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-powershell ext-powershell"><pre class="language-powershell"><code>client@windows:~<span class="token function">PS</span>$ <span class="token function">copy</span> <span class="token punctuation">.</span>\conf_examples\clamd<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>sample <span class="token punctuation">.</span>\clamd<span class="token punctuation">.</span>conf
client@windows:~<span class="token function">PS</span>$ <span class="token function">write</span><span class="token punctuation">.</span>exe <span class="token punctuation">.</span>\clamd<span class="token punctuation">.</span>conf
</code></pre></div><!--]--></div><!--]--></div><img class="zoom-custom-imgs" src="/img/clamav/win10client6.png" alt="Windows 10 setup 6"><p>Comment the <code>Example</code> line and add the <code>TCPSocket</code> along with the server <code>TCPAddr</code> and save.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">##</span>
<span class="token comment">## Example config file for the Clam AV daemon</span>
<span class="token comment">## Please read the clamd.conf(5) manual before editing this file.</span>
<span class="token comment">##</span>

<span class="token comment"># Comment or remove the line below.</span>
<span class="token comment">#Example</span>

<span class="token comment"># The daemon on Windows only supports unsecured TCP sockets.</span>
<span class="token comment"># Due to security reasons make sure that your IP &amp; port is not</span>
<span class="token comment"># exposed to the open internet.</span>

<span class="token comment"># TCP port address.</span>
<span class="token comment"># Default: no</span>
TCPSocket <span class="token number">3310</span>

<span class="token comment"># TCP address.</span>
<span class="token comment"># By default we bind to INADDR_ANY, probably not wise.</span>
<span class="token comment"># Enable the following to provide some degree of protection</span>
<span class="token comment"># from the outside world. This option can be specified multiple</span>
<span class="token comment"># times if you want to listen on multiple IPs. IPv6 is now supported.</span>
<span class="token comment"># Default: no</span>
TCPAddr <span class="token number">192.168</span>.0.1
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><div class="highlight-line"> </div><br><br><br><br><br><br><br><div class="highlight-line"> </div><br><br><br><br><br><br><br><div class="highlight-line"> </div></div><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>You may fast test the configuration running a scan in the current directory.</p><img class="zoom-custom-imgs" src="/img/clamav/win10client7.png" alt="Windows 10 setup 7"><p>Running a more complete scan, like during the Ubuntu set up, use the <code>multiscan</code> option to enable multithread reading. Set the output to <code>quiet</code> in case you will use the <code>log</code> option. As priorly mentioned you may also define a <code>file list</code> of all the directories you wish to include in the scan.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Windows</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-powershell ext-powershell"><pre class="language-powershell"><code>client@windows:~<span class="token function">PS</span>$ <span class="token punctuation">.</span>\clamdscan<span class="token punctuation">.</span>exe  <span class="token operator">--</span>multiscan <span class="token operator">--</span>quiet <span class="token operator">--</span>file<span class="token operator">-</span>list= <span class="token operator">--</span>log=
</code></pre></div><!--]--></div><!--]--></div><h2 id="firewall-settings" tabindex="-1"><a class="header-anchor" href="#firewall-settings" aria-hidden="true">#</a> Firewall settings</h2><p>The firewall being used is UFW (Uncomplicated Firewall). It is set by default to deny incoming traffic, allow outgoing traffic and allow port 22 (OpenSSH). Read more about UFW <a href="https://help.ubuntu.com/community/UFW" target="_blank" rel="noopener noreferrer">here<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>.</p><details class="custom-container details"><summary>UFW Settings</summary><div class="language-bash ext-sh"><pre class="language-bash"><code>server@ubuntu:~$ <span class="token function">sudo</span> ufw default deny incoming
server@ubuntu:~$ <span class="token function">sudo</span> ufw default allow outgoing
server@ubuntu:~$ <span class="token function">sudo</span> ufw allow <span class="token number">22</span>
server@ubuntu:~$ <span class="token function">sudo</span> ufw <span class="token builtin class-name">enable</span>
Command may disrupt existing <span class="token function">ssh</span> connections. Proceed with operation <span class="token punctuation">(</span>y<span class="token operator">|</span>n<span class="token punctuation">)</span>? y
Firewall is active and enabled on system startup
</code></pre></div></details><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Ubuntu</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-bash ext-sh"><pre class="language-bash"><code>server@ubuntu:~$ <span class="token function">sudo</span> ufw allow proto tcp from <span class="token number">192.168</span>.0.2 to any port <span class="token number">3310</span> comment <span class="token string">&quot;ClamAV client 1&quot;</span>
server@ubuntu:~$ <span class="token function">sudo</span> ufw allow proto tcp from <span class="token number">192.168</span>.0.3 to any port <span class="token number">3310</span> comment <span class="token string">&quot;ClamAV client 2&quot;</span>
</code></pre></div><!--]--></div><!--]--></div><p>If you want to allow TCP connection to port 3310 for the entire subnet apply the following UFW rule.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Ubuntu</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-bash ext-sh"><pre class="language-bash"><code>server@ubuntu:~$ <span class="token function">sudo</span> ufw allow proto tcp from <span class="token number">192.168</span>.0.0/24 to any port <span class="token number">3310</span> comment <span class="token string">&quot;ClamAV clients&quot;</span>
</code></pre></div><!--]--></div><!--]--></div><h2 id="troubleshooting" tabindex="-1"><a class="header-anchor" href="#troubleshooting" aria-hidden="true">#</a> Troubleshooting</h2><p>In case you&#39;ll need help troubleshooting or support for ClamAV you can sign up for their mailing list at <a href="https://lists.clamav.net/mailman/listinfo/clamav-users" target="_blank" rel="noopener noreferrer">ClamAV users<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>.</p><h2 id="enterprise-solutions" tabindex="-1"><a class="header-anchor" href="#enterprise-solutions" aria-hidden="true">#</a> Enterprise solutions <span class="badge tip" style=""><!--[-->non-sponsored<!--]--></span></h2><h3 id="atomic-protector" tabindex="-1"><a class="header-anchor" href="#atomic-protector" aria-hidden="true">#</a> Atomic Protector</h3><p>Atomic Protector, is an upgrade from Atomic Secured Linux and Atomic Workload Protection products, provides maximum security and compliance for systems in on-premise, cloud and hybrid environments all in a single pane of glass you can run anywhere. Features include compliance and vulnerability management, reporting, intrusion prevention, file integrity monitoring, memory protection and exploit prevention, vulnerability shielding, web application and API protection, application control, and more.</p><p><a href="https://atomicorp.com/atomic-protector/" target="_blank" rel="noopener noreferrer">Atomic Protector<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="nav-link external meta-item-label" href="https://github.com/libellux/Libellux-Up-and-Running/edit/master/docs/clamav/README.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">10/9/2021, 4:57:36 PM</span></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: fredrik@libellux.com">Libellux</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"> ← <a href="/openvas/" class="nav-link" aria-label="Greenbone Vulnerability Manager"><!--[--><!--]--> Greenbone Vulnerability Manager <!--[--><!--]--></a></span><span class="next"><a href="/psad/" class="nav-link" aria-label="PSAD Intrusion Detection"><!--[--><!--]--> PSAD Intrusion Detection <!--[--><!--]--></a> → </span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script src="/assets/js/runtime~app.7dbcf5d9.js" defer></script><script src="/assets/js/5.dc697aaf.js" defer></script><script src="/assets/js/app.6bd9c778.js" defer></script>
  </body>
</html>
