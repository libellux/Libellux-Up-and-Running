<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.8" />
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html,
      body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches
      if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
        document.documentElement.classList.toggle('dark', true)
      }
    </script>
    <link rel="canonical" href="https://wwww.libellux.com/privacyidea/"><script src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" google_ad_client="ca-pub-3592345228354158" crossorigin="anonymous"></script><script src="https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js" type="adsense" data_ad_client="ca-pub-3592345228354158" crossorigin="anonymous"></script><script src="//cdn.cookie-script.com/s/fa4657f337d83fad06d3aaf87a232c6d.js"></script><script>
      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5DHC7KR');
    </script><meta name="robots" content="index, follow"><link rel="manifest" href="/manifest.webmanifest"><meta name="theme-color" content="#8c7bce"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@libellux1"><meta name="twitter:title" content="Libellux"><meta name="twitter:description" content="Libellux: Up & Running provides documentation on how-to install open-source software from source. The focus is Zero Trust Network to enhance the security for existing applications or install tools to detect and prevent threats."><meta name="twitter:image" content="https://www.libellux.com/img/icons/4096x4096.png"><meta name="twitter:width" content="4096"><meta name="twitter:height" content="4096"><meta property="og:locale" content="en_US"><meta property="og:type" content="website"><meta property="og:title" content="Libellux"><meta property="og:description" content="Libellux: Up & Running provides documentation on how-to install open-source software from source. The focus is Zero Trust Network to enhance the security for existing applications or install tools to detect and prevent threats."><meta property="og:url" content="https://www.libellux.com"><meta property="og:site_name" content="Libellux"><meta property="og:publisher" content="https://www.facebook.com/libellux1"><meta property="og:author" content="https://www.facebook.com/fredrik.hilmersson.1"><meta property="og:image" content="https://www.libellux.com/img/icons/1200x627.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link rel="icon" href="https://www.libellux.com/img/icons/48x48.png"><meta name="msapplication-TileImage" content="https://www.libellux.com/img/icons/144x144.png"><link rel="apple-touch-icon" sizes="48x48" href="https://www.libellux.com/img/icons/48x48.png"><link rel="apple-touch-icon" sizes="72x72" href="https://www.libellux.com/img/icons/72x72.png"><link rel="apple-touch-icon" sizes="144x144" href="https://www.libellux.com/img/icons/144x144.png"><link rel="apple-touch-icon" sizes="192x192" href="https://www.libellux.com/img/icons/192x192.png"><link rel="apple-touch-icon" sizes="256x256" href="https://www.libellux.com/img/icons/256x256.png"><link rel="apple-touch-icon" sizes="384x384" href="https://www.libellux.com/img/icons/384x384.png"><link rel="apple-touch-icon" sizes="512x512" href="https://www.libellux.com/img/icons/512x512.png"><link rel="apple-touch-icon" sizes="1200x627" href="https://www.libellux.com/img/icons/1200x627.png"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"><title>Two-factor authentication w/ privacyIDEA and YubiKey | Libellux</title><meta name="description" content="privacyIDEA is a modular authentication server that can be used to enhance the security of your existing applications like local login, VPN, remote access, SSH connections, access to web sites or web portals with two factor authentication.">
    <link rel="preload" href="/assets/style-uHO8Hgvz.css" as="style"><link rel="stylesheet" href="/assets/style-uHO8Hgvz.css">
    <link rel="modulepreload" href="/assets/app-DwdMjt-K.js"><link rel="modulepreload" href="/assets/index.html-55aR_Hmx.js">
    
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><img class="logo" src="/img/icons/72x72.png" alt="Libellux"><span class="site-name can-hide" aria-hidden="true">Libellux</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide" aria-label="site navigation"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Libellux: Up &amp; Running"><span class="title">Libellux: Up &amp; Running</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Libellux: Up &amp; Running"><span class="title">Libellux: Up &amp; Running</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Libellux: Up &amp; Running</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Zero Trust Network</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/wireguard/" aria-label="WireGuard Secure VPN Tunnel"><!--[--><!--]--> WireGuard Secure VPN Tunnel <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link route-link-active" href="/privacyidea/" aria-label="Two-factor authentication w/ privacyIDEA and YubiKey"><!--[--><!--]--> Two-factor authentication w/ privacyIDEA and YubiKey <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Intrusion Detection and Prevention</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/ossec/" aria-label="OSSEC Host Intrusion Detection"><!--[--><!--]--> OSSEC Host Intrusion Detection <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/openvas/" aria-label="Greenbone Vulnerability Manager"><!--[--><!--]--> Greenbone Vulnerability Manager <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/clamav/" aria-label="ClamAV Antivirus Server"><!--[--><!--]--> ClamAV Antivirus Server <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/psad/" aria-label="PSAD Intrusion Detection"><!--[--><!--]--> PSAD Intrusion Detection <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Monitoring and Management</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/ansible/" aria-label="Ansible"><!--[--><!--]--> Ansible <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/mmonit/" aria-label="M/Monit System Monitoring"><!--[--><!--]--> M/Monit System Monitoring <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/rsyslog/" aria-label=" Rsyslog Syslog Processing"><!--[--><!--]-->  Rsyslog Syslog Processing <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://status.libellux.com/" rel="noopener noreferrer" target="_blank" aria-label="Status"><!--[--><!--]--> Status <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/libellux/Libellux-Up-and-Running" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!--[--><div id="docsearch-container" style="display:none;"></div><div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items" aria-label="site navigation"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Libellux: Up &amp; Running"><span class="title">Libellux: Up &amp; Running</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Libellux: Up &amp; Running"><span class="title">Libellux: Up &amp; Running</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Libellux: Up &amp; Running</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Zero Trust Network</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/wireguard/" aria-label="WireGuard Secure VPN Tunnel"><!--[--><!--]--> WireGuard Secure VPN Tunnel <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link route-link-active" href="/privacyidea/" aria-label="Two-factor authentication w/ privacyIDEA and YubiKey"><!--[--><!--]--> Two-factor authentication w/ privacyIDEA and YubiKey <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Intrusion Detection and Prevention</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/ossec/" aria-label="OSSEC Host Intrusion Detection"><!--[--><!--]--> OSSEC Host Intrusion Detection <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/openvas/" aria-label="Greenbone Vulnerability Manager"><!--[--><!--]--> Greenbone Vulnerability Manager <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/clamav/" aria-label="ClamAV Antivirus Server"><!--[--><!--]--> ClamAV Antivirus Server <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/psad/" aria-label="PSAD Intrusion Detection"><!--[--><!--]--> PSAD Intrusion Detection <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Monitoring and Management</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/ansible/" aria-label="Ansible"><!--[--><!--]--> Ansible <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/mmonit/" aria-label="M/Monit System Monitoring"><!--[--><!--]--> M/Monit System Monitoring <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/rsyslog/" aria-label=" Rsyslog Syslog Processing"><!--[--><!--]-->  Rsyslog Syslog Processing <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://status.libellux.com/" rel="noopener noreferrer" target="_blank" aria-label="Status"><!--[--><!--]--> Status <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/libellux/Libellux-Up-and-Running" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">Libellux: Up &amp; Running <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading active">Zero Trust Network <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/wireguard/" aria-label="WireGuard Secure VPN Tunnel"><!--[--><!--]--> WireGuard Secure VPN Tunnel <!--[--><!--]--></a><!----></li><li><a class="route-link route-link-active sidebar-item active" href="/privacyidea/" aria-label="Two-factor authentication w/ privacyIDEA and YubiKey"><!--[--><!--]--> Two-factor authentication w/ privacyIDEA and YubiKey <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/#prerequisites" aria-label="Prerequisites"><!--[--><!--]--> Prerequisites <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#configuration-files" aria-label="Configuration files"><!--[--><!--]--> Configuration files <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#install-community-edition" aria-label="Install community edition"><!--[--><!--]--> Install community edition <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#privacyidea-freeradius-plugin" aria-label="privacyIDEA FreeRADIUS plugin"><!--[--><!--]--> privacyIDEA FreeRADIUS plugin <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#configure-privacyidea" aria-label="Configure privacyIDEA"><!--[--><!--]--> Configure privacyIDEA <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#configure-yubikey-for-privacyidea" aria-label="Configure YubiKey for privacyIDEA"><!--[--><!--]--> Configure YubiKey for privacyIDEA <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#enroll-token-w-yubikey" aria-label="Enroll token w/ YubiKey"><!--[--><!--]--> Enroll token w/ YubiKey <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#enable-2fa-for-greenbone-vulnerability-manager" aria-label="Enable 2FA for Greenbone Vulnerability Manager"><!--[--><!--]--> Enable 2FA for Greenbone Vulnerability Manager <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#firewall-settings" aria-label="Firewall settings"><!--[--><!--]--> Firewall settings <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#command-line" aria-label="Command-line"><!--[--><!--]--> Command-line <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#troubleshooting" aria-label="Troubleshooting"><!--[--><!--]--> Troubleshooting <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#enterprise-solutions" aria-label="Enterprise solutions"><!--[--><!--]--> Enterprise solutions <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/#netknights-privacyidea-enterprise-edition" aria-label="NetKnights privacyIDEA Enterprise Edition"><!--[--><!--]--> NetKnights privacyIDEA Enterprise Edition <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#yubienterprise" aria-label="YubiEnterprise"><!--[--><!--]--> YubiEnterprise <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">Intrusion Detection and Prevention <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/ossec/" aria-label="OSSEC Host Intrusion Detection"><!--[--><!--]--> OSSEC Host Intrusion Detection <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/openvas/" aria-label="Greenbone Vulnerability Manager"><!--[--><!--]--> Greenbone Vulnerability Manager <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/clamav/" aria-label="ClamAV Antivirus Server"><!--[--><!--]--> ClamAV Antivirus Server <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/psad/" aria-label="PSAD Intrusion Detection"><!--[--><!--]--> PSAD Intrusion Detection <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">Monitoring and Management <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/ansible/" aria-label="Ansible"><!--[--><!--]--> Ansible <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/mmonit/" aria-label="M/Monit System Monitoring"><!--[--><!--]--> M/Monit System Monitoring <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/rsyslog/" aria-label="Rsyslog Syslog Processing"><!--[--><!--]--> Rsyslog Syslog Processing <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="two-factor-authentication-w-privacyidea-and-yubikey" tabindex="-1"><a class="header-anchor" href="#two-factor-authentication-w-privacyidea-and-yubikey"><span>Two-factor authentication w/ privacyIDEA and YubiKey <span class="badge tip" style=""><!--[-->Rev 1<!--]--></span></span></a></h1><p>privacyIDEA is a modular authentication server that can be used to enhance the security of your existing applications like local login, VPN, remote access, SSH connections, access to web sites or web portals with two-factor authentication.</p><p><a href="https://www.privacyidea.org/" target="_blank" rel="noopener noreferrer">privacyIDEA website<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> <a href="https://github.com/privacyidea/privacyidea" target="_blank" rel="noopener noreferrer">GitHub<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><br><a href="https://www.pntrs.com/t/TUJGR0dNRkJHRk1NR0ZCRk5GSkxK" target="_blank" rel="noopener noreferrer">Yubico website<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> <span class="badge warning" style=""><!--[-->affiliate links<!--]--></span></p><p>Setup and configuration has been tested on the following operating systems:</p><ul><li>Ubuntu 20.04 (Focal Fossa)</li><li>privacyIDEA- 3.5.2</li><li><a href="https://www.pntrs.com/t/TUJGR0dNRkJHRk1NR0ZCRk5GSkxK" target="_blank" rel="noopener noreferrer">YubiKey 5 NFC<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><p><a href="https://ko-fi.com/B0B31BJU3" target="_blank" rel="noopener noreferrer"><img src="https://www.ko-fi.com/img/githubbutton_sm.svg" alt="ko-fi"><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="prerequisites" tabindex="-1"><a class="header-anchor" href="#prerequisites"><span>Prerequisites</span></a></h2><ul><li><a href="https://www.pntrs.com/t/TUJGR0dNRkJHRk1NR0ZCRk5GSkxK" target="_blank" rel="noopener noreferrer">YubiKey 5 NFC<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> (optional)</li><li><a href="https://www.yubico.com/support/download/yubikey-personalization-tools/" target="_blank" rel="noopener noreferrer">YubiKey Personalization Tool<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> (optional)</li></ul><h2 id="configuration-files" tabindex="-1"><a class="header-anchor" href="#configuration-files"><span>Configuration files</span></a></h2><h2 id="install-community-edition" tabindex="-1"><a class="header-anchor" href="#install-community-edition"><span>Install community edition</span></a></h2><p>We will use privacyIDEA and their FreeRADIUS plugin together with <a href="https://www.pntrs.com/t/TUJGR0dNRkJHRk1NR0ZCRk5GSkxK" target="_blank" rel="noopener noreferrer">YubiKey 5 NFC<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> (from Yubico) to enforce two-factor authentication and apply an role-based access control approach (RBAC). We will simplify the user accounting by fetching the users from the local <code>/etc/passwd</code> file and use it as the privacyIDEA resolver (instead of e.g. LDAP, SQL. You can read more about resolvers <a href="https://privacyidea.readthedocs.io/en/latest/configuration/useridresolvers.html#useridresolvers" target="_blank" rel="noopener noreferrer">here<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>). To get an hands-on experience we will use the privacyIDEA authentication server to access the <a class="route-link" href="/openvas/">Greenbone Vulnerability Manager&#39;s</a> user interface.</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>This is the first revision for privacyIDEA. We will write more about the different modular options e.g. LDAP as resolver in future releases. If there&#39;s any particular configuration you would like us to cover feel free to create a new <a href="https://github.com/libellux/Libellux-Up-and-Running/issues/new/choose" target="_blank" rel="noopener noreferrer">Feature request<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p></div><p>To get started download the signed key.</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>server@ubuntu:~$ wget https://lancelot.netknights.it/NetKnights-Release.asc
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Next import the signed key.</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>server@ubuntu:~$ sudo gpg --import --import-options show-only --with-fingerprint NetKnights-Release.asc
pub rsa4096 2017-05-16  NetKnights GmbH &lt;release@netknights.it&gt;
Key fingerprint = 0940 4ABB EDB3 586D EDE4  AD22 00F7 0D62 AE25 0082
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Continue by adding the key to our system.</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>server@ubuntu:~$ sudo apt-key add NetKnights-Release.asc
OK
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Now we need to add the repository for the specific release (in this case Ubuntu 20.04).</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>server@ubuntu:~$ sudo add-apt-repository http://lancelot.netknights.it/community/focal/stable
server@ubuntu:~$ sudo apt-get update
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>If you prefer to use the nginx version you can install <code>apt-get privacyidea-nginx</code></p></div><p>Once we updated the package manager we can install PrivacyIDEA.</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>server@ubuntu:~$ sudo apt-get update
server@ubuntu:~$ sudo apt-get install privacyidea-apache2
             _                    _______  _______
   ___  ____(_)  _____ _______ __/  _/ _ \/ __/ _ |
  / _ \/ __/ / |/ / _ `/ __/ // // // // / _// __ |
 / .__/_/ /_/|___/\_,_/\__/\_, /___/____/___/_/ |_|
/_/                       /___/

Running online
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Let&#39;s create the administration account.</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>server@ubuntu:~$ sudo pi-manage admin add admin -e admin@localhost
Admin admin was registered successfully.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Once you&#39;ve added the administrator account and followed the <a href="#firewall-settings">firewall settings</a> you should be able to reach the web interface from <code>https://192.168.0.1</code> and login as the admin user with your password.</p><img class="zoom-custom-imgs" src="/img/privacyidea/privacyidea_login.png" alt="PrivacyIDEA login"><h2 id="privacyidea-freeradius-plugin" tabindex="-1"><a class="header-anchor" href="#privacyidea-freeradius-plugin"><span>privacyIDEA FreeRADIUS plugin</span></a></h2><p>Now we will install the privacyIDEA freeRADIUS plugin, which we will be using to enable RADIUS for <a class="route-link" href="/openvas/">Greenbone Vulnerability Manager</a>.</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>server@ubuntu:~$ sudo apt-get install privacyidea-radius
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>In the <code>clients.conf</code> we will add our client(s), which in this case is our <a class="route-link" href="/openvas/">Greenbone Vulnerability Manager</a>. Define the IP address of the <a class="route-link" href="/openvas/">Greenbone Vulnerability Manager</a> and set the secret (do not use the default secret).</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>server@ubuntu:~$ sudo -i
root@ubuntu:~$ sudo nano /etc/freeradius/3.0/clients.conf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">#client example.org {</span>
<span class="token comment">#       ipaddr          = radius.example.org</span>
<span class="token comment">#       secret          = testing123</span>
<span class="token comment">#}</span>
client GVM <span class="token punctuation">{</span>
        ipaddr <span class="token operator">=</span> <span class="token number">192.168</span>.0.3
        secret <span class="token operator">=</span> testing123
<span class="token punctuation">}</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In the <code>sites-enabled</code> folder you will find the default authentication settings for privacyIDEA. Leave the default <code>perl-privacyidea</code> type.</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>root@ubuntu:~$ cd /etc/freeradius/3.0/sites-enabled/
root@ubuntu:~$ cat privacyidea
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>server {
    authorize {
        #files
        perl-privacyidea
        if (ok || updated) {
            update control {
                Auth-Type := Perl
            }
        }
    }
    listen {
        type = auth
        ipaddr = *
        port = 0
    }
    authenticate {
        Auth-Type Perl {
            perl-privacyidea
        }
    }
}
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The authentication type which is an enabled mod is located in the <code>mods-enabled</code> directory and you will see the <code>privacyidea_radius.pm</code> module file. Leave the default settings.</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>root@ubuntu:~$ cd /etc/freeradius/3.0/mods-enabled/
root@ubuntu:~$ cat mods-perl-privacyidea
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>perl perl-privacyidea {
    filename = /usr/share/privacyidea/freeradius/privacyidea_radius.pm
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="configure-privacyidea" tabindex="-1"><a class="header-anchor" href="#configure-privacyidea"><span>Configure privacyIDEA</span></a></h2><p>As we configured the local freeRADIUS plugin and added <a class="route-link" href="/openvas/">Greenbone Vulnerability Manager</a> as a client we will now configure the privacyIDEA authentication server. The freeRADIUS plugin doesn&#39;t have to be installed on the same server as privacyIDEA. You can define this in the <code>rlm_perl.ini</code> file. In this tutorial we will leave the default localhost as our domain.</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>root@ubuntu:~$ exit
server@ubuntu:~$ sudo nano /etc/privacyidea/rlm_perl.ini
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>[Default]
URL = https://localhost/validate/check
#REALM = someRealm
#RESCONF = someResolver
SSL_CHECK = false
#DEBUG = true
</code></pre><div class="highlight-lines"><br><div class="highlight-line"> </div><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="configure-yubikey-for-privacyidea" tabindex="-1"><a class="header-anchor" href="#configure-yubikey-for-privacyidea"><span>Configure YubiKey for privacyIDEA</span></a></h2><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>privacyIDEA requires <a href="https://www.pntrs.com/t/TUJGR0dNRkJHRk1NR0ZCRk5GSkxK" target="_blank" rel="noopener noreferrer">YubiKey 5 NFC<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p></div><p>Start YubiKey Personalization Tool. Go to Settings. In the <code>Logging Settings</code> select <code>Flexible format</code> and add <code>{serial}, {secretKeyTxt}</code> variables in the form field.</p><img class="zoom-custom-imgs" src="/img/privacyidea/yubikey-settings.png" alt="yubikey settings"><p>Next click the <code>OATH-HOTP</code> tab. Select which slot you wish to write your configuration to. Uncheck <code>OATH Token Identifier</code> and create the secret key by pressing the <code>Generate</code> button. Complete the build by clicking the <code>Write Configuration</code> button and save the CSV file.</p><img class="zoom-custom-imgs" src="/img/privacyidea/yubikey-hotp.png" alt="yubikey hotp"><h2 id="enroll-token-w-yubikey" tabindex="-1"><a class="header-anchor" href="#enroll-token-w-yubikey"><span>Enroll token w/ YubiKey</span></a></h2><p>Before we enroll the token with YubiKey we will create a resolver and realm and select the first user. Login to privacyIDEA at e.g. <code>https://192.168.0.1</code>. In the top menu click <code>Config</code>. Next click the <code>Users</code> tab and select <code>New passwdresolver</code>. Once you&#39;ve given the resolver a name click the <code>Save Resolver</code> button.</p><img class="zoom-custom-imgs" src="/img/privacyidea/privacyidea-resolver.png" alt="privacyidea resolver"><p>Next we will create the realm. Click the tab <code>Realms</code>. Give the realm a name and check the passwdresolver we just created. Click <code>Create Realm</code>.</p><img class="zoom-custom-imgs" src="/img/privacyidea/privacyidea-realm.png" alt="privacyidea realm"><p>Now lets select the first user. In the top menu click <code>Users</code>. Select the realm we just created in the left dropdown menu. This will show the list of all users from the <code>/etc/passwd</code> file. You can select any user from the list. We will go with the user <code>mail</code> for this example.</p><img class="zoom-custom-imgs" src="/img/privacyidea/privacyidea-users.png" alt="privacyidea users"><p>Once you&#39;ve decided which user you will connect to the YubiKey you can now assign your first token to a user. In the top menu click <code>Token</code> and select <code>Import Tokens</code> in the left menu. Select authentication method <code>OATH CSV</code> and realm. Click the <code>Select file and import</code> button and upload the file that you created earlier from the YubiKey configuration.</p><img class="zoom-custom-imgs" src="/img/privacyidea/privacyidea-token.png" alt="privacyidea assign token"><p>Go back to <code>All tokens</code> in the left menu and you will see your newly enrolled token. Click the serial number for further details.</p><img class="zoom-custom-imgs" src="/img/privacyidea/privacyidea-token-2.png" alt="privacyidea token"><p>Here you will see the specific settings and details for the newly enrolled token. Now we will assign this token to the user. In the <code>Assign User</code> section select the <code>Realm</code>, fill in the <code>Username</code> you selected from the resolver list and finally set a <code>PIN</code> (in this example we used <code>mail</code> as the PIN). Click the <code>Assign User</code> button.</p><img class="zoom-custom-imgs" src="/img/privacyidea/privacyidea-assign-token.png" alt="privacyidea assign token"><p>Next lets test if the token works. Above the <code>Assign User</code> section, in the form field next to the test token button, type your selected <code>PIN</code> and click your <a href="https://www.pntrs.com/t/TUJGR0dNRkJHRk1NR0ZCRk5GSkxK" target="_blank" rel="noopener noreferrer">YubiKey 5 NFC<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> button and hit the <code>Test token</code> button.</p><img class="zoom-custom-imgs" src="/img/privacyidea/privacyidea-test-token.png" alt="privacyidea test token"><p>You can also test if privacyIDEA grants access to the freeRADIUS client directly from the command-line. Fill in your <code>User-Name</code>, insert your <code>PIN</code> within the <code>User-Password</code> variable and hit your YubiKey button to output the token. Make sure to also define your secret.</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>server@ubuntu:~$ echo &quot;User-Name=mail, User-Password=mail123456&quot; | radclient -x -s localhost auth testing123
Sent Access-Request Id 61 from 0.0.0.0:59998 to 127.0.0.1:1812 length 44
        User-Name = &quot;mail123456&quot;
        User-Password = &quot;mail123456&quot;
        Cleartext-Password = &quot;mail123456&quot;
Received Access-Accept Id 61 from 127.0.0.1:1812 to 127.0.0.1:59998 length 48
        Reply-Message = &quot;privacyIDEA access granted&quot;
Packet summary:
        Accepted      : 1
        Rejected      : 0
        Lost          : 0
        Passed filter : 1
        Failed filter : 0
</code></pre><div class="highlight-lines"><div class="highlight-line"> </div><br><br><br><br><br><div class="highlight-line"> </div><br><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now go to the <code>Config</code> menu and select the <code>System</code> tab. In the <code>System Config</code> add <code>127.0.0.1</code> in the <code>Override Authorization Clients</code> field to enable the validation check against the local subnet (e.g. <code>192.168.0.3</code>). Click the <code>Save System Config</code> button.</p><img class="zoom-custom-imgs" src="/img/privacyidea/privacyidea-override-authentication.png" alt="privacyidea override authentication"><h2 id="enable-2fa-for-greenbone-vulnerability-manager" tabindex="-1"><a class="header-anchor" href="#enable-2fa-for-greenbone-vulnerability-manager"><span>Enable 2FA for Greenbone Vulnerability Manager</span></a></h2><p>Login to your Greenbone Security Assistant at e.g. <code>https://192.168.0.3/login</code>. Once you&#39;ve logged in select <code>Administration</code> and <code>RADIUS</code> in the top menu. Click the <code>Edit Radius Authentication</code> button. Check the <code>Enabled</code> box, add the RADIUS host IP address e.g. <code>192.168.0.1</code> and your secret key. Click the <code>Save</code> button.</p><img class="zoom-custom-imgs" src="/img/privacyidea/greenbone-radius.png" alt="greenbone security assistant radius"><p>Next lets add the user to the Greebone Security Assistant (GSA). Select <code>Administration</code> and <code>Users</code> in the top menu. Click the <code>New User</code> button. Check <code>RADIUS Authentication Only</code>, select preferred user role and/or group. Add the privacyIDEA IP address in the <code>Host Access</code> field (e.g. <code>192.168.0.1</code>) and check <code>Deny all and allow</code>. If you want to lock access for the local subnet to GSA you can check <code>Deny all and allow</code> in the <code>Interface Access</code> and enter <code>192.168.0.0/24</code>. Once done click the <code>Save</code> button.</p><img class="zoom-custom-imgs" src="/img/privacyidea/greenbone-user.png" alt="greenbone security assistant user"><p>Logout as administrator from the Greenbone Security Assistant. Add the <code>Username</code> of your newly created user. In the <code>Password</code> field type the <code>PIN</code> and hit the YubiKey button (do not click the Sign In button) and you should successfully be authenticated.</p><img class="zoom-custom-imgs" src="/img/privacyidea/greenbone-login.png" alt="greenbone security assistant login"><h2 id="firewall-settings" tabindex="-1"><a class="header-anchor" href="#firewall-settings"><span>Firewall settings</span></a></h2><p>The firewall being used is UFW (Uncomplicated Firewall). It is set by default to deny incoming traffic, allow outgoing traffic and allow port 22 (OpenSSH). Read more about UFW <a href="https://help.ubuntu.com/community/UFW" target="_blank" rel="noopener noreferrer">here<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><details class="custom-container details"><summary>UFW Settings</summary><div class="language-console line-numbers-mode" data-ext="console" data-title="console"><pre class="language-console"><code>server@ubuntu:~$ sudo ufw default deny incoming
server@ubuntu:~$ sudo ufw default allow outgoing
server@ubuntu:~$ sudo ufw allow 22
server@ubuntu:~$ sudo ufw enable
Command may disrupt existing ssh connections. Proceed with operation (y|n)? y
Firewall is active and enabled on system startup
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><div class="language-console line-numbers-mode" data-ext="console" data-title="console"><pre class="language-console"><code>server@ubuntu:~$ sudo ufw allow 443 comment &quot;privacyIDEA&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="command-line" tabindex="-1"><a class="header-anchor" href="#command-line"><span>Command-line</span></a></h2><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td>pi-manage admin</td><td>Add or edit existing admin account</td></tr></tbody></table><h2 id="troubleshooting" tabindex="-1"><a class="header-anchor" href="#troubleshooting"><span>Troubleshooting</span></a></h2><p>If you encounter any issue or having questions regarding privacyIDEA I recommend using their very helpful <a href="https://community.privacyidea.org/" target="_blank" rel="noopener noreferrer">community forum<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><h2 id="enterprise-solutions" tabindex="-1"><a class="header-anchor" href="#enterprise-solutions"><span>Enterprise solutions <span class="badge tip" style=""><!--[-->non-sponsored<!--]--></span></span></a></h2><h3 id="netknights-privacyidea-enterprise-edition" tabindex="-1"><a class="header-anchor" href="#netknights-privacyidea-enterprise-edition"><span>NetKnights privacyIDEA Enterprise Edition</span></a></h3><p>privacyIDEA is a modular solution for two factor authentication especially with OTP tokens. It is multi-tenency- and multi-instance-capable. Due to the modular structure privacyIDEA can be quickly and easily adapted and enhanced. E.g. adding new token types is as simple as writing a new lean python module. You do not need to modify your network for privacyIDEA, it does not write to existing databases or user stores. It only needs read access to your user stores like LDAP, Active Directory, SQL, SCIM-service or flat files. Existing workflows can be enhanced without the need to modify them. Using its simple REST like API it can be automated and smoothly be integrated.</p><p><a href="https://netknights.it/en/produkte/privacyidea/" target="_blank" rel="noopener noreferrer">NetKnights<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="yubienterprise" tabindex="-1"><a class="header-anchor" href="#yubienterprise"><span>YubiEnterprise <span class="badge warning" style=""><!--[-->affiliate links<!--]--></span></span></a></h3><p>Yubico offers enterprise solutions and can easily procure and distribute YubiKey authentication solutions for employees at scale.</p><p><a href="https://www.pntrs.com/t/TUJGR0dNRkJHRk1NR0ZCRk5GSkxK" target="_blank" rel="noopener noreferrer">Yubico<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/libellux/Libellux-Up-and-Running/edit/master/docs/privacyidea/README.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: fredrik@libellux.com">Libellux</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: fredrik@libellux.com">Fredrik Hilmersson</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav" aria-label="page navigation"><p class="inner"><span class="prev"><a class="route-link" href="/wireguard/" aria-label="WireGuard Secure VPN Tunnel"><!--[--><!--]--> WireGuard Secure VPN Tunnel <!--[--><!--]--></a></span><!----></p></nav><!--[--><!--]--></main><!--]--></div><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-DwdMjt-K.js" defer></script>
  </body>
</html>
