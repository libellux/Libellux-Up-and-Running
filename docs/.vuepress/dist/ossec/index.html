<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.7" />
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html,
      body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches
      if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
        document.documentElement.classList.toggle('dark', true)
      }
    </script>
    <link rel="canonical" href="https://wwww.libellux.com/ossec/"><script src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" google_ad_client="ca-pub-3592345228354158" crossorigin="anonymous"></script><meta name="robots" content="index, follow"><link rel="manifest" href="/manifest.webmanifest"><meta name="theme-color" content="#8c7bce"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@libellux1"><meta name="twitter:title" content="Libellux"><meta name="twitter:description" content="Libellux: Up & Running provides documentation on how-to install open-source software from source. The focus is Zero Trust Network to enhance the security for existing applications or install tools to detect and prevent threats."><meta name="twitter:image" content="https://www.libellux.com/img/icons/4096x4096.png"><meta name="twitter:width" content="4096"><meta name="twitter:height" content="4096"><meta property="og:locale" content="en_US"><meta property="og:type" content="website"><meta property="og:title" content="Libellux"><meta property="og:description" content="Libellux: Up & Running provides documentation on how-to install open-source software from source. The focus is Zero Trust Network to enhance the security for existing applications or install tools to detect and prevent threats."><meta property="og:url" content="https://www.libellux.com"><meta property="og:site_name" content="Libellux"><meta property="og:publisher" content="https://www.facebook.com/libellux1"><meta property="og:author" content="https://www.facebook.com/fredrik.hilmersson.1"><meta property="og:image" content="https://www.libellux.com/img/icons/1200x627.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link rel="icon" href="https://www.libellux.com/img/icons/72x72.png"><meta name="msapplication-TileImage" content="https://www.libellux.com/img/icons/144x144.png"><link rel="apple-touch-icon" sizes="48x48" href="https://www.libellux.com/img/icons/48x48.png"><link rel="apple-touch-icon" sizes="72x72" href="https://www.libellux.com/img/icons/72x72.png"><link rel="apple-touch-icon" sizes="144x144" href="https://www.libellux.com/img/icons/144x144.png"><link rel="apple-touch-icon" sizes="192x192" href="https://www.libellux.com/img/icons/192x192.png"><link rel="apple-touch-icon" sizes="256x256" href="https://www.libellux.com/img/icons/256x256.png"><link rel="apple-touch-icon" sizes="384x384" href="https://www.libellux.com/img/icons/384x384.png"><link rel="apple-touch-icon" sizes="512x512" href="https://www.libellux.com/img/icons/512x512.png"><link rel="apple-touch-icon" sizes="1200x627" href="https://www.libellux.com/img/icons/1200x627.png"><title>OSSEC Host Intrusion Detection System | Libellux</title><meta name="description" content="OSSEC is a full platform to monitor and control your systems. It mixes all aspects of HIDS (host-based intrusion detection), log monitoring and SIM/SIEM together in a simple, powerful and open source solution.">
    <link rel="preload" href="/assets/style-BdrCfhT3.css" as="style"><link rel="stylesheet" href="/assets/style-BdrCfhT3.css">
    <link rel="modulepreload" href="/assets/app-sJdlpeZX.js"><link rel="modulepreload" href="/assets/index.html-DSOAOHWR.js">
    <link rel="prefetch" href="/assets/index.html-YNKcKpEh.js" as="script"><link rel="prefetch" href="/assets/privacy-policy.html-Dk6B4KPv.js" as="script"><link rel="prefetch" href="/assets/index.html-D8pIL6Ut.js" as="script"><link rel="prefetch" href="/assets/index.html-Buvjo_Tb.js" as="script"><link rel="prefetch" href="/assets/index.html-D1inPVL7.js" as="script"><link rel="prefetch" href="/assets/index.html-DF0R1A2q.js" as="script"><link rel="prefetch" href="/assets/index.html-C0CavkHZ.js" as="script"><link rel="prefetch" href="/assets/index.html-mTHi9Hm-.js" as="script"><link rel="prefetch" href="/assets/index.html-MO-zDUL_.js" as="script"><link rel="prefetch" href="/assets/index.html-CqfCttmL.js" as="script"><link rel="prefetch" href="/assets/index.html-CvG9TNzD.js" as="script"><link rel="prefetch" href="/assets/404.html-DjV8MXx5.js" as="script"><link rel="prefetch" href="/assets/style-l0sNRNKZ.js" as="script"><link rel="prefetch" href="/assets/docsearch-l0sNRNKZ.js" as="script"><link rel="prefetch" href="/assets/index-DiZEX-Ml.js" as="script"><link rel="prefetch" href="/assets/index-DTEEl-sV.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><img class="logo" src="/img/icons/72x72.png" alt="Libellux"><span class="site-name can-hide" aria-hidden="true">Libellux</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide" aria-label="site navigation"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Libellux: Up &amp; Running"><span class="title">Libellux: Up &amp; Running</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Libellux: Up &amp; Running"><span class="title">Libellux: Up &amp; Running</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Libellux: Up &amp; Running</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Zero Trust Network</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/wireguard/" aria-label="WireGuard Secure VPN Tunnel"><!--[--><!--]--> WireGuard Secure VPN Tunnel <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/privacyidea/" aria-label="Two-factor authentication w/ privacyIDEA and YubiKey"><!--[--><!--]--> Two-factor authentication w/ privacyIDEA and YubiKey <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Intrusion Detection and Prevention</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link route-link-active" href="/ossec/" aria-label="OSSEC Host Intrusion Detection"><!--[--><!--]--> OSSEC Host Intrusion Detection <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/openvas/" aria-label="Greenbone Vulnerability Manager"><!--[--><!--]--> Greenbone Vulnerability Manager <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/clamav/" aria-label="ClamAV Antivirus Server"><!--[--><!--]--> ClamAV Antivirus Server <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/psad/" aria-label="PSAD Intrusion Detection"><!--[--><!--]--> PSAD Intrusion Detection <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Monitoring and Management</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/ansible/" aria-label="Ansible"><!--[--><!--]--> Ansible <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/mmonit/" aria-label="M/Monit System Monitoring"><!--[--><!--]--> M/Monit System Monitoring <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/rsyslog/" aria-label=" Rsyslog Syslog Processing"><!--[--><!--]-->  Rsyslog Syslog Processing <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://status.libellux.com/" rel="noopener noreferrer" target="_blank" aria-label="Status"><!--[--><!--]--> Status <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/libellux/Libellux-Up-and-Running" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!--[--><div id="docsearch-container" style="display:none;"></div><div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items" aria-label="site navigation"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Libellux: Up &amp; Running"><span class="title">Libellux: Up &amp; Running</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Libellux: Up &amp; Running"><span class="title">Libellux: Up &amp; Running</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Libellux: Up &amp; Running</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Zero Trust Network</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/wireguard/" aria-label="WireGuard Secure VPN Tunnel"><!--[--><!--]--> WireGuard Secure VPN Tunnel <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/privacyidea/" aria-label="Two-factor authentication w/ privacyIDEA and YubiKey"><!--[--><!--]--> Two-factor authentication w/ privacyIDEA and YubiKey <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Intrusion Detection and Prevention</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link route-link-active" href="/ossec/" aria-label="OSSEC Host Intrusion Detection"><!--[--><!--]--> OSSEC Host Intrusion Detection <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/openvas/" aria-label="Greenbone Vulnerability Manager"><!--[--><!--]--> Greenbone Vulnerability Manager <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/clamav/" aria-label="ClamAV Antivirus Server"><!--[--><!--]--> ClamAV Antivirus Server <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/psad/" aria-label="PSAD Intrusion Detection"><!--[--><!--]--> PSAD Intrusion Detection <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Monitoring and Management</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a class="route-link" href="/ansible/" aria-label="Ansible"><!--[--><!--]--> Ansible <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/mmonit/" aria-label="M/Monit System Monitoring"><!--[--><!--]--> M/Monit System Monitoring <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a class="route-link" href="/rsyslog/" aria-label=" Rsyslog Syslog Processing"><!--[--><!--]-->  Rsyslog Syslog Processing <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://status.libellux.com/" rel="noopener noreferrer" target="_blank" aria-label="Status"><!--[--><!--]--> Status <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/libellux/Libellux-Up-and-Running" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">Libellux: Up &amp; Running <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/" aria-label="Introduction"><!--[--><!--]--> Introduction <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">Zero Trust Network <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/wireguard/" aria-label="WireGuard Secure VPN Tunnel"><!--[--><!--]--> WireGuard Secure VPN Tunnel <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/privacyidea/" aria-label="Two-factor authentication w/ privacyIDEA and YubiKey"><!--[--><!--]--> Two-factor authentication w/ privacyIDEA and YubiKey <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading active">Intrusion Detection and Prevention <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link route-link-active sidebar-item active" href="/ossec/" aria-label="OSSEC Host Intrusion Detection"><!--[--><!--]--> OSSEC Host Intrusion Detection <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/#configuration-files" aria-label="Configuration files"><!--[--><!--]--> Configuration files <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#prerequisites" aria-label="Prerequisites"><!--[--><!--]--> Prerequisites <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#server-installation" aria-label="Server installation"><!--[--><!--]--> Server installation <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/#verify-file-integrity" aria-label="Verify file integrity"><!--[--><!--]--> Verify file integrity <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#install-ossec-with-pcre2-support" aria-label="Install OSSEC with PCRE2 support"><!--[--><!--]--> Install OSSEC with PCRE2 support <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/#server-configuration" aria-label="Server configuration"><!--[--><!--]--> Server configuration <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/#allow-list" aria-label="Allow list"><!--[--><!--]--> Allow list <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#remote-syslog" aria-label="Remote syslog"><!--[--><!--]--> Remote syslog <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#repeated-offenders" aria-label="Repeated offenders"><!--[--><!--]--> Repeated offenders <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#psad-rules" aria-label="PSAD rules"><!--[--><!--]--> PSAD rules <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/#agent-installation" aria-label="Agent installation"><!--[--><!--]--> Agent installation <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/#verify-file-integrity-1" aria-label="Verify file integrity"><!--[--><!--]--> Verify file integrity <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#install-ossec-with-pcre2-support-1" aria-label="Install OSSEC with PCRE2 support"><!--[--><!--]--> Install OSSEC with PCRE2 support <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/#agent-configuration" aria-label="Agent configuration"><!--[--><!--]--> Agent configuration <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#manage-agents" aria-label="Manage agents"><!--[--><!--]--> Manage agents <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#windows-agent" aria-label="Windows agent"><!--[--><!--]--> Windows agent <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#agentless-monitoring" aria-label="Agentless monitoring"><!--[--><!--]--> Agentless monitoring <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/#vmware-esxi" aria-label="VMware ESXi"><!--[--><!--]--> VMware ESXi <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#enabling-agentless-monitoring" aria-label="Enabling agentless monitoring"><!--[--><!--]--> Enabling agentless monitoring <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#configure-agentless-monitoring" aria-label="Configure agentless monitoring"><!--[--><!--]--> Configure agentless monitoring <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/#firewall-settings" aria-label="Firewall settings"><!--[--><!--]--> Firewall settings <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#logtail" aria-label="Logtail"><!--[--><!--]--> Logtail <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#slack-integration" aria-label="Slack integration"><!--[--><!--]--> Slack integration <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#cloudflare-integration" aria-label="Cloudflare integration"><!--[--><!--]--> Cloudflare integration <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#monitoring" aria-label="Monitoring"><!--[--><!--]--> Monitoring <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/#monitor-failed-m-monit-login-attempts-with-ossec" aria-label="Monitor failed M/Monit login attempts with OSSEC"><!--[--><!--]--> Monitor failed M/Monit login attempts with OSSEC <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/#upgrading" aria-label="Upgrading"><!--[--><!--]--> Upgrading <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/#upgrade-to-ossec-3-3-0" aria-label="Upgrade to OSSEC 3.3.0"><!--[--><!--]--> Upgrade to OSSEC 3.3.0 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/#custom-rules" aria-label="Custom rules"><!--[--><!--]--> Custom rules <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/#ignore-snap-loop-devices" aria-label="Ignore snap loop devices"><!--[--><!--]--> Ignore snap loop devices <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#monitor-failed-m-monit-authentication" aria-label="Monitor failed M/Monit authentication"><!--[--><!--]--> Monitor failed M/Monit authentication <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#mute-useless-systemd-resolved-message" aria-label="Mute useless systemd-resolved message"><!--[--><!--]--> Mute useless systemd-resolved message <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#alert-on-fail2ban-action" aria-label="Alert on fail2ban action"><!--[--><!--]--> Alert on fail2ban action <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/#command-line" aria-label="Command-line"><!--[--><!--]--> Command-line <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#troubleshooting" aria-label="Troubleshooting"><!--[--><!--]--> Troubleshooting <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/#duplicate-counter-error" aria-label="Duplicate counter error"><!--[--><!--]--> Duplicate counter error <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#build-essential" aria-label="build-essential"><!--[--><!--]--> build-essential <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#libevent-dev" aria-label="libevent-dev"><!--[--><!--]--> libevent-dev <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#pcre2-libpcre2-dev" aria-label="pcre2 &amp; libpcre2-dev"><!--[--><!--]--> pcre2 &amp; libpcre2-dev <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#zlib1g-dev" aria-label="zlib1g-dev"><!--[--><!--]--> zlib1g-dev <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#libssl-dev" aria-label="libssl-dev"><!--[--><!--]--> libssl-dev <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#ignore-snap-partition-state" aria-label="Ignore snap partition state"><!--[--><!--]--> Ignore snap partition state <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#server-returned-error-nxdomain" aria-label="Server returned error NXDOMAIN"><!--[--><!--]--> Server returned error NXDOMAIN <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#cannot-unlink-queue-rids-sender" aria-label="Cannot unlink /queue/rids/sender"><!--[--><!--]--> Cannot unlink /queue/rids/sender <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/#enterprise-solutions" aria-label="Enterprise solutions"><!--[--><!--]--> Enterprise solutions <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/#atomic-enterprise-ossec" aria-label="Atomic Enterprise OSSEC"><!--[--><!--]--> Atomic Enterprise OSSEC <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/openvas/" aria-label="Greenbone Vulnerability Manager"><!--[--><!--]--> Greenbone Vulnerability Manager <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/clamav/" aria-label="ClamAV Antivirus Server"><!--[--><!--]--> ClamAV Antivirus Server <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/psad/" aria-label="PSAD Intrusion Detection"><!--[--><!--]--> PSAD Intrusion Detection <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading">Monitoring and Management <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/ansible/" aria-label="Ansible"><!--[--><!--]--> Ansible <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/mmonit/" aria-label="M/Monit System Monitoring"><!--[--><!--]--> M/Monit System Monitoring <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/rsyslog/" aria-label="Rsyslog Syslog Processing"><!--[--><!--]--> Rsyslog Syslog Processing <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="ossec-host-intrusion-detection-system" tabindex="-1"><a class="header-anchor" href="#ossec-host-intrusion-detection-system"><span>OSSEC Host Intrusion Detection System <span class="badge tip" style=""><!--[-->Rev 3<!--]--></span></span></a></h1><p>OSSEC is a full platform to monitor and control your systems. It mixes all aspects of HIDS (host-based intrusion detection), log monitoring and SIM/SIEM together in a simple, powerful and open source solution.</p><p><a href="https://www.ossec.net/" target="_blank" rel="noopener noreferrer">OSSEC website<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> <a href="https://github.com/ossec/ossec-hids" target="_blank" rel="noopener noreferrer">GitHub<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>Setup and configuration have been tested on the following operating systems:</p><ul><li>Ubuntu- 16.04, 18.04, 20.04 (Focal Fossa), 22.04 (Jammy Jellyfish) Rocky 8.4 (Green Obsidian), Windows Server 2019, Windows 10</li><li>OSSEC- 2.9.0 -&gt; 3.6.0, 3.7.0</li></ul><p><a href="https://fundof.me/libellux"><img src="https://img.shields.io/badge/fundof-libellux-green" alt="fundof"></a></p><h2 id="configuration-files" tabindex="-1"><a class="header-anchor" href="#configuration-files"><span>Configuration files</span></a></h2><ul><li><a href="https://github.com/libellux/Libellux-Up-and-Running/blob/master/docs/ossec/config/ossec.conf" target="_blank" rel="noopener noreferrer">ossec.conf (server)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://github.com/libellux/Libellux-Up-and-Running/blob/master/docs/ossec/config/ossec.conf_agent" target="_blank" rel="noopener noreferrer">ossec.conf (agent)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://github.com/libellux/Libellux-Up-and-Running/blob/master/docs/ossec/config/ossec.conf_agent_win" target="_blank" rel="noopener noreferrer">ossec.conf (Windows agent)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://github.com/libellux/Libellux-Up-and-Running/blob/master/docs/ossec/config/local_rules.xml" target="_blank" rel="noopener noreferrer">local_rules.xml<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>The lines in the &quot;scripts&quot; below has been used for testing and successfully configured OSSEC 3.6.0 and 3.7.0. You may use the testing guide to install OSSEC or follow our detailed step-by-step tutorial below to install OSSEC 3.7.0 (Ubuntu 22.04) or 3.6.0 (Rocky 8.4).</p></div><ul><li><a href="https://github.com/libellux/Libellux-Up-and-Running/blob/master/docs/ossec/config/ubuntu_22.04.sh" target="_blank" rel="noopener noreferrer">Ubuntu 22.04<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://github.com/libellux/Libellux-Up-and-Running/blob/master/docs/ossec/config/ubuntu_20.04.sh" target="_blank" rel="noopener noreferrer">Ubuntu 20.04<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://github.com/libellux/Libellux-Up-and-Running/blob/master/docs/ossec/config/rocky_8.4.sh" target="_blank" rel="noopener noreferrer">Rocky 8.4<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h2 id="prerequisites" tabindex="-1"><a class="header-anchor" href="#prerequisites"><span>Prerequisites</span></a></h2><p>For more detailed information on OSSEC installation requirements read the official <a href="https://www.ossec.net/docs/docs/manual/installation/installation-requirements.html" target="_blank" rel="noopener noreferrer">documentation<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><p><strong>Ubuntu 22.04:</strong></p><ul><li><code>build-essential</code></li><li><code>libssl-dev</code></li><li><code>libpcre2-dev</code></li><li><code>zlib1g-dev</code></li><li><code>libevent-dev</code></li><li><code>libsystemd-dev</code></li><li><code>jq</code> (optional)</li></ul><p><strong>Rocky 8.4:</strong></p><ul><li><code>make</code></li><li><code>gcc</code></li><li><code>libevent-devel</code></li><li><code>openssl-devel</code></li><li><code>zlib-devel</code></li><li><code>pcre2-devel</code></li><li><code>jq</code> (optional)</li></ul><h2 id="server-installation" tabindex="-1"><a class="header-anchor" href="#server-installation"><span>Server installation</span></a></h2><p>To install <strong>OSSEC 3.7.0</strong> on <strong>Ubuntu 22.04</strong> (Jammy Jellyfish) or <strong>OSSEC 3.6.0</strong> on <strong>Rocky 8.4</strong> (Green Obsidian) first install its prerequisites.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> update <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token parameter variable">-y</span> upgrade <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> build-essential <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> zlib1g-dev libpcre2-dev libevent-dev libssl-dev libsystemd-dev jq</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> yum <span class="token parameter variable">-y</span> update <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> yum <span class="token parameter variable">-y</span> upgrade <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> yum <span class="token function">install</span> <span class="token parameter variable">-y</span> <span class="token function">make</span> gcc <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> yum <span class="token function">install</span> <span class="token parameter variable">-y</span> libevent-devel openssl-devel zlib-devel pcre2-devel jq</span></span>
</code></pre></div><!--]--></div><!--]--></div><h3 id="verify-file-integrity" tabindex="-1"><a class="header-anchor" href="#verify-file-integrity"><span>Verify file integrity</span></a></h3><p>Before you download the <a href="https://github.com/ossec/ossec-hids/releases" target="_blank" rel="noopener noreferrer">latest stable version<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> from ossec-hids GitHub (3.7.0). Fetch and import the corresponding certificate and key file (.asc) from <a href="http://www.ossec.net/files/OSSEC-ARCHIVE-KEY.asc" target="_blank" rel="noopener noreferrer">ossec.net<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> and the ossec-hids <a href="https://github.com/ossec/ossec-hids/releases" target="_blank" rel="noopener noreferrer">repository<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">wget</span> http://www.ossec.net/files/OSSEC-ARCHIVE-KEY.asc <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">wget</span> https://github.com/ossec/ossec-hids/releases/download/3.7.0/ossec-hids-3.7.0.tar.gz.asc <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
gpg <span class="token parameter variable">--import</span> OSSEC-ARCHIVE-KEY.asc</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">wget</span> http://www.ossec.net/files/OSSEC-ARCHIVE-KEY.asc <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">wget</span> https://github.com/ossec/ossec-hids/releases/download/3.6.0/ossec-hids-3.6.0.tar.gz.asc <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
gpg <span class="token parameter variable">--import</span> OSSEC-ARCHIVE-KEY.asc</span></span>
</code></pre></div><!--]--></div><!--]--></div><p>The output should show the following.</p><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">gpg: key EE1B0E6B2D8387B7: public key &quot;Scott R. Shinn &lt;scott@atomicorp.com&gt;&quot; imorted
gpg: Total number processed: 1
gpg:               imported: 1
</span></code></pre></div><p>Next download the <a href="https://github.com/ossec/ossec-hids/releases" target="_blank" rel="noopener noreferrer">latest stable version<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> of OSSEC (3.7.0) and verify the file integrity.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">wget</span> https://github.com/ossec/ossec-hids/archive/3.7.0.tar.gz <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
gpg <span class="token parameter variable">--verify</span> ossec-hids-3.7.0.tar.gz.asc <span class="token number">3.7</span>.0.tar.gz</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">wget</span> https://github.com/ossec/ossec-hids/archive/3.6.0.tar.gz <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
gpg <span class="token parameter variable">--verify</span> ossec-hids-3.6.0.tar.gz.asc <span class="token number">3.6</span>.0.tar.gz</span></span>
</code></pre></div><!--]--></div><!--]--></div><p>The signature output is supposed to look as following.</p><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">gpg: Signature made Fri 14 Feb 2020 09:04:32 PM UTC
gpg:                using RSA key B50FB1947A0AE31145D05FADEE1B0E6B2D8387B7
gpg: Good signature from &quot;Scott R. Shinn &lt;scott@atomicorp.com&gt;&quot; [unknown]
gpg: WARNING: This key is not certified with a trusted signature!
gpg:          There is no indication that the signature belongs to the owner.
Primary key fingerprint: B50F B194 7A0A E311 45D0  5FAD EE1B 0E6B 2D83 87B7
</span></code></pre><div class="highlight-lines"><br><br><div class="highlight-line">Â </div><br><br><br></div></div><h3 id="install-ossec-with-pcre2-support" tabindex="-1"><a class="header-anchor" href="#install-ossec-with-pcre2-support"><span>Install OSSEC with PCRE2 support</span></a></h3><p>Extract and run the installation script. If receiving build errors, make sure that you have installed all the required dependencies or check the <a href="#troubleshooting">troubleshooting section</a> for details.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> <span class="token number">3.7</span>.0.tar.gz <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> ossec-hids-3.7.0/ <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">wget</span> https://github.com/PCRE2Project/pcre2/releases/download/pcre2-10.40/pcre2-10.40.tar.gz <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> pcre2-10.40.tar.gz <span class="token parameter variable">-C</span> src/external/ <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> <span class="token assign-left variable">PCRE2_SYSTEM</span><span class="token operator">=</span>yes ./install.sh</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> <span class="token number">3.6</span>.0.tar.gz <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> ossec-hids-3.6.0/ <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">wget</span> https://ftp.pcre.org/pub/pcre/pcre2-10.32.tar.gz <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> pcre2-10.32.tar.gz <span class="token parameter variable">-C</span> src/external/ <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> <span class="token assign-left variable">PCRE2_SYSTEM</span><span class="token operator">=</span>yes ./install.sh</span></span>
</code></pre></div><!--]--></div><!--]--></div><p>Select preferred language and server installation. Adjust options to fit your requirements.</p><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">(en/br/cn/de/el/es/fr/hu/it/jp/nl/pl/ru/sr/tr) [en]:
What kind of installation do you want (server, agent, local, hybrid or help)? server
Choose where to install the OSSEC HIDS [/var/ossec/]:
Do you want e-mail notification? (y/n) [y]: n
Do you want to run the integrity check daemon? (y/n) [y]: y
Do you want to run the rootkit detection engine? (y/n) [y]: y
Do you want to enable active response? (y/n) [y]: y
Do you want to enable the firewall-drop response? (y/n) [y]: y
Do you want to add more IPs to the white list? (y/n)? [n]: n
Do you want to enable remote syslog (port 514 udp)? (y/n) [y]: y
--- Press ENTER to finish (maybe more information below). ---
</span></code></pre></div><details class="custom-container details"><summary>Click to view full installation process</summary><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output"> OSSEC HIDS v3.7.0 Installation Script - http://www.ossec.net

 You are about to start the installation process of the OSSEC HIDS.
 You must have a C compiler pre-installed in your system.

  - System: Linux libellux 5.4.0-84-generic
  - User: root
  - Host: libellux


  -- Press ENTER to continue or Ctrl-C to abort. --


1- What kind of installation do you want (server, agent, local, hybrid or help)? server
 
  - Server installation chosen.

2- Setting up the installation environment.

 - Choose where to install the OSSEC HIDS [/var/ossec/]:

    - Installation will be made at  /var/ossec .

3- Configure the OSSEC HIDS.

  3.1- Do you want e-mail notification? (y/n) [y]: n

   --- Email notification disabled.

  3.2- Do you want to run the integrity check daemon? (y/n) [y]: y

   - Running syscheck (integrity check daemon).

  3.3- Do you want to run the rootkit detection engine? (y/n) [y]: y

   - Running rootcheck (rootkit detection).

  3.4- Active response allows you to execute a specific
       command based on the events received. For example,
       you can block an IP address or disable access for
       a specific user.
       More information at:
       http://www.ossec.net/en/manual.html#active-response
  
   - Do you want to enable active response? (y/n) [y]: y

     - Active response enabled.

   - By default, we can enable the host-deny and the
     firewall-drop responses. The first one will add
     a host to the /etc/hosts.deny and the second one
     will block the host on iptables (if linux) or on
     ipfilter (if Solaris, FreeBSD or NetBSD).
   - They can be used to stop SSHD brute force scans,
     portscans and some other forms of attacks. You can
     also add them to block on snort events, for example.

   - Do you want to enable the firewall-drop response? (y/n) [y]: y

     - firewall-drop enabled (local) for levels &gt;= 6

   -
      - 127.0.0.53

   - Do you want to add more IPs to the white list? (y/n)? [n]: n

  3.5- Do you want to enable remote syslog (port 514 udp)? (y/n) [y]: y

   - Remote syslog enabled.

  3.6- Setting the configuration to analyze the following logs:
    -- /var/log/auth.log
    -- /var/log/syslog
    -- /var/log/dpkg.log

 - If you want to monitor any other file, just change
   the ossec.conf and add a new localfile entry.
   Any questions about the configuration can be answered
   by visiting us online at http://www.ossec.net .


--- Press ENTER to finish ---
</span></code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">Â </div><br><br><br><br><br><div class="highlight-line">Â </div><br><br><br><br><br><div class="highlight-line">Â </div><br><br><br><div class="highlight-line">Â </div><br><br><br><div class="highlight-line">Â </div><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">Â </div><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">Â </div><br><br><br><br><br><br><div class="highlight-line">Â </div><br><div class="highlight-line">Â </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div></div></details><h2 id="server-configuration" tabindex="-1"><a class="header-anchor" href="#server-configuration"><span>Server configuration</span></a></h2><p>The server configuration section will go through the more basic settings. To dig deeper read the later chapters on how-to integrate e.g. <a href="">Logtail</a> using <a href="">Vector</a> (log forwarding), Slack and block IP addresses through Cloudflare.</p><h3 id="allow-list" tabindex="-1"><a class="header-anchor" href="#allow-list"><span>Allow list</span></a></h3><p>In the global section of the OSSEC configuration file add the IP addresses of the client(s) and services (e.g. <a class="route-link" href="/openvas/">Greenbone Vulnerability Manager</a>) to the allow list.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/etc/ossec.conf</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/etc/ossec.conf</span></span>
</code></pre></div><!--]--></div><!--]--></div><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>global</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>allow_list</span><span class="token punctuation">&gt;</span></span>127.0.0.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>allow_list</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>allow_list</span><span class="token punctuation">&gt;</span></span>::1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>allow_list</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>allow_list</span><span class="token punctuation">&gt;</span></span>localhost.localdomain<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>allow_list</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>allow_list</span><span class="token punctuation">&gt;</span></span>127.0.0.53<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>allow_list</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>allow_list</span><span class="token punctuation">&gt;</span></span>192.168.0.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>allow_list</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- OSSEC client --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>global</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><div class="highlight-line">Â </div><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="remote-syslog" tabindex="-1"><a class="header-anchor" href="#remote-syslog"><span>Remote syslog</span></a></h3><p>To enable the function to harvest syslogs from our OSSEC agents we&#39;ll need to establish that our remote client connection is secure and allow it. Add the client IP address within the remote section.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/etc/ossec.conf</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/etc/ossec.conf</span></span>
</code></pre></div><!--]--></div><!--]--></div><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>remote</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>connection</span><span class="token punctuation">&gt;</span></span>secure<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>connection</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>allowed-ips</span><span class="token punctuation">&gt;</span></span>192.168.0.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>allowed-ips</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- OSSEC client --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>remote</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="highlight-lines"><br><br><div class="highlight-line">Â </div><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="repeated-offenders" tabindex="-1"><a class="header-anchor" href="#repeated-offenders"><span>Repeated offenders</span></a></h3><p>The first time an IP is blocked it will be put on timeout for the default 600 seconds. If the IP is blocked again it will follow the defined repeated offenders list. To enable repeated offenders, add the entry in the active response config.</p><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>Make sure that you add the repeated offenders entry at the top of the active response section in the ossec.conf file.</p></div><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/etc/ossec.conf</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/etc/ossec.conf</span></span>
</code></pre></div><!--]--></div><!--]--></div><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token comment">&lt;!-- Active Response Config --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>active-response</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- Specify a comma seperated list of timeouts per
    - re-incidence (in minutes).
    --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>repeated_offenders</span><span class="token punctuation">&gt;</span></span>30,60,120,240,480<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>repeated_offenders</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>active-response</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><div class="highlight-line">Â </div><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Save the config and restart OSSEC to confirm that the repeated offenders been added.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> /var/ossec/bin/ossec-control restart</span></span>
<span class="token output">Starting OSSEC HIDS v3.7.0...
2022/05/22 17:19:24 ossec-execd: INFO: Adding offenders timeout: 30 (for #1)
2022/05/22 17:19:24 ossec-execd: INFO: Adding offenders timeout: 60 (for #2)
2022/05/22 17:19:24 ossec-execd: INFO: Adding offenders timeout: 120 (for #3)
2022/05/22 17:19:24 ossec-execd: INFO: Adding offenders timeout: 240 (for #4)
2022/05/22 17:19:24 ossec-execd: INFO: Adding offenders timeout: 480 (for #5)
Started ossec-execd...
Started ossec-analysisd...
Started ossec-logcollector...
Started ossec-remoted...
Started ossec-syscheckd...
Started ossec-monitord...
Completed.
</span></code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> /var/ossec/bin/ossec-control restart</span></span>
<span class="token output">Starting OSSEC HIDS v3.6.0...
2021/09/27 17:19:24 ossec-execd: INFO: Adding offenders timeout: 30 (for #1)
2021/09/27 17:19:24 ossec-execd: INFO: Adding offenders timeout: 60 (for #2)
2021/09/27 17:19:24 ossec-execd: INFO: Adding offenders timeout: 120 (for #3)
2021/09/27 17:19:24 ossec-execd: INFO: Adding offenders timeout: 240 (for #4)
2021/09/27 17:19:24 ossec-execd: INFO: Adding offenders timeout: 480 (for #5)
Started ossec-execd...
Started ossec-analysisd...
Started ossec-logcollector...
Started ossec-remoted...
Started ossec-syscheckd...
Started ossec-monitord...
Completed.
</span></code></pre></div><!--]--></div><!--]--></div><h3 id="psad-rules" tabindex="-1"><a class="header-anchor" href="#psad-rules"><span>PSAD rules</span></a></h3><p>If <a class="route-link" href="/psad/">PSAD Intrusion Detection</a> is to be used, make sure to include the PSAD ruleset in the configuration file (<code>/var/ossec/etc/ossec.conf</code>) as it&#39;s not defined by default.</p><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>Make sure that you add the the psad rules include before the local rules.</p></div><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">&gt;</span></span>psad_rules.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">&gt;</span></span>local_rules.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rules</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="highlight-lines"><div class="highlight-line">Â </div><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="agent-installation" tabindex="-1"><a class="header-anchor" href="#agent-installation"><span>Agent installation</span></a></h2><p>To install <strong>OSSEC 3.6.0</strong> as an <strong>agent</strong> on <strong>Ubuntu 20.04</strong> (Focal Fossa) or <strong>Rocky 8.4</strong> (Green Obsidian) download its prerequisites.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">client@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> update <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token parameter variable">-y</span> upgrade <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> build-essential <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> zlib1g-dev libpcre2-dev libevent-dev libssl-dev</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">client@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> yum <span class="token parameter variable">-y</span> update <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> yum <span class="token parameter variable">-y</span> upgrade <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> yum <span class="token function">install</span> <span class="token parameter variable">-y</span> <span class="token function">make</span> gcc <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> yum <span class="token function">install</span> <span class="token parameter variable">-y</span> libevent-devel openssl-devel zlib-devel pcre2-devel</span></span>
</code></pre></div><!--]--></div><!--]--></div><h3 id="verify-file-integrity-1" tabindex="-1"><a class="header-anchor" href="#verify-file-integrity-1"><span>Verify file integrity</span></a></h3><p>Before you download the <a href="https://github.com/ossec/ossec-hids/releases" target="_blank" rel="noopener noreferrer">latest stable version<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> from ossec-hids GitHub (3.6.0). Fetch and import the corresponding certificate and key file (.asc) from <a href="http://www.ossec.net/files/OSSEC-ARCHIVE-KEY.asc" target="_blank" rel="noopener noreferrer">ossec.net<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> and the ossec-hids <a href="https://github.com/ossec/ossec-hids/releases" target="_blank" rel="noopener noreferrer">repository<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">client@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">wget</span> http://www.ossec.net/files/OSSEC-ARCHIVE-KEY.asc <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">wget</span> https://github.com/ossec/ossec-hids/releases/download/3.6.0/ossec-hids-3.6.0.tar.gz.asc <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
gpg <span class="token parameter variable">--import</span> OSSEC-ARCHIVE-KEY.asc</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">client@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">wget</span> http://www.ossec.net/files/OSSEC-ARCHIVE-KEY.asc <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">wget</span> https://github.com/ossec/ossec-hids/releases/download/3.6.0/ossec-hids-3.6.0.tar.gz.asc <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
gpg <span class="token parameter variable">--import</span> OSSEC-ARCHIVE-KEY.asc</span></span>
</code></pre></div><!--]--></div><!--]--></div><p>The output should show the following.</p><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">gpg: key EE1B0E6B2D8387B7: public key &quot;Scott R. Shinn &lt;scott@atomicorp.com&gt;&quot; imported
gpg: Total number processed: 1
gpg:               imported: 1
</span></code></pre></div><p>Next download the <a href="https://github.com/ossec/ossec-hids/releases" target="_blank" rel="noopener noreferrer">latest stable version<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> of OSSEC (3.6.0) and verify the file integrity.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">client@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">wget</span> https://github.com/ossec/ossec-hids/archive/3.6.0.tar.gz <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
gpg <span class="token parameter variable">--verify</span> ossec-hids-3.6.0.tar.gz.asc <span class="token number">3.6</span>.0.tar.gz</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">client@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">wget</span> https://github.com/ossec/ossec-hids/archive/3.6.0.tar.gz <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
gpg <span class="token parameter variable">--verify</span> ossec-hids-3.6.0.tar.gz.asc <span class="token number">3.6</span>.0.tar.gz</span></span>
</code></pre></div><!--]--></div><!--]--></div><p>The signature output is supposed to look as followed.</p><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">gpg: Signature made Fri 14 Feb 2020 09:04:32 PM UTC
gpg:                using RSA key B50FB1947A0AE31145D05FADEE1B0E6B2D8387B7
gpg: Good signature from &quot;Scott R. Shinn &lt;scott@atomicorp.com&gt;&quot; [unknown]
gpg: WARNING: This key is not certified with a trusted signature!
gpg:          There is no indication that the signature belongs to the owner.
Primary key fingerprint: B50F B194 7A0A E311 45D0  5FAD EE1B 0E6B 2D83 87B7
</span></code></pre><div class="highlight-lines"><br><br><div class="highlight-line">Â </div><br><br><br></div></div><h3 id="install-ossec-with-pcre2-support-1" tabindex="-1"><a class="header-anchor" href="#install-ossec-with-pcre2-support-1"><span>Install OSSEC with PCRE2 support</span></a></h3><p>Extract and run the installation script.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">client@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> <span class="token number">3.6</span>.0.tar.gz <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> ossec-hids-3.6.0/ <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">wget</span> https://ftp.pcre.org/pub/pcre/pcre2-10.32.tar.gz <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> pcre2-10.32.tar.gz <span class="token parameter variable">-C</span> src/external/ <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> <span class="token assign-left variable">PCRE2_SYSTEM</span><span class="token operator">=</span>yes ./install.sh</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">client@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> <span class="token number">3.6</span>.0.tar.gz <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> ossec-hids-3.6.0/ <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">wget</span> https://ftp.pcre.org/pub/pcre/pcre2-10.32.tar.gz <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> pcre2-10.32.tar.gz <span class="token parameter variable">-C</span> src/external/ <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>
<span class="token function">sudo</span> <span class="token assign-left variable">PCRE2_SYSTEM</span><span class="token operator">=</span>yes ./install.sh</span></span>
</code></pre></div><!--]--></div><!--]--></div><p>Select agent installation along with preferred actions and make sure that you define the IP address of your OSSEC server.</p><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">(en/br/cn/de/el/es/fr/hu/it/jp/nl/pl/ru/sr/tr) [en]:
What kind of installation do you want (server, agent, local, hybrid or help)? agent
Choose where to install the OSSEC HIDS [/var/ossec/]:
What&#39;s the IP Address or hostname of the OSSEC HIDS server?: 192.168.0.1
Do you want to run the integrity check daemon? (y/n) [y]: y
Do you want to run the rootkit detection engine? (y/n) [y]: y
Do you want to enable active response? (y/n) [y]: y
--- Press ENTER to finish (maybe more information below). ---
</span></code></pre><div class="highlight-lines"><br><div class="highlight-line">Â </div><br><div class="highlight-line">Â </div><br><br><br><br></div></div><details class="custom-container details"><summary>Click to view full installation process</summary><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output"> OSSEC HIDS v3.6.0 Installation Script - http://www.ossec.net

 You are about to start the installation process of the OSSEC HIDS.
 You must have a C compiler pre-installed in your system.

  - System: Linux libellux 5.4.0-84-generic
  - User: root
  - Host: libellux


  -- Press ENTER to continue or Ctrl-C to abort. --


1- What kind of installation do you want (server, agent, local, hybrid or help)? agent

  - Agent(client) installation chosen.

2- Setting up the installation environment.

 - Choose where to install the OSSEC HIDS [/var/ossec]:

    - Installation will be made at  /var/ossec .

3- Configuring the OSSEC HIDS.

  3.1- What&#39;s the IP Address or hostname of the OSSEC HIDS server?: 192.168.0.1

   - Adding Server IP 192.168.0.1

  3.2- Do you want to run the integrity check daemon? (y/n) [y]: y

   - Running syscheck (integrity check daemon).

  3.3- Do you want to run the rootkit detection engine? (y/n) [y]: y

   - Running rootcheck (rootkit detection).

  3.4 - Do you want to enable active response? (y/n) [y]: y


  3.5- Setting the configuration to analyze the following logs:
    -- /var/log/auth.log
    -- /var/log/syslog
    -- /var/log/dpkg.log

 - If you want to monitor any other file, just change
   the ossec.conf and add a new localfile entry.
   Any questions about the configuration can be answered
   by visiting us online at http://www.ossec.net .


   --- Press ENTER to continue ---

</span></code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">Â </div><br><br><br><br><br><div class="highlight-line">Â </div><br><br><br><br><br><div class="highlight-line">Â </div><br><br><br><div class="highlight-line">Â </div><br><br><br><div class="highlight-line">Â </div><br><br><br><div class="highlight-line">Â </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div></div></details><h2 id="agent-configuration" tabindex="-1"><a class="header-anchor" href="#agent-configuration"><span>Agent configuration</span></a></h2><p>Edit the agent configuration file and verify that the server IP address is correct. Make sure email notifications is disabled as <a href="#slack-integration">Slack</a> will be the preferred channel.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">client@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/etc/ossec.conf</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">client@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/etc/ossec.conf</span></span>
</code></pre></div><!--]--></div><!--]--></div><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ossec_config</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>client</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>server-ip</span><span class="token punctuation">&gt;</span></span>192.168.0.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>server-ip</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>config-profile</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>config-profile</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>client</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>global</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>email_notification</span><span class="token punctuation">&gt;</span></span>no<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>email_notification</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>global</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="highlight-lines"><br><br><div class="highlight-line">Â </div><br><br><br><br><div class="highlight-line">Â </div><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Proceed and add the following lines after the rootcheck segment to enable active response and repeated offenders. You will find the agent ID when you add your agents to your OSSEC server. See the <a href="#manage-agents">Manage agents</a> section.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">client@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/etc/ossec.conf</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">client@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/etc/ossec.conf</span></span>
</code></pre></div><!--]--></div><!--]--></div><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>command</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>firewall-drop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executable</span><span class="token punctuation">&gt;</span></span>firewall-drop.sh<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executable</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>expect</span><span class="token punctuation">&gt;</span></span>srcip<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>expect</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeout_allowed</span><span class="token punctuation">&gt;</span></span>yes<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeout_allowed</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>command</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- Active Response Config --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>active-response</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- Specify a comma seperated list of timeouts per
     - re-incidence (in minutes).
    --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>repeated_offenders</span><span class="token punctuation">&gt;</span></span>30,60,120,240,480<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>repeated_offenders</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>active-response</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>active-response</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- Firewall Drop response. Block the IP for
    - 600 seconds on the firewall (iptables,
    - ipfilter, etc).
    --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>disabled</span><span class="token punctuation">&gt;</span></span>no<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>disabled</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>command</span><span class="token punctuation">&gt;</span></span>firewall-drop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>command</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>agent_id</span><span class="token punctuation">&gt;</span></span>001<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>agent_id</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>location</span><span class="token punctuation">&gt;</span></span>local<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>location</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rules_id</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rules_id</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">&gt;</span></span>6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeout</span><span class="token punctuation">&gt;</span></span>600<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeout</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>active-response</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">Â </div><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="manage-agents" tabindex="-1"><a class="header-anchor" href="#manage-agents"><span>Manage agents</span></a></h2><p>To add an agent to your OSSEC server, run the command shown in the code segments below and follow the instructions.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> /var/ossec/bin/manage_agents</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> /var/ossec/bin/manage_agents</span></span>
</code></pre></div><!--]--></div><!--]--></div><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">****************************************
* OSSEC HIDS v3.6.0 Agent manager.     *
* The following options are available: *
****************************************
   (A)dd an agent (A).
   (E)xtract key for an agent (E).
   (L)ist already added agents (L).
   (R)emove an agent (R).
   (Q)uit.
Choose your action: A,E,L,R or Q: A

- Adding a new agent (use &#39;\q&#39; to return to the main menu).
  Please provide the following:
   * A name for the new agent: client
   * The IP Address of the new agent: 192.168.0.2
   * An ID for the new agent[001]: 001
Agent information:
   ID:001
   Name:client
   IP Address:192.168.0.2

Confirm adding it?(y/n): y
</span></code></pre><div class="highlight-lines"><br><br><br><br><div class="highlight-line">Â </div><br><br><br><br><div class="highlight-line">Â </div><br><br><br><div class="highlight-line">Â </div><div class="highlight-line">Â </div><div class="highlight-line">Â </div><br><br><br><br><br><div class="highlight-line">Â </div></div></div><p>Once you&#39;ve added the client proceed by extracting its agent key by providing the assigned agent ID.</p><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">****************************************
* OSSEC HIDS v3.6.0 Agent manager.     *
* The following options are available: *
****************************************
   (A)dd an agent (A).
   (E)xtract key for an agent (E).
   (L)ist already added agents (L).
   (R)emove an agent (R).
   (Q)uit.
Choose your action: A,E,L,R or Q: E

Available agents: 
   ID: 001, Name: client, IP: 192.168.0.2
Provide the ID of the agent to extract the key (or &#39;\q&#39; to quit): 001

Agent key information for &#39;001&#39; is: 
523b0d579891be85956bb3da6c757455005eaf1508ef578186431efbebf5901ecb467ddd857ed5dfdeb5b2cb00e8911c6d031=

** Press ENTER to return to the main menu.
</span></code></pre><div class="highlight-lines"><br><br><br><br><br><div class="highlight-line">Â </div><br><br><br><div class="highlight-line">Â </div><br><br><br><div class="highlight-line">Â </div><br><br><div class="highlight-line">Â </div><br><br></div></div><p>Copy the agent key and head back to your OSSEC client and import the agent key. Execute the command - shown in the code section below â on the client and paste the key. Validate that your agent information is correct before adding it.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">client@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> /var/ossec/bin/manage_agents</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">client@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> /var/ossec/bin/manage_agents</span></span>
</code></pre></div><!--]--></div><!--]--></div><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">****************************************
* OSSEC HIDS v3.6.0 Agent manager.     *
* The following options are available: *
****************************************
   (I)mport key from the server (I).
   (Q)uit.
Choose your action: I or Q: i

* Provide the Key generated by the server.
* The best approach is to cut and paste it.
*** OBS: Do not include spaces or new lines.

Paste it here (or &#39;\q&#39; to quit): 
523b0d579891be85956bb3da6c757455005eaf1508ef578186431efbebf5901ecb467ddd857ed5dfdeb5b2cb00e8911c6d031=

Agent information:
   ID:001
   Name:client
   IP Address:192.168.0.2

Confirm adding it?(y/n): y
Added.
</span></code></pre><div class="highlight-lines"><br><br><br><br><br><br><div class="highlight-line">Â </div><br><br><br><br><br><br><div class="highlight-line">Â </div><br><br><br><br><br><br><div class="highlight-line">Â </div><br></div></div><p>Finally restart the OSSEC server and the client to enable and activate OSSEC HIDS.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> /var/ossec/bin/ossec-control restart</span></span>
<span class="token command"><span class="token info punctuation"><span class="token user">client@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> /var/ossec/bin/ossec-control restart</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> /var/ossec/bin/ossec-control restart</span></span>
<span class="token command"><span class="token info punctuation"><span class="token user">client@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> /var/ossec/bin/ossec-control restart</span></span>
</code></pre></div><!--]--></div><!--]--></div><p>To confirm that your agent is active, run the following command from the server.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> /var/ossec/bin/agent_control <span class="token parameter variable">-lc</span></span></span>

<span class="token output">OSSEC HIDS agent_control. List of available agents:
   ID: 000, Name: server (server), IP: 127.0.0.1, Active/Local
   ID: 001, Name: client, IP: 192.168.0.2, Active
</span></code></pre><div class="highlight-lines"><div class="highlight-line">Â </div><br><br><br><div class="highlight-line">Â </div></div></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> /var/ossec/bin/agent_control <span class="token parameter variable">-lc</span></span></span>

<span class="token output">OSSEC HIDS agent_control. List of available agents:
   ID: 000, Name: server (server), IP: 127.0.0.1, Active/Local
   ID: 001, Name: client, IP: 192.168.0.2, Active
</span></code></pre><div class="highlight-lines"><div class="highlight-line">Â </div><br><br><br><div class="highlight-line">Â </div></div></div><!--]--></div><!--]--></div><p>If the agent does not appear, make sure that the firewall settings are in place and that the correct ports are opened on both environments. See the <a href="#firewall-settings">Firewall settings</a> section for more information.</p><h2 id="windows-agent" tabindex="-1"><a class="header-anchor" href="#windows-agent"><span>Windows agent</span></a></h2><p>The following agent installation have been tested on Windows Server 2019 and Windows 10. Login to your OSSEC server and start the agent manager.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> /var/ossec/bin/manage_agents</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> /var/ossec/bin/manage_agents</span></span>
</code></pre></div><!--]--></div><!--]--></div><p>Select option (A) to add your new Windows agent.</p><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">****************************************
* OSSEC HIDS v3.6.0 Agent manager.     *
* The following options are available: *
****************************************
   (A)dd an agent (A).
   (E)xtract key for an agent (E).
   (L)ist already added agents (L).
   (R)emove an agent (R).
   (Q)uit.
Choose your action: A,E,L,R or Q: a
</span></code></pre><div class="highlight-lines"><br><br><br><br><div class="highlight-line">Â </div><br><br><br><br><div class="highlight-line">Â </div></div></div><p>Enter the name of your Windows agent, specify its local IP address and attach an agent ID.</p><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">- Adding a new agent (use &#39;\q&#39; to return to the main menu).
  Please provide the following:
   * A name for the new agent: client
   * The IP Address of the new agent: 192.168.0.2
   * An ID for the new agent[001]: 001
Agent information:
   ID:001
   Name:client
   IP Address:192.168.0.2

Confirm adding it?(y/n): y
</span></code></pre><div class="highlight-lines"><br><br><div class="highlight-line">Â </div><div class="highlight-line">Â </div><div class="highlight-line">Â </div><br><br><br><br><br><div class="highlight-line">Â </div></div></div><p>Once you&#39;ve created the new agent proceed to extract its agent key.</p><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">****************************************
* OSSEC HIDS v3.6.0 Agent manager.     *
* The following options are available: *
****************************************
   (A)dd an agent (A).
   (E)xtract key for an agent (E).
   (L)ist already added agents (L).
   (R)emove an agent (R).
   (Q)uit.
Choose your action: A,E,L,R or Q: e

Available agents: 
   ID: 001, Name: client, IP: 192.168.0.2
Provide the ID of the agent to extract the key (or &#39;\q&#39; to quit): 001
</span></code></pre><div class="highlight-lines"><br><br><br><br><br><div class="highlight-line">Â </div><br><br><br><div class="highlight-line">Â </div><br><br><br><div class="highlight-line">Â </div></div></div><p>Copy the agent ID as you will need it when setting up the client machine.</p><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">Agent key information for &#39;001&#39; is: 
xasdEGdh321ieC1i321wMSAxOTIuMTY4Ljg4LjYwIGRjdaszcxODVmZTY3N2U1M43156dasdaE5YjgyNzg2M2fsat6421WJhMDkzNjI3MTM4ZDk3ZGFhxsaRyvfYzExMDg1YTQ=
</span></code></pre><div class="highlight-lines"><br><div class="highlight-line">Â </div></div></div><p>Login to the Windows Server 2019 client machine and download the latest OSSEC windows agent client (in this case <a href="https://updates.atomicorp.com/channels/atomic/windows/ossec-agent-win32-3.6.0-12032.exe" target="_blank" rel="noopener noreferrer">3.6.0<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>). Otherwise you can find the latest release <a href="https://www.ossec.net/downloads/" target="_blank" rel="noopener noreferrer">here<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> (under the latest stable releases and <em>Agent Windows</em>). Run the executable file.</p><img class="zoom-custom-imgs" src="/img/ossec/windows_agent_setup.png" alt="Windows setup"><p>Accept the current terms and agreements and proceed with the installation. In the next step you will be able to select which components to monitor. If you run a Windows web server, keep the option to scan and monitor IIS logs checked (in this tutorial we do not use it).</p><img class="zoom-custom-imgs" src="/img/ossec/windows_agent_components.png" alt="Windows components"><p>Once you&#39;ve completed the installation you we will be presented the OSSEC Windows Agent Manager. Add the OSSEC server IP and the Authentication key you copied in a section above. Press save.</p><img class="zoom-custom-imgs" src="/img/ossec/windows_agent_manager.png" alt="Windows manager"><p>Next update the firewall settings on your OSSEC server (see <a href="https://www.libellux.com/ossec/#firewall-settings" target="_blank" rel="noopener noreferrer">Firewall Settings<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>) and add the Windows agent client IP address to the remote connection and allowed IPS section in the OSSEC server configuration file.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/etc/ossec.conf</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/etc/ossec.conf</span></span>
</code></pre></div><!--]--></div><!--]--></div><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>global</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>allow_list</span><span class="token punctuation">&gt;</span></span>192.168.0.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>allow_list</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- OSSEC client --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>global</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>remote</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>connection</span><span class="token punctuation">&gt;</span></span>secure<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>connection</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>allowed-ips</span><span class="token punctuation">&gt;</span></span>192.168.0.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>allowed-ips</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- OSSEC client --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>remote</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="highlight-lines"><br><div class="highlight-line">Â </div><br><br><br><br><div class="highlight-line">Â </div><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Finally, to check if the new Windows agent is active run the agent control command.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">/var/ossec/bin/agent_control <span class="token parameter variable">-lc</span></span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">/var/ossec/bin/agent_control <span class="token parameter variable">-lc</span></span></span>
</code></pre></div><!--]--></div><!--]--></div><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">OSSEC HIDS agent_control. List of available agents:
   ID: 000, Name: server (server), IP: 127.0.0.1, Active/Local
   ID: 001, Name: client, IP: 192.168.0.2, Active
</span></code></pre><div class="highlight-lines"><br><br><div class="highlight-line">Â </div></div></div><h2 id="agentless-monitoring" tabindex="-1"><a class="header-anchor" href="#agentless-monitoring"><span>Agentless monitoring</span></a></h2><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>The agentless monitoring has so far only been tested with VMware ESXi 6.7. The result is still not 100% but will give an overview on how to configure your agentless servers or devices.</p></div><p>Generate SSH keys for the OSSEC user.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token parameter variable">-u</span> ossec ssh-keygen</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token parameter variable">-u</span> ossec ssh-keygen</span></span>
</code></pre></div><!--]--></div><!--]--></div><p>If receiving <code>Saving key &quot;/var/ossec/.ssh/id_rsa&quot; failed: Permission denied</code> make sure that OSSEC is the directory owner of <code>.ssh/</code>.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">chown</span> <span class="token parameter variable">-R</span> ossec:ossec .ssh/ <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> <span class="token parameter variable">-u</span> ossec ssh-keygen</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">chown</span> <span class="token parameter variable">-R</span> ossec:ossec .ssh/ <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> <span class="token parameter variable">-u</span> ossec ssh-keygen</span></span>
</code></pre></div><!--]--></div><!--]--></div><h3 id="vmware-esxi" tabindex="-1"><a class="header-anchor" href="#vmware-esxi"><span>VMware ESXi</span></a></h3><p>Login as the administrator through the vSphere client. Go to the <em>Host</em>, <em>Manage</em> and advanced settings under the <em>System</em> tab.</p><img class="zoom-custom-imgs" src="/img/ossec/remote_syslog_settings.png" alt="VMware syslog settings"><p>Filter by <em>syslog</em> and find the <code>Syslog.global.logHOST</code> parameter. Right click and select <em>Edit option</em> and set your remote OSSEC host.</p><img class="zoom-custom-imgs" src="/img/ossec/remote_syslog_value.png" alt="VMware syslog options"><p>Additionally you need to edit the <code>/etc/profile.local</code> file for the VMware ESXi SSH prompt as the agentless service expects the prompt to end with either <code>#</code> or <code>$</code>. As administrator, SSH to the VMware ESXi shell and using the vi editor append the following line.</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># profile.local</span>
<span class="token comment"># This file is not used when UEFI secure boot is enabled</span>
<span class="token assign-left variable"><span class="token environment constant">PS1</span></span><span class="token operator">=</span><span class="token string">&quot;<span class="token entity" title="\e">\e</span>[0;41m[\u@\h \W]\$ <span class="token entity" title="\e">\e</span>[m&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="enabling-agentless-monitoring" tabindex="-1"><a class="header-anchor" href="#enabling-agentless-monitoring"><span>Enabling agentless monitoring</span></a></h3><p>To enable agentless monitoring go back to your OSSEC server and execute the following command.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">/var/ossec/bin/ossec-control <span class="token builtin class-name">enable</span> agentless</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">/var/ossec/bin/ossec-control <span class="token builtin class-name">enable</span> agentless</span></span>
</code></pre></div><!--]--></div><!--]--></div><p>Proceed to add VMware ESXi server as agentless using the <em>NOPASS</em> option as it will be using SSH keys to communicate.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">/var/ossec/agentless/register_host.sh <span class="token function">add</span> root@192.168.0.2 NOPASS</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash">/var/ossec/agentless/register_host.sh <span class="token function">add</span> root@192.168.0.2 NOPASS</span></span>
</code></pre></div><!--]--></div><!--]--></div><p>To test if the authentication works you can run the command below.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token parameter variable">-u</span> ossec <span class="token function">ssh</span> root@192.168.0.2</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token parameter variable">-u</span> ossec <span class="token function">ssh</span> root@192.168.0.2</span></span>
</code></pre></div><!--]--></div><!--]--></div><h3 id="configure-agentless-monitoring" tabindex="-1"><a class="header-anchor" href="#configure-agentless-monitoring"><span>Configure agentless monitoring</span></a></h3><p>For more information regarding setting up and configuring agentless monitoring, check the OSSEC documentation <a href="https://www.ossec.net/docs/manual/agent/agentless-monitoring.html" target="_blank" rel="noopener noreferrer">here<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><p>Open the OSSEC configuration file and add the VMware ESXi IP address to the remote syslog section.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/etc/ossec.conf</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/etc/ossec.conf</span></span>
</code></pre></div><!--]--></div><!--]--></div><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>remote</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>connection</span><span class="token punctuation">&gt;</span></span>syslog<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>connection</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>allowed-ips</span><span class="token punctuation">&gt;</span></span>192.168.0.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>allowed-ips</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- VMware ESXi --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>remote</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Additionally add the agentless types to the configuration.</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>agentless</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">&gt;</span></span>ssh_integrity_check_bsd<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>frequency</span><span class="token punctuation">&gt;</span></span>36000<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>frequency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>host</span><span class="token punctuation">&gt;</span></span>root@192.168.0.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>host</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- VMware ESXi --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span><span class="token punctuation">&gt;</span></span>periodic<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>arguments</span><span class="token punctuation">&gt;</span></span>/bin /etc/ /sbin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>arguments</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>agentless</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>agentless</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">&gt;</span></span>ssh_generic_diff<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>frequency</span><span class="token punctuation">&gt;</span></span>36000<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>frequency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>host</span><span class="token punctuation">&gt;</span></span>root@192.168.0.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>host</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- VMware ESXi --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>state</span><span class="token punctuation">&gt;</span></span>periodic_diff<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>state</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>arguments</span><span class="token punctuation">&gt;</span></span>ls -la /etc; cat /etc/passwd<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>arguments</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>agentless</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Finally restart OSSEC.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> /var/ossec/bin/ossec-control restart</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> /var/ossec/bin/ossec-control restart</span></span>
</code></pre></div><!--]--></div><!--]--></div><h2 id="firewall-settings" tabindex="-1"><a class="header-anchor" href="#firewall-settings"><span>Firewall settings</span></a></h2><p>The firewall being used is UFW (Uncomplicated Firewall). It is set by default to deny incoming traffic, allow outgoing traffic and allow port 22 (OpenSSH). Read more about UFW <a href="https://help.ubuntu.com/community/UFW" target="_blank" rel="noopener noreferrer">here<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><details class="custom-container details"><summary>UFW Settings</summary><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> ufw default deny incoming</span></span>
<span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> ufw default allow outgoing</span></span>
<span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> ufw allow <span class="token number">22</span></span></span>
<span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> ufw <span class="token builtin class-name">enable</span></span></span>
<span class="token output">Command may disrupt existing ssh connections. Proceed with operation (y|n)? y
Firewall is active and enabled on system startup
</span></code></pre></div></details><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> ufw allow proto udp from <span class="token number">192.168</span>.0.2 to any port <span class="token number">1514</span> comment <span class="token string">&quot;OSSEC client&quot;</span></span></span>
<span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> ufw allow proto udp from <span class="token number">192.168</span>.0.2 to any port <span class="token number">514</span> comment <span class="token string">&quot;OSSEC client syslog&quot;</span></span></span>
</code></pre></div><h2 id="logtail" tabindex="-1"><a class="header-anchor" href="#logtail"><span>Logtail</span></a></h2><h1 id="vector" tabindex="-1"><a class="header-anchor" href="#vector"><span>Vector</span></a></h1><h2 id="slack-integration" tabindex="-1"><a class="header-anchor" href="#slack-integration"><span>Slack integration</span></a></h2><p>Download <a href="/img/ossec/512x512.png">OSSEC icon</a> for the Slack App integration.</p><p>Add the ossec-slack command within the command section of the OSSEC configuration file.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/etc/ossec.conf</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/etc/ossec.conf</span></span>
</code></pre></div><!--]--></div><!--]--></div><p>To send all alerts to Slack with the pre-defined alert level, leave the expect segment blank.</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>command</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>ossec-slack<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executable</span><span class="token punctuation">&gt;</span></span>ossec-slack.sh<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executable</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>expect</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>expect</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- no expect args required --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeout_allowed</span><span class="token punctuation">&gt;</span></span>no<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeout_allowed</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>command</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In the active response section set the alert to preferred level.</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>active-response</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>command</span><span class="token punctuation">&gt;</span></span>ossec-slack<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>command</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>location</span><span class="token punctuation">&gt;</span></span>server<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>location</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">&gt;</span></span>6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>active-response</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Next edit the <code>ossec-slack.sh</code> file to match your Slack App settings.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/active-response/bin/ossec-slack.sh</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/active-response/bin/ossec-slack.sh</span></span>
</code></pre></div><!--]--></div><!--]--></div><div class="custom-container warning"><p class="custom-container-title">NOTE</p><p>Make sure that the log path is correct <code>/../</code> in the ossec-slack.sh file.</p></div><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token assign-left variable">SLACKUSER</span><span class="token operator">=</span><span class="token string">&quot;OSSEC&quot;</span>
<span class="token assign-left variable">CHANNEL</span><span class="token operator">=</span><span class="token string">&quot;#ossec-hids&quot;</span>
<span class="token assign-left variable">SITE</span><span class="token operator">=</span><span class="token string">&quot;https://hooks.slack.com/services/XXXXXXXXX/XXXXXXXX/XXXXXXXXXXX&quot;</span>
<span class="token assign-left variable">SOURCE</span><span class="token operator">=</span><span class="token string">&quot;ossec2slack&quot;</span>
<span class="token punctuation">..</span>.
<span class="token comment"># Logging</span>
<span class="token builtin class-name">cd</span> <span class="token variable">$LOCAL</span>
<span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>/
<span class="token assign-left variable"><span class="token environment constant">PWD</span></span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">pwd</span><span class="token variable">`</span></span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">`</span><span class="token function">date</span><span class="token variable">`</span></span> <span class="token variable">$0</span> <span class="token variable">$1</span> <span class="token variable">$2</span> <span class="token variable">$3</span> <span class="token variable">$4</span> <span class="token variable">$5</span> <span class="token variable">$6</span> <span class="token variable">$7</span> <span class="token variable">$8</span>&quot;</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">${<span class="token environment constant">PWD</span>}</span>/<span class="token punctuation">..</span>/logs/active-responses.log
</code></pre><div class="highlight-lines"><br><br><div class="highlight-line">Â </div><br><br><br><br><br><br><div class="highlight-line">Â </div></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Save the file and reload OSSEC and you should now start receive alerts to the defined Slack channel.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> /var/ossec/bin/ossec-control reload</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> /var/ossec/bin/ossec-control reload</span></span>
</code></pre></div><!--]--></div><!--]--></div><h2 id="cloudflare-integration" tabindex="-1"><a class="header-anchor" href="#cloudflare-integration"><span>Cloudflare integration</span></a></h2><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>The Cloudflare integration requires you to have the jq (JSON processing) tool installed. This tool is used when removing blocked IP&#39;s following the repeated offenders timeout interval.</p></div><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> jq</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> yum <span class="token function">install</span> jq</span></span>
</code></pre></div><!--]--></div><!--]--></div><p>First add the cloudflare-ban command to the OSSEC configuration file.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/etc/ossec.conf</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/etc/ossec.conf</span></span>
</code></pre></div><!--]--></div><!--]--></div><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>command</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>cloudflare-ban<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executable</span><span class="token punctuation">&gt;</span></span>cloudflare-ban.sh<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executable</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeout_allowed</span><span class="token punctuation">&gt;</span></span>yes<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeout_allowed</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>expect</span><span class="token punctuation">&gt;</span></span>srcip<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>expect</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>command</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In the active response section, set to block all level 6 alerts or greater.</p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>active-response</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>command</span><span class="token punctuation">&gt;</span></span>cloudflare-ban<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>command</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>location</span><span class="token punctuation">&gt;</span></span>server<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>location</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">&gt;</span></span>6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>timeout</span><span class="token punctuation">&gt;</span></span>43200<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>timeout</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>active-response</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Next proceed to update the <code>cloudflare-ban.sh</code> script and put your Cloudflare username along with your Global API key.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/active-response/bin/cloudflare-ban.sh</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/active-response/bin/cloudflare-ban.sh</span></span>
</code></pre></div><!--]--></div><!--]--></div><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token assign-left variable">ACTION</span><span class="token operator">=</span><span class="token variable">$1</span>
<span class="token assign-left variable"><span class="token environment constant">USER</span></span><span class="token operator">=</span><span class="token variable">$2</span>
<span class="token assign-left variable">IP</span><span class="token operator">=</span><span class="token variable">$3</span>
<span class="token assign-left variable"><span class="token environment constant">PWD</span></span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">pwd</span><span class="token variable">`</span></span>
<span class="token assign-left variable">TOKEN</span><span class="token operator">=</span><span class="token string">&#39;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9ey&#39;</span>
<span class="token assign-left variable"><span class="token environment constant">USER</span></span><span class="token operator">=</span><span class="token string">&#39;cloudflareuser@email.com&#39;</span>
<span class="token assign-left variable">MODE</span><span class="token operator">=</span><span class="token string">&#39;block&#39;</span> <span class="token comment"># block or challenge</span>
</code></pre><div class="highlight-lines"><br><br><br><br><div class="highlight-line">Â </div><div class="highlight-line">Â </div><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Save the changes and reload OSSEC.</p><div class="code-group"><div class="code-group__nav" role="tablist"><button class="code-group__nav-tab code-group__nav-tab-active" role="tab" ariaselected="true">Ubuntu</button><button class="code-group__nav-tab" role="tab" ariaselected="false">Rocky</button></div><!--[--><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> /var/ossec/bin/ossec-control reload</span></span>
</code></pre></div><!--]--></div><div class="code-group-item" role="tabpanel"><!--[--><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@rocky</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> /var/ossec/bin/ossec-control reload</span></span>
</code></pre></div><!--]--></div><!--]--></div><p>To monitor the blocked IP address within the Cloudflare account, go to Firewall, Tools and IP Access Rules.</p><h2 id="monitoring" tabindex="-1"><a class="header-anchor" href="#monitoring"><span>Monitoring</span></a></h2><p>To monitor if the OSSEC daemons are running accordingly, we use Monit to monitor the current status. Edit the Monit configuration file and add the lines below, continue with reloading the Monit daemon to apply the new monitoring rules. If working correctly we shall now receive M/Monit alerts saying processes are not running.</p><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">client@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /usr/local/etc/monitrc</span></span>
</code></pre></div><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># OSSEC processes</span>
check process ossec-agentd matching <span class="token string">&quot;ossec-agentd&quot;</span>
check process ossec-execd matching <span class="token string">&quot;ossec-execd&quot;</span>
check process ossec-logcollector matching <span class="token string">&quot;ossec-logcollector&quot;</span>
check process ossec-syscheckd matching <span class="token string">&quot;ossec-syscheckd&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Save and reload Monit.</p><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">client@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token builtin class-name">cd</span> /usr/local/</span></span>
<span class="token command"><span class="token info punctuation"><span class="token user">client@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> ./bin/monit reload</span></span>
</code></pre></div><h3 id="monitor-failed-m-monit-login-attempts-with-ossec" tabindex="-1"><a class="header-anchor" href="#monitor-failed-m-monit-login-attempts-with-ossec"><span>Monitor failed M/Monit login attempts with OSSEC</span></a></h3><p>Add the M/Monit error.log path to the OSSEC monitor section (local files).</p><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">client@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/etc/ossec.conf</span></span>
</code></pre></div><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localfile</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log_format</span><span class="token punctuation">&gt;</span></span>syslog<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>log_format</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>location</span><span class="token punctuation">&gt;</span></span>/usr/local/mmonit-3.7.2/logs/error.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>location</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localfile</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Go to the OSSEC server and add the custom rule to the <code>local_rules.xml</code> file.</p><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">nano</span> /var/ossec/rules/local_rules.xml</span></span>
</code></pre></div><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100101<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>6<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if_sid</span><span class="token punctuation">&gt;</span></span>2501<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if_sid</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>match</span><span class="token punctuation">&gt;</span></span>Unauthorized, authentication failed for<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>match</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>group</span><span class="token punctuation">&gt;</span></span>authentication_failed,<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>group</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>User authentication failure.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rule</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Save and reload the OSSEC server.</p><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> /var/ossec/bin/ossec-control reload</span></span>
</code></pre></div><h2 id="upgrading" tabindex="-1"><a class="header-anchor" href="#upgrading"><span>Upgrading</span></a></h2><p>To upgrade OSSEC, download the <a href="https://github.com/ossec/ossec-hids/releases" target="_blank" rel="noopener noreferrer">latest release<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, extract the file and run the install script. The installer will tell if OSSEC is already installed and if you wish to update it.</p><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">wget</span> https://github.com/ossec/ossec-hids/archive/3.6.0.tar.gz</span></span>
<span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> <span class="token number">3.6</span>.0.tar.gz</span></span>
<span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token builtin class-name">cd</span> ossec-hids-3.6.0/</span></span>
<span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">wget</span> https://ftp.pcre.org/pub/pcre/pcre2-10.32.tar.gz</span></span>
<span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> pcre2-10.32.tar.gz <span class="token parameter variable">-C</span> src/external/</span></span>
<span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> build-essential libssl-dev libpcre2-dev zlib1g-dev</span></span>
<span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token assign-left variable">PCRE2_SYSTEM</span><span class="token operator">=</span>yes ./install</span></span>
</code></pre></div><h3 id="upgrade-to-ossec-3-3-0" tabindex="-1"><a class="header-anchor" href="#upgrade-to-ossec-3-3-0"><span>Upgrade to OSSEC 3.3.0</span></a></h3><p>To upgrade to OSSEC 3.3.0 using the pcre2 package, download the new version along with the pcre2 package, extract and upgrade OSSEC as normal.</p><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">wget</span> https://github.com/ossec/ossec-hids/archive/3.3.0.tar.gz</span></span>
<span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> <span class="token number">3.3</span>.0.tar.gz</span></span>
<span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token builtin class-name">cd</span> ossec-hids-3.3.0/</span></span>
<span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">wget</span> https://ftp.pcre.org/pub/pcre/pcre2-10.32.tar.gz</span></span>
<span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> pcre2-10.32.tar.gz <span class="token parameter variable">-C</span> src/external/</span></span>
<span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> build-essential libssl-dev libpcre2-dev zlib1g-dev</span></span>
<span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">sudo</span> <span class="token assign-left variable">PCRE2_SYSTEM</span><span class="token operator">=</span>yes ./install</span></span>
</code></pre></div><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">OSSEC HIDS v2.9.3 Installation Script - http://www.ossec.net
 
You are about to start the installation process of the OSSEC HIDS.
You must have a C compiler pre-installed in your system.
 
    - System: Linux hostname 4.4.0-116-generic
    - User: root
    - Host: hostname

    -- Press ENTER to continue or Ctrl-C to abort. --

    - You already have OSSEC installed. Do you want to update it? (y/n): y
</span></code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">Â </div></div></div><h2 id="custom-rules" tabindex="-1"><a class="header-anchor" href="#custom-rules"><span>Custom rules</span></a></h2><p>Read more about how to create custom rules and decoders <a href="https://www.ossec.net/docs/manual/rules-decoders/create-custom.html" target="_blank" rel="noopener noreferrer">here<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><ul><li><a href="https://github.com/libellux/Libellux-Up-and-Running/blob/master/docs/ossec/config/local_rules.xml" target="_blank" rel="noopener noreferrer">local_rules.xml<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h3 id="ignore-snap-loop-devices" tabindex="-1"><a class="header-anchor" href="#ignore-snap-loop-devices"><span>Ignore snap loop devices</span></a></h3><p><code>/var/ossec/rules/local_rules.xml</code></p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if_sid</span><span class="token punctuation">&gt;</span></span>531<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if_sid</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>regex</span><span class="token punctuation">&gt;</span></span>&#39;df -P&#39;:\s+/dev/loop\d+\s+\d+\s+\d+\s+0\s+100%\s+/snap/\w+/\d+<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>regex</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Ignore full snap loop devices.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rule</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="monitor-failed-m-monit-authentication" tabindex="-1"><a class="header-anchor" href="#monitor-failed-m-monit-authentication"><span>Monitor failed M/Monit authentication</span></a></h3><p><code>/var/ossec/rules/local_rules.xml</code></p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100101<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>6<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if_sid</span><span class="token punctuation">&gt;</span></span>2501<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if_sid</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>match</span><span class="token punctuation">&gt;</span></span>Unauthorized, authentication failed for<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>match</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>group</span><span class="token punctuation">&gt;</span></span>authentication_failed,<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>group</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>User authentication failure.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rule</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>/var/ossec/etc/oseec.conf</code></p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localfile</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log_format</span><span class="token punctuation">&gt;</span></span>syslog<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>log_format</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>location</span><span class="token punctuation">&gt;</span></span>/usr/local/mmonit-3.7.2/logs/error.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>location</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localfile</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="mute-useless-systemd-resolved-message" tabindex="-1"><a class="header-anchor" href="#mute-useless-systemd-resolved-message"><span>Mute useless systemd-resolved message</span></a></h3><p><code>/var/ossec/rules/local_rules.xml</code></p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100102<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>program_name</span><span class="token punctuation">&gt;</span></span>systemd-resolved<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>program_name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>match</span><span class="token punctuation">&gt;</span></span>Server returned error NXDOMAIN<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>match</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Useless systemd-resolved log message.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rule</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="alert-on-fail2ban-action" tabindex="-1"><a class="header-anchor" href="#alert-on-fail2ban-action"><span>Alert on fail2ban action</span></a></h3><p><code>/var/ossec/rules/local_rules.xml</code></p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100103<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>6<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>match</span><span class="token punctuation">&gt;</span></span>fail2ban.actions<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>match</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>group</span><span class="token punctuation">&gt;</span></span>authentication_failed,<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>group</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Fail2ban action taken.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rule</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>/var/ossec/etc/oseec.conf</code></p><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>localfile</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>log_format</span><span class="token punctuation">&gt;</span></span>syslog<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>log_format</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>location</span><span class="token punctuation">&gt;</span></span>/var/log/fail2ban.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>location</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>localfile</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="command-line" tabindex="-1"><a class="header-anchor" href="#command-line"><span>Command-line</span></a></h2><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody><tr><td>/var/ossec/bin/agent_control -lc</td><td>List all active agents</td></tr><tr><td>/var/ossec/bin/ossec-logtest</td><td>Logtest</td></tr><tr><td>/var/ossec/bin/ossec-control</td><td>start,stop,reload,restart,status,enable,disable</td></tr><tr><td>/var/ossec/bin/manage_agents</td><td>manage agents (e.g., add, remove)</td></tr></tbody></table><h2 id="troubleshooting" tabindex="-1"><a class="header-anchor" href="#troubleshooting"><span>Troubleshooting</span></a></h2><p>If you encounter any issue or having questions regarding OSSEC I recommend using their very helpful <a href="https://groups.google.com/forum/#!forum/ossec-list" target="_blank" rel="noopener noreferrer">mailing list<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><p>You can also read more about debug mode and how to view more verbose logs <a href="https://www.ossec.net/docs/faq/unexpected.html" target="_blank" rel="noopener noreferrer">here<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><p><a href="https://github.com/libellux/Libellux-Up-and-Running/issues/new/choose" target="_blank" rel="noopener noreferrer">Questions<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, <a href="https://github.com/libellux/Libellux-Up-and-Running/issues/new/choose" target="_blank" rel="noopener noreferrer">comments<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, or <a href="https://github.com/libellux/Libellux-Up-and-Running/issues/new/choose" target="_blank" rel="noopener noreferrer">problems<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> regarding this service? Create an issue <a href="https://github.com/libellux/Libellux-Up-and-Running/issues/new/choose" target="_blank" rel="noopener noreferrer">here<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> or contact <a href="mailto:webmaster@libellux.com">webmaster@libellux.com</a>.</p><h3 id="duplicate-counter-error" tabindex="-1"><a class="header-anchor" href="#duplicate-counter-error"><span>Duplicate counter error</span></a></h3><p>In the OSSEC log (/var/ossec/logs/ossec.log) you might notice that the log gets filled with warnings and errors as shown below.</p><div class="language-log line-numbers-mode" data-ext="log" data-title="log"><pre class="language-log"><code><span class="token date number">2019/02/21</span> <span class="token time number">13:33:21</span> ossec<span class="token operator">-</span>remoted<span class="token operator">:</span> <span class="token level warning important">WARN</span><span class="token operator">:</span> Duplicate error<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
<span class="token date number">2019/02/21</span> <span class="token time number">13:33:21</span> ossec<span class="token operator">-</span>remoted<span class="token operator">(</span><span class="token number">1407</span><span class="token operator">)</span><span class="token operator">:</span> <span class="token level error important">ERROR</span><span class="token operator">:</span> Duplicated counter for <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Stop both the OSSEC server and the agent. In the agent server go to <code>/var/ossec/queue/rids</code> and remove all the files within the folder. At the OSSEC server go into <code>/var/ossec/queue/rids</code> and remove the file corresponding to the agents ID. <strong>Do not</strong> delete the <code>sender_counter</code>. Restart both.</p><p>Or disable the feature by editing <code>/var/ossec/etc/internal_options.conf</code></p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># Verify msg id (set to 0 to disable it)</span>
<span class="token assign-left variable">remoted.verify_msg_id</span><span class="token operator">=</span><span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Save and restart.</p><h3 id="build-essential" tabindex="-1"><a class="header-anchor" href="#build-essential"><span>build-essential</span></a></h3><p>If receiving build error <code>./install.sh: 105: make: not found</code> install the build-essential package <code>sudo apt-get install build-essential</code>.</p><h3 id="libevent-dev" tabindex="-1"><a class="header-anchor" href="#libevent-dev"><span>libevent-dev</span></a></h3><p>If receiving the build error below, install the libevent development package <code>sudo apt-get install libevent-dev</code>.</p><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">os_maild/sendmail.c:12:10: fatal error: event.h: No such file or directory
12 | #include &lt;event.h&gt;
   |          ^~~~~~~~~
compilation terminated.
make: *** [Makefile:926: os_maild/sendmail.o] Error 1
</span></code></pre></div><h3 id="pcre2-libpcre2-dev" tabindex="-1"><a class="header-anchor" href="#pcre2-libpcre2-dev"><span>pcre2 &amp; libpcre2-dev</span></a></h3><p>If receiving the build error <code>./os_regex/os_regex.h:19:10: fatal error: pcre2.h: No such file or directory</code> download and install pcre2 package (version 10.32) found <a href="https://ftp.pcre.org/pub/pcre/" target="_blank" rel="noopener noreferrer">here<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">wget</span> https://ftp.pcre.org/pub/pcre/pcre2-10.32.tar.gz</span></span>
<span class="token command"><span class="token info punctuation"><span class="token user">server@ubuntu</span><span class="token punctuation">:</span><span class="token path">~</span></span><span class="token shell-symbol important">$</span> <span class="token bash language-bash"><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> pcre2-10.32.tar.gz <span class="token parameter variable">-C</span> src/external/</span></span>
</code></pre></div><p>If the build error persist, make sure to install the libpcre2 development package <code>sudo apt-get install libpcre2-dev</code>.</p><h3 id="zlib1g-dev" tabindex="-1"><a class="header-anchor" href="#zlib1g-dev"><span>zlib1g-dev</span></a></h3><p>If receiving the build error <code>os_zlib/os_zlib.c:13:10: fatal error: zlib.h: No such file or directory</code> install the zlib1g development package <code>sudo apt-get install zlib1g-dev</code>.</p><h3 id="libssl-dev" tabindex="-1"><a class="header-anchor" href="#libssl-dev"><span>libssl-dev</span></a></h3><p>If receiving the build error <code>./external/compat/includes.h:65:10: fatal error: openssl/opensslv.h: No such file or directory</code> install the libssl development package <code>sudo apt-get install libssl-dev</code>.</p><h3 id="ignore-snap-partition-state" tabindex="-1"><a class="header-anchor" href="#ignore-snap-partition-state"><span>Ignore snap partition state</span></a></h3><p>If receiving multiple snap partition usage alerts, add a custom rule to local_rules.xml.</p><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">Rule: 531 (level 7) -&gt; &#39;Partition usage reached 100% (disk space monitor).&#39;
ossec: output: &#39;df -P&#39;: /dev/loop0           27776   27776         0     100% /snap/snapd/7264
</span></code></pre></div><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if_sid</span><span class="token punctuation">&gt;</span></span>531<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if_sid</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>regex</span><span class="token punctuation">&gt;</span></span>&#39;df -P&#39;:\s+/dev/loop\d+\s+\d+\s+\d+\s+0\s+100%\s+/snap/\w+/\d+<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>regex</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Ignore full snap loop devices<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rule</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="server-returned-error-nxdomain" tabindex="-1"><a class="header-anchor" href="#server-returned-error-nxdomain"><span>Server returned error NXDOMAIN</span></a></h3><p>If receiving multiple systemd-resolved regarding NXDOMAIN and potential DNS violation, add a custom rule to local_rules.xml.</p><div class="language-shell-session" data-ext="shell-session" data-title="shell-session"><pre class="language-shell-session"><code><span class="token output">systemd-resolved[3225]: message repeated 4 times: [ Server returned error NXDOMAIN, mitigating potential DNS violation DVE-2018-0001, retrying transaction with reduced feature level UDP.]
</span></code></pre></div><div class="language-xml line-numbers-mode" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rule</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100102<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>program_name</span><span class="token punctuation">&gt;</span></span>systemd-resolved<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>program_name</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>match</span><span class="token punctuation">&gt;</span></span>Server returned error NXDOMAIN<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>match</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>Useless systemd-resolved log message.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rule</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="cannot-unlink-queue-rids-sender" tabindex="-1"><a class="header-anchor" href="#cannot-unlink-queue-rids-sender"><span>Cannot unlink /queue/rids/sender</span></a></h3><p>If receiving the error message shown below.</p><div class="language-log line-numbers-mode" data-ext="log" data-title="log"><pre class="language-log"><code><span class="token date number">2020/08/09</span> <span class="token time number">20:04:17</span> manage_agents<span class="token operator">:</span> <span class="token level error important">ERROR</span><span class="token operator">:</span> Cannot unlink <span class="token file-path string">/queue/rids/sender</span><span class="token operator">:</span> No such file or directory
Added<span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Proceed with creating the missing file <code>sudo touch /queue/rids/sender</code>.</p><h2 id="enterprise-solutions" tabindex="-1"><a class="header-anchor" href="#enterprise-solutions"><span>Enterprise solutions <span class="badge tip" style=""><!--[-->non-sponsored<!--]--></span></span></a></h2><h3 id="atomic-enterprise-ossec" tabindex="-1"><a class="header-anchor" href="#atomic-enterprise-ossec"><span>Atomic Enterprise OSSEC</span></a></h3><p>Atomic Enterprise OSSEC is built specifically for organizations that need to leverage OSSEC in large or mission critical environments. With a dedicated management console, thousands of pre-built OSSEC rules, compliance reporting, and more, Atomic Enterprise OSSEC makes it easy to deploy, manage, and use OSSEC in any on-premise, cloud, or hybrid environment.</p><p><a href="https://atomicorp.com/atomic-enterprise-ossec/" target="_blank" rel="noopener noreferrer">Atomic Enterprise OSSEC<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/libellux/Libellux-Up-and-Running/edit/master/docs/ossec/README.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: fredrik@libellux.com">Libellux</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: fredrik@libellux.com">Fredrik Hilmersson</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav" aria-label="page navigation"><p class="inner"><!----><span class="next"><a class="route-link" href="/openvas/" aria-label="Greenbone Vulnerability Manager"><!--[--><!--]--> Greenbone Vulnerability Manager <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-sJdlpeZX.js" defer></script>
  </body>
</html>
