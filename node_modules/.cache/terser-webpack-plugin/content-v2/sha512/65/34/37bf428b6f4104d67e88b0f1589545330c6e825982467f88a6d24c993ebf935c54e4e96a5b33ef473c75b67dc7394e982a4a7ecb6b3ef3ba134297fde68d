{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{373:function(e,a,t){\"use strict\";t.r(a);var s=t(25),n=Object(s.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":e.$parent.slotKey}},[t(\"h1\",{attrs:{id:\"psad-intrusion-detection-with-log-analysis\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#psad-intrusion-detection-with-log-analysis\"}},[e._v(\"#\")]),e._v(\" PSAD Intrusion Detection with Log Analysis\")]),e._v(\" \"),t(\"p\",[e._v(\"Setup and configuration has been tested on following OS with version:\")]),e._v(\" \"),t(\"ul\",[t(\"li\",[e._v(\"Ubuntu 16.04, Ubuntu 18.04\")]),e._v(\" \"),t(\"li\",[e._v(\"2.2.3, 2.4.3\")])]),e._v(\" \"),t(\"h2\",{attrs:{id:\"configuration-files\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#configuration-files\"}},[e._v(\"#\")]),e._v(\" Configuration files\")]),e._v(\" \"),t(\"h2\",{attrs:{id:\"prerequisites\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#prerequisites\"}},[e._v(\"#\")]),e._v(\" Prerequisites\")]),e._v(\" \"),t(\"h2\",{attrs:{id:\"setup-psad\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#setup-psad\"}},[e._v(\"#\")]),e._v(\" Setup PSAD\")]),e._v(\" \"),t(\"div\",{staticClass:\"language- extra-class\"},[t(\"pre\",[t(\"code\",[e._v(\"$ sudo apt-get update\\n$ sudo apt-get install psad\\n\")])])]),t(\"p\",[e._v(\"First enable logging using the built-in UFW command below.\")]),e._v(\" \"),t(\"div\",{staticClass:\"language- extra-class\"},[t(\"pre\",[t(\"code\",[e._v(\"$ sudo ufw logging on\\n\")])])]),t(\"p\",[e._v(\"Once we did enable logging in UFW we also need to alter our UFW rules. Edit both configuration files (before.rules and before6.rules) and add the following before the COMMIT line.\")]),e._v(\" \"),t(\"div\",{staticClass:\"language- extra-class\"},[t(\"pre\",[t(\"code\",[e._v('$ sudo nano /etc/ufw/before.rules\\n\\n# custom psad logging directives\\n-A INPUT -j LOG --log-tcp-options\\n-A INPUT -j LOG --log-tcp-options\\n\\n# do not delete the \"COMMIT\" line or these rules wont be processed\\nCOMMIT\\n')])])]),t(\"p\",[e._v(\"Now we need to reload UFW and proceed to check psad with the built-in firewall analyze tool.\")]),e._v(\" \"),t(\"div\",{staticClass:\"language- extra-class\"},[t(\"pre\",[t(\"code\",[e._v(\"$ sudo ufw reload\\n$ sudo psad --fw-analyze\\n...\\n[+] Parsing INPUT chain rules.\\n[+] Parsing INPUT chain rules.\\n[+] Firewall config looks good.\\n[+] Completed check of firewall ruleset.\\n[+] Results in /var/log/psad/fw_check\\n[+] Exiting.\\n\")])])]),t(\"h2\",{attrs:{id:\"configuration\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#configuration\"}},[e._v(\"#\")]),e._v(\" Configuration\")]),e._v(\" \"),t(\"p\",[e._v(\"The email address will be left as default (root@localhost;) as we use OSSEC to generate alerts. However, we will still send local server emails if the danger level is 3 or greater.\")]),e._v(\" \"),t(\"div\",{staticClass:\"language- extra-class\"},[t(\"pre\",[t(\"code\",[e._v(\"$ sudo nano /etc/psad/psad.conf\\n\\nHOSTNAME    your_domain.com;\\nIPT_SYSLOG_FILE\\t\\t/var/log/syslog;\\nEXPECT_TCP_OPTIONS\\t\\tY; # --log-tcp-options argument\\nEMAIL_ALERT_DANGER_LEVEL\\t3; # alert if danger >= to this value\\n\")])])]),t(\"p\",[e._v(\"To avoid any email reports and only rely on the syslog and OSSEC alerts we can define the alerting method in the psad.conf file.\")]),e._v(\" \"),t(\"div\",{staticClass:\"language- extra-class\"},[t(\"pre\",[t(\"code\",[e._v('### Allow reporting methods to be enabled/restricted.  This keyword can\\n### accept values of \"nosyslog\" (don\\'t write any messages to syslog),\\n### \"noemail\" (don\\'t send any email messages), or \"ALL\" (to generate both\\n### syslog and email messages).  \"ALL\" is the default.  Both \"nosyslog\"\\n### and \"noemail\" can be combined with a comma to disable all logging\\n### and alerting.\\nALERTING_METHODS            noemail;\\n')])])]),t(\"p\",[e._v(\"To check the status of PSAD execute the following command.\")]),e._v(\" \"),t(\"div\",{staticClass:\"language- extra-class\"},[t(\"pre\",[t(\"code\",[e._v(\"$ sudo psad -S\\n\")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);","extractedComments":[]}